/*

Copyright (C) 2013 by Marijn Haverbeke <marijnh@gmail.com> and others

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/
window.CodeMirror=function(){function l(a,d){if(!(this instanceof l))return new l(a,d);this.options=d=d||{};for(var g in Mc)!d.hasOwnProperty(g)&&Mc.hasOwnProperty(g)&&(d[g]=Mc[g]);S(d);g=this.display=P(a,"string"==typeof d.value?0:d.value.first);g.wrapper.CodeMirror=this;v(this);d.autofocus&&!Nc&&ka(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,draggingText:!1,highlight:new Oc};R(this);d.lineWrapping&&(this.display.wrapper.className+=
" CodeMirror-wrap");var y=d.value;"string"==typeof y&&(y=new la(d.value,d.mode));J(this,sd)(this,y);Y&&setTimeout(ta(ra,this,!0),20);Pc(this);var b;try{b=document.activeElement==g.input}catch(T){}b||d.autofocus&&!Nc?setTimeout(ta(e,this),20):f(this);J(this,function(){for(var a in qb)if(qb.propertyIsEnumerable(a))qb[a](this,d[a],td);for(a=0;a<Qc.length;++a)Qc[a](this)})()}function P(a,d){var g={},y=g.input=G("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none; font-size: 4px;");
ca?y.style.width="1000px":y.setAttribute("wrap","off");Ib&&(y.style.border="1px solid black");y.setAttribute("autocorrect","off");y.setAttribute("autocapitalize","off");y.setAttribute("spellcheck","false");g.inputDiv=G("div",[y],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");g.scrollbarH=G("div",[G("div",null,null,"height: 1px")],"CodeMirror-hscrollbar");g.scrollbarV=G("div",[G("div",null,null,"width: 1px")],"CodeMirror-vscrollbar");g.scrollbarFiller=G("div",null,"CodeMirror-scrollbar-filler");
g.gutterFiller=G("div",null,"CodeMirror-gutter-filler");g.lineDiv=G("div",null,"CodeMirror-code");g.selectionDiv=G("div",null,null,"position: relative; z-index: 1");g.cursor=G("div","\u00a0","CodeMirror-cursor");g.otherCursor=G("div","\u00a0","CodeMirror-cursor CodeMirror-secondarycursor");g.measure=G("div",null,"CodeMirror-measure");g.lineSpace=G("div",[g.measure,g.selectionDiv,g.lineDiv,g.cursor,g.otherCursor],null,"position: relative; outline: none");g.mover=G("div",[G("div",[g.lineSpace],"CodeMirror-lines")],
null,"position: relative");g.sizer=G("div",[g.mover],"CodeMirror-sizer");g.heightForcer=G("div",null,null,"position: absolute; height: "+rb+"px; width: 1px;");g.gutters=G("div",null,"CodeMirror-gutters");g.lineGutter=null;g.scroller=G("div",[g.sizer,g.heightForcer,g.gutters],"CodeMirror-scroll");g.scroller.setAttribute("tabIndex","-1");g.wrapper=G("div",[g.inputDiv,g.scrollbarH,g.scrollbarV,g.scrollbarFiller,g.gutterFiller,g.scroller],"CodeMirror");sb&&(g.gutters.style.zIndex=-1,g.scroller.style.paddingRight=
0);a.appendChild?a.appendChild(g.wrapper):a(g.wrapper);Ib&&(y.style.width="0px");ca||(g.scroller.draggable=!0);Rc?(g.inputDiv.style.height="1px",g.inputDiv.style.position="absolute"):sb&&(g.scrollbarH.style.minWidth=g.scrollbarV.style.minWidth="18px");g.viewOffset=g.lastSizeC=0;g.showingFrom=g.showingTo=d;g.lineNumWidth=g.lineNumInnerWidth=g.lineNumChars=null;g.prevInput="";g.alignWidgets=!1;g.pollingFast=!1;g.poll=new Oc;g.cachedCharWidth=g.cachedTextHeight=null;g.measureLineCache=[];g.measureLineCachePos=
0;g.inaccurateSelection=!1;g.maxLine=null;g.maxLineLength=0;g.maxLineChanged=!1;g.wheelDX=g.wheelDY=g.wheelStartX=g.wheelStartY=null;return g}function t(a){a.doc.mode=l.getMode(a.options,a.doc.modeOption);a.doc.iter(function(a){a.stateAfter&&(a.stateAfter=null);a.styles&&(a.styles=null)});a.doc.frontier=a.doc.first;Ia(a,100);a.state.modeGen++;a.curOp&&V(a)}function s(a){var d=za(a.display),g=a.options.lineWrapping,y=g&&Math.max(5,a.display.scroller.clientWidth/Jb(a.display)-3);return function(b){return fb(a.doc,
b)?0:g?(Math.ceil(b.text.length/y)||1)*d:d}}function w(a){var d=a.doc,g=s(a);d.iter(function(a){var d=g(a);d!=a.height&&ua(a,d)})}function A(a){var d=Ja[a.options.keyMap],g=d.style;a.display.wrapper.className=a.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(g?" cm-keymap-"+g:"");a.state.disableInput=d.disableInput}function R(a){a.display.wrapper.className=a.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+a.options.theme.replace(/(^|\s)\s*/g," cm-s-");Ka(a)}function M(a){v(a);V(a);
setTimeout(function(){ga(a)},20)}function v(a){var d=a.display.gutters,g=a.options.gutters;Kb(d);for(var y=0;y<g.length;++y){var b=g[y],T=d.appendChild(G("div",null,"CodeMirror-gutter "+b));"CodeMirror-linenumbers"==b&&(a.display.lineGutter=T,T.style.width=(a.display.lineNumWidth||1)+"px")}d.style.display=y?"":"none"}function q(a,d){if(0==d.height)return 0;for(var g=d.text.length,y,b=d;y=tb(b,-1);)y=y.find(),b=H(a,y.from.line),g+=y.from.ch-y.to.ch;for(b=d;y=jc(b);)y=y.find(),g-=b.text.length-y.from.ch,
b=H(a,y.to.line),g+=b.text.length-y.to.ch;return g}function z(a){var d=a.display,g=a.doc;d.maxLine=H(g,g.first);d.maxLineLength=q(g,d.maxLine);d.maxLineChanged=!0;g.iter(function(a){var b=q(g,a);b>d.maxLineLength&&(d.maxLineLength=b,d.maxLine=a)})}function S(a){var d=Aa(a.gutters,"CodeMirror-linenumbers");-1==d&&a.lineNumbers?a.gutters=a.gutters.concat(["CodeMirror-linenumbers"]):-1<d&&!a.lineNumbers&&(a.gutters=a.gutters.slice(0),a.gutters.splice(d,1))}function u(a){var d=a.display,g=a.doc.height+
(d.mover.offsetHeight-d.lineSpace.offsetHeight);d.sizer.style.minHeight=d.heightForcer.style.top=g+"px";d.gutters.style.height=Math.max(g,d.scroller.clientHeight-rb)+"px";var g=Math.max(g,d.scroller.scrollHeight),y=d.scroller.scrollWidth>d.scroller.clientWidth+1,b=g>d.scroller.clientHeight+1;b?(d.scrollbarV.style.display="block",d.scrollbarV.style.bottom=y?Lb(d.measure)+"px":"0",d.scrollbarV.firstChild.style.height=g-d.scroller.clientHeight+d.scrollbarV.clientHeight+"px"):(d.scrollbarV.style.display=
"",d.scrollbarV.firstChild.style.height="0");y?(d.scrollbarH.style.display="block",d.scrollbarH.style.right=b?Lb(d.measure)+"px":"0",d.scrollbarH.firstChild.style.width=d.scroller.scrollWidth-d.scroller.clientWidth+d.scrollbarH.clientWidth+"px"):(d.scrollbarH.style.display="",d.scrollbarH.firstChild.style.width="0");y&&b?(d.scrollbarFiller.style.display="block",d.scrollbarFiller.style.height=d.scrollbarFiller.style.width=Lb(d.measure)+"px"):d.scrollbarFiller.style.display="";y&&a.options.coverGutterNextToScrollbar&&
a.options.fixedGutter?(d.gutterFiller.style.display="block",d.gutterFiller.style.height=Lb(d.measure)+"px",d.gutterFiller.style.width=d.gutters.offsetWidth+"px"):d.gutterFiller.style.display="";ge&&0===Lb(d.measure)&&(d.scrollbarV.style.minWidth=d.scrollbarH.style.minHeight=he?"18px":"12px",d.scrollbarV.style.pointerEvents=d.scrollbarH.style.pointerEvents="none")}function Ba(a,d,g){var y=a.scroller.scrollTop,b=a.wrapper.clientHeight;"number"==typeof g?y=g:g&&(y=g.top,b=g.bottom-g.top);y=Math.floor(y-
a.lineSpace.offsetTop);a=Math.ceil(y+b);return{from:Mb(d,y),to:Mb(d,a)}}function ga(a){var d=a.display;if(d.alignWidgets||d.gutters.firstChild&&a.options.fixedGutter){for(var g=W(d)-d.scroller.scrollLeft+a.doc.scrollLeft,y=d.gutters.offsetWidth,b=g+"px",T=d.lineDiv.firstChild;T;T=T.nextSibling)if(T.alignable)for(var c=0,e=T.alignable;c<e.length;++c)e[c].style.left=b;a.options.fixedGutter&&(d.gutters.style.left=g+y+"px")}}function $(a){if(!a.options.lineNumbers)return!1;var d=a.doc,d=oa(a.options,
d.first+d.size-1);a=a.display;if(d.length!=a.lineNumChars){var g=a.measure.appendChild(G("div",[G("div",d)],"CodeMirror-linenumber CodeMirror-gutter-elt")),y=g.firstChild.offsetWidth,g=g.offsetWidth-y;a.lineGutter.style.width="";a.lineNumInnerWidth=Math.max(y,a.lineGutter.offsetWidth-g);a.lineNumWidth=a.lineNumInnerWidth+g;a.lineNumChars=a.lineNumInnerWidth?d.length:-1;a.lineGutter.style.width=a.lineNumWidth+"px";return!0}return!1}function oa(a,d){return String(a.lineNumberFormatter(d+a.firstLineNumber))}
function W(a){return Z(a.scroller).left-Z(a.sizer).left}function U(a,d,g,y){for(var b=a.display.showingFrom,T=a.display.showingTo,c,e=Ba(a.display,a.doc,g),f=!0;;f=!1){var h=a.display.scroller.clientWidth;if(!kc(a,d,e,y))break;c=!0;d=[];La(a);u(a);if(f&&a.options.lineWrapping&&h!=a.display.scroller.clientWidth)y=!0;else if(y=!1,g&&(g=Math.min(a.display.scroller.scrollHeight-a.display.scroller.clientHeight,"number"==typeof g?g:g.top)),e=Ba(a.display,a.doc,g),e.from>=a.display.showingFrom&&e.to<=a.display.showingTo)break}c&&
(ha(a,"update",a),a.display.showingFrom==b&&a.display.showingTo==T||ha(a,"viewportChange",a,a.display.showingFrom,a.display.showingTo));return c}function kc(a,d,g,y){var b=a.display,c=a.doc;if(!b.wrapper.clientWidth)b.showingFrom=b.showingTo=c.first,b.viewOffset=0;else if(y||!(0==d.length&&g.from>b.showingFrom&&g.to<b.showingTo)){$(a)&&(d=[{from:c.first,to:c.first+c.size}]);var e=b.sizer.style.marginLeft=b.gutters.offsetWidth+"px";b.scrollbarH.style.left=a.options.fixedGutter?e:"0";e=Infinity;if(a.options.lineNumbers)for(var f=
0;f<d.length;++f)d[f].diff&&d[f].from<e&&(e=d[f].from);var f=c.first+c.size,F=Math.max(g.from-a.options.viewportMargin,c.first);g=Math.min(f,g.to+a.options.viewportMargin);b.showingFrom<F&&20>F-b.showingFrom&&(F=Math.max(c.first,b.showingFrom));b.showingTo>g&&20>b.showingTo-g&&(g=Math.min(f,b.showingTo));if(Nb)for(F=pa(Ma(c,H(c,F)));g<f&&fb(c,H(c,g));)++g;var h=[{from:Math.max(b.showingFrom,c.first),to:Math.min(b.showingTo,f)}],h=h[0].from>=h[0].to?[]:va(h,d);if(Nb)for(f=0;f<h.length;++f){d=h[f];
for(var k;k=jc(H(c,d.to-1));)if(k=k.find().from.line,k>d.from)d.to=k;else{h.splice(f--,1);break}}for(f=c=0;f<h.length;++f)d=h[f],d.from<F&&(d.from=F),d.to>g&&(d.to=g),d.from>=d.to?h.splice(f--,1):c+=d.to-d.from;if(y||c!=g-F||F!=b.showingFrom||g!=b.showingTo){h.sort(function(a,d){return a.from-d.from});try{var m=document.activeElement}catch(Ua){}c<0.7*(g-F)&&(b.lineDiv.style.display="none");mc(a,F,g,h,e);b.lineDiv.style.display="";m&&document.activeElement!=m&&m.offsetHeight&&m.focus();if(F!=b.showingFrom||
g!=b.showingTo||b.lastSizeC!=b.wrapper.clientHeight)b.lastSizeC=b.wrapper.clientHeight,Ia(a,400);b.showingFrom=F;b.showingTo=g;aa(a);wa(a);return!0}wa(a)}}function aa(a){a=a.display;for(var d=a.lineDiv.offsetTop,g=a.lineDiv.firstChild,b;g;g=g.nextSibling)if(g.lineObj){if(sb){var r=g.offsetTop+g.offsetHeight;b=r-d;d=r}else b=Z(g),b=b.bottom-b.top;r=g.lineObj.height-b;2>b&&(b=za(a));if(0.001<r||-0.001>r)if(ua(g.lineObj,b),b=g.lineObj.widgets)for(r=0;r<b.length;++r)b[r].height=b[r].node.offsetHeight}}
function wa(a){var d=a.display.viewOffset=Ob(a,H(a.doc,a.display.showingFrom));a.display.mover.style.top=d+"px"}function va(a,d){for(var g=0,b=d.length||0;g<b;++g){for(var r=d[g],c=[],e=r.diff||0,f=0,F=a.length;f<F;++f){var h=a[f];r.to<=h.from&&r.diff?c.push({from:h.from+e,to:h.to+e}):r.to<=h.from||r.from>=h.to?c.push(h):(r.from>h.from&&c.push({from:h.from,to:r.from}),r.to<h.to&&c.push({from:r.to+e,to:h.to+e}))}a=c}return a}function ub(a){for(var d=a.display,g={},b={},r=d.gutters.firstChild,c=0;r;r=
r.nextSibling,++c)g[a.options.gutters[c]]=r.offsetLeft,b[a.options.gutters[c]]=r.offsetWidth;return{fixedPos:W(d),gutterTotalWidth:d.gutters.offsetWidth,gutterLeft:g,gutterWidth:b,wrapperWidth:d.wrapper.clientWidth}}function mc(a,d,g,b,r){function c(d){var g=d.nextSibling;ca&&vb&&a.display.currentWheelTarget==d?(d.style.display="none",d.lineObj=null):d.parentNode.removeChild(d);return g}var e=ub(a),f=a.display,F=a.options.lineNumbers;b.length||ca&&a.display.currentWheelTarget||Kb(f.lineDiv);var h=
f.lineDiv,k=h.firstChild,m=b.shift(),Ua=d;for(a.doc.iter(d,g,function(d){m&&m.to==Ua&&(m=b.shift());if(fb(a.doc,d)){if(0!=d.height&&ua(d,0),d.widgets&&k&&k.previousSibling)for(var g=0;g<d.widgets.length;++g){var f=d.widgets[g];if(f.showIfHidden){var sa=k.previousSibling;if(/pre/i.test(sa.nodeName)){var n=G("div",null,null,"position: relative");sa.parentNode.replaceChild(n,sa);n.appendChild(sa);sa=n}n=sa.appendChild(G("div",[f.node],"CodeMirror-linewidget"));f.handleMouseEvents||(n.ignoreEvents=!0);
gb(f,n,sa,e)}}}else if(m&&m.from<=Ua&&m.to>Ua){for(;k.lineObj!=d;)k=c(k);F&&r<=Ua&&k.lineNumber&&ud(k.lineNumber,oa(a.options,Ua));k=k.nextSibling}else{if(d.widgets)for(var n=0,p=k;p&&20>n;++n,p=p.nextSibling)if(p.lineObj==d&&/div/i.test(p.nodeName)){g=p;break}var l=Ua,p=g,x=Sc(a,d),n=x.pre,q=d.gutterMarkers,v=a.display,B=x.bgClass?x.bgClass+" "+(d.bgClass||""):d.bgClass;if(a.options.lineNumbers||q||B||d.wrapClass||d.widgets){if(p){p.alignable=null;for(var t=!0,D=0,$=null,s=p.firstChild,z;s;s=z)if(z=
s.nextSibling,/\bCodeMirror-linewidget\b/.test(s.className)){for(x=0;x<d.widgets.length;++x){var K=d.widgets[x];if(K.node==s.firstChild){K.above||$||($=s);gb(K,s,p,e);++D;break}}if(x==d.widgets.length){t=!1;break}}else p.removeChild(s);p.insertBefore(n,$);t&&D==d.widgets.length&&(f=p,p.className=d.wrapClass||"")}f||(f=G("div",null,d.wrapClass,"position: relative"),f.appendChild(n));B&&f.insertBefore(G("div",null,B+" CodeMirror-linebackground"),f.firstChild);if(a.options.lineNumbers||q)if(sa=f.insertBefore(G("div",
null,"CodeMirror-gutter-wrapper","position: absolute; left: "+(a.options.fixedGutter?e.fixedPos:-e.gutterTotalWidth)+"px"),n),a.options.fixedGutter&&(f.alignable||(f.alignable=[])).push(sa),!a.options.lineNumbers||q&&q["CodeMirror-linenumbers"]||(f.lineNumber=sa.appendChild(G("div",oa(a.options,l),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+e.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+v.lineNumInnerWidth+"px"))),q)for(x=0;x<a.options.gutters.length;++x)K=a.options.gutters[x],(l=
q.hasOwnProperty(K)&&q[K])&&sa.appendChild(G("div",[l],"CodeMirror-gutter-elt","left: "+e.gutterLeft[K]+"px; width: "+e.gutterWidth[K]+"px"));sb&&(f.style.zIndex=2);if(d.widgets&&f!=p)for(x=0,p=d.widgets;x<p.length;++x)K=p[x],q=G("div",[K.node],"CodeMirror-linewidget"),K.handleMouseEvents||(q.ignoreEvents=!0),gb(K,q,f,e),K.above?f.insertBefore(q,a.options.lineNumbers&&0!=d.height?sa:n):f.appendChild(q),ha(K,"redraw")}else f=n;if(f!=g)h.insertBefore(f,k);else{for(;k!=g;)k=c(k);k=k.nextSibling}f.lineObj=
d}++Ua});k;)k=c(k)}function gb(a,d,g,b){a.noHScroll&&((g.alignable||(g.alignable=[])).push(d),g=b.wrapperWidth,d.style.left=b.fixedPos+"px",a.coverGutter||(g-=b.gutterTotalWidth,d.style.paddingLeft=b.gutterTotalWidth+"px"),d.style.width=g+"px");a.coverGutter&&(d.style.zIndex=5,d.style.position="relative",a.noHScroll||(d.style.marginLeft=-b.gutterTotalWidth+"px"))}function La(a){var d=a.display,g=L(a.doc.sel.from,a.doc.sel.to);if(g||a.options.showCursorWhenSelecting){var b=a.display,r=ma(a,a.doc.sel.head,
"div");b.cursor.style.left=r.left+"px";b.cursor.style.top=r.top+"px";b.cursor.style.height=Math.max(0,r.bottom-r.top)*a.options.cursorHeight+"px";b.cursor.style.display="";r.other?(b.otherCursor.style.display="",b.otherCursor.style.left=r.other.left+"px",b.otherCursor.style.top=r.other.top+"px",b.otherCursor.style.height=0.85*(r.other.bottom-r.other.top)+"px"):b.otherCursor.style.display="none"}else d.cursor.style.display=d.otherCursor.style.display="none";g?d.selectionDiv.style.display="none":wb(a);
a.options.moveInputWithCursor&&(a=ma(a,a.doc.sel.head,"div"),g=Z(d.wrapper),b=Z(d.lineDiv),d.inputDiv.style.top=Math.max(0,Math.min(d.wrapper.clientHeight-10,a.top+b.top-g.top))+"px",d.inputDiv.style.left=Math.max(0,Math.min(d.wrapper.clientWidth-10,a.left+b.left-g.left))+"px")}function wb(a){function d(a,d,g,b){0>d&&(d=0);e.appendChild(G("div",null,"CodeMirror-selected","position: absolute; left: "+a+"px; top: "+d+"px; width: "+(null==g?f-a:g)+"px; height: "+(b-d)+"px"))}function g(g,b,y){var c=
H(r,g),e=c.text.length,T,E;ie(Ca(c),b||0,null==y?e:y,function(r,h,da){var k=Na(a,B(g,r),"div",c,"left"),m,lc;r==h?(m=k,da=lc=k.left):(m=Na(a,B(g,h-1),"div",c,"right"),"rtl"==da&&(da=k,k=m,m=da),da=k.left,lc=m.right);null==b&&0==r&&(da=F);3<m.top-k.top&&(d(da,k.top,null,k.bottom),da=F,k.bottom<m.top&&d(da,k.bottom,null,m.top));null==y&&h==e&&(lc=f);if(!T||k.top<T.top||k.top==T.top&&k.left<T.left)T=k;if(!E||m.bottom>E.bottom||m.bottom==E.bottom&&m.right>E.right)E=m;da<F+1&&(da=F);d(da,m.top,lc-da,m.bottom)});
return{start:T,end:E}}var b=a.display,r=a.doc,c=a.doc.sel,e=document.createDocumentFragment(),f=b.lineSpace.offsetWidth,F=Da(a.display.measure,G("pre",null,null,"text-align: left")).appendChild(G("span","x")).offsetLeft;if(c.from.line==c.to.line)g(c.from.line,c.from.ch,c.to.ch);else{var h=H(r,c.from.line),k=H(r,c.to.line),k=Ma(r,h)==Ma(r,k),h=g(c.from.line,c.from.ch,k?h.text.length:null).end,c=g(c.to.line,k?0:null,c.to.ch).start;k&&(h.top<c.top-2?(d(h.right,h.top,null,h.bottom),d(F,c.top,c.left,c.bottom)):
d(h.right,h.top,c.left-h.right,h.bottom));h.bottom<c.top&&d(F,h.bottom,null,c.top)}Da(b.selectionDiv,e);b.selectionDiv.style.display=""}function Va(a){if(a.state.focused){var d=a.display;clearInterval(d.blinker);var g=!0;d.cursor.style.visibility=d.otherCursor.style.visibility="";0<a.options.cursorBlinkRate&&(d.blinker=setInterval(function(){d.cursor.style.visibility=d.otherCursor.style.visibility=(g=!g)?"":"hidden"},a.options.cursorBlinkRate))}}function Ia(a,d){a.doc.mode.startState&&a.doc.frontier<
a.display.showingTo&&a.state.highlight.set(d,ta(nc,a))}function nc(a){var d=a.doc;d.frontier<d.first&&(d.frontier=d.first);if(!(d.frontier>=a.display.showingTo)){var g=+new Date+a.options.workTime,b=xb(d.mode,ia(a,d.frontier)),r=[],c;d.iter(d.frontier,Math.min(d.first+d.size,a.display.showingTo+500),function(e){if(d.frontier>=a.display.showingFrom){var f=e.styles;e.styles=vd(a,e,b,!0);for(var F=!f||f.length!=e.styles.length,h=0;!F&&h<f.length;++h)F=f[h]!=e.styles[h];F&&(c&&c.end==d.frontier?c.end++:
r.push(c={start:d.frontier,end:d.frontier+1}));e.stateAfter=xb(d.mode,b)}else Tc(a,e.text,b),e.stateAfter=0==d.frontier%5?xb(d.mode,b):null;++d.frontier;if(+new Date>g)return Ia(a,a.options.workDelay),!0});r.length&&J(a,function(){for(var a=0;a<r.length;++a)V(this,r[a].start,r[a].end)})()}}function oc(a,d,g){for(var b,r,c=a.doc,e=g?-1:d-(a.doc.mode.innerMode?1E3:100);d>e;--d){if(d<=c.first)return c.first;var f=H(c,d-1);if(f.stateAfter&&(!g||d<=c.frontier))return d;f=yb(f.text,null,a.options.tabSize);
if(null==r||b>f)r=d-1,b=f}return r}function ia(a,d,g){var b=a.doc,r=a.display;if(!b.mode.startState)return!0;var c=oc(a,d,g),e=c>b.first&&H(b,c-1).stateAfter,e=e?xb(b.mode,e):wd(b.mode);b.iter(c,d,function(g){Tc(a,g.text,e);g.stateAfter=c==d-1||0==c%5||c>=r.showingFrom&&c<r.showingTo?xb(b.mode,e):null;++c});g&&(b.frontier=c);return e}function Wa(a,d,g,b,r){var c=-1;b=b||Xa(a,d);if(b.crude)return g=b.left+g*b.width,{left:g,right:g+b.width,top:b.top,bottom:b.bottom};for(a=g;;a+=c){var e=b[a];if(e)break;
0>c&&0==a&&(c=1)}r=a>g?"left":a<g?"right":r;"left"==r&&e.leftSide?e=e.leftSide:"right"==r&&e.rightSide&&(e=e.rightSide);return{left:a<g?e.right:e.left,right:a>g?e.left:e.right,top:e.top,bottom:e.bottom}}function ea(a,d){for(var g=a.display.measureLineCache,b=0;b<g.length;++b){var r=g[b];if(r.text==d.text&&r.markedSpans==d.markedSpans&&a.display.scroller.clientWidth==r.width&&r.classes==d.textClass+"|"+d.wrapClass)return r}}function zb(a,d){var g=ea(a,d);g&&(g.text=g.measure=g.markedSpans=null)}function Xa(a,
d){var g=ea(a,d);if(g)return g.measure;var g=pc(a,d),b=a.display.measureLineCache,r={text:d.text,width:a.display.scroller.clientWidth,markedSpans:d.markedSpans,measure:g,classes:d.textClass+"|"+d.wrapClass};16==b.length?b[++a.display.measureLineCachePos%16]=r:b.push(r);return g}function pc(a,d){function g(a){var d=a.top-n.top,g=a.bottom-n.top;g>q&&(g=q);0>d&&(d=0);for(var b=x.length-2;0<=b;b-=2){var y=x[b],r=x[b+1];if(!(y>g||r<d)&&(y<=d&&r>=g||d<=y&&g>=r||Math.min(g,r)-Math.max(d,y)>=g-d>>1)){x[b]=
Math.min(d,y);x[b+1]=Math.max(g,r);break}}0>b&&(b=x.length,x.push(d,g));return{left:a.left-n.left,right:a.right-n.left,top:b,bottom:null}}function b(a){a.bottom=x[a.top+1];a.top=x[a.top]}if(!a.options.lineWrapping&&d.text.length>=a.options.crudeMeasuringFrom)return qc(a,d);var r=a.display,c=xd(d.text.length),e=Sc(a,d,c,!0).pre;if(Y&&!sb&&!a.options.lineWrapping&&100<e.childNodes.length){for(var f=document.createDocumentFragment(),F=e.childNodes.length,h=0,k=Math.ceil(F/10);h<k;++h){for(var m=G("div",
null,null,"display: inline-block"),p=0;10>p&&F;++p)m.appendChild(e.firstChild),--F;f.appendChild(m)}e.appendChild(f)}Da(r.measure,e);var n=Z(r.lineDiv),x=[],f=xd(d.text.length),q=e.offsetHeight;qa&&r.measure.first!=e&&Da(r.measure,e);for(h=0;h<c.length;++h)if(r=c[h])e=r,F=null,/\bCodeMirror-widget\b/.test(r.className)&&r.getClientRects&&(1==r.firstChild.nodeType&&(e=r.firstChild),k=e.getClientRects(),1<k.length&&(F=f[h]=g(k[0]),F.rightSide=g(k[k.length-1]))),F||(F=f[h]=g(Z(e))),r.measureRight&&(F.right=
Z(r.measureRight).left),r.leftSide&&(F.leftSide=g(Z(r.leftSide)));Kb(a.display.measure);for(h=0;h<f.length;++h)if(r=f[h])b(r),r.leftSide&&b(r.leftSide),r.rightSide&&b(r.rightSide);return f}function qc(a,d){var g=new Ya(d.text.slice(0,100),null);d.textClass&&(g.textClass=d.textClass);var b=pc(a,g),r=Wa(a,g,0,b,"left"),g=Wa(a,g,99,b,"right");return{crude:!0,top:r.top,left:r.left,bottom:r.bottom,width:(g.right-r.left)/100}}function Ka(a){a.display.measureLineCache.length=a.display.measureLineCachePos=
0;a.display.cachedCharWidth=a.display.cachedTextHeight=null;a.options.lineWrapping||(a.display.maxLineChanged=!0);a.display.lineNumChars=null}function hb(a,d,g,b){if(d.widgets)for(var r=0;r<d.widgets.length;++r)if(d.widgets[r].above){var c=rc(d.widgets[r]);g.top+=c;g.bottom+=c}if("line"==b)return g;b||(b="local");d=Ob(a,d);d="local"==b?d+a.display.lineSpace.offsetTop:d-a.display.viewOffset;if("page"==b||"window"==b)a=Z(a.display.lineSpace),d+=a.top+("window"==b?0:window.pageYOffset||(document.documentElement||
document.body).scrollTop),b=a.left+("window"==b?0:window.pageXOffset||(document.documentElement||document.body).scrollLeft),g.left+=b,g.right+=b;g.top+=d;g.bottom+=d;return g}function Ab(a,d,g){if("div"==g)return d;var b=d.left;d=d.top;"page"==g?(b-=window.pageXOffset||(document.documentElement||document.body).scrollLeft,d-=window.pageYOffset||(document.documentElement||document.body).scrollTop):"local"!=g&&g||(g=Z(a.display.sizer),b+=g.left,d+=g.top);a=Z(a.display.lineSpace);return{left:b-a.left,
top:d-a.top}}function Na(a,d,g,b,r){b||(b=H(a.doc,d.line));return hb(a,b,Wa(a,b,d.ch,null,r),g)}function ma(a,d,g,b,r){function c(d,e){var T=Wa(a,b,d,r,e?"right":"left");e?T.left=T.right:T.right=T.left;return hb(a,b,T,g)}function e(a,d){var g=f[d],b=g.level%2;a==Uc(g)&&d&&g.level<f[d-1].level?(g=f[--d],a=Vc(g)-(g.level%2?0:1),b=!0):a==Vc(g)&&d<f.length-1&&g.level<f[d+1].level&&(g=f[++d],a=Uc(g)-g.level%2,b=!1);return b&&a==g.to&&a>g.from?c(a-1):c(a,b)}b=b||H(a.doc,d.line);r||(r=Xa(a,b));var f=Ca(b);
d=d.ch;if(!f)return c(d);var h=Wc(f,d),h=e(d,h);null!=Bb&&(h.other=e(d,Bb));return h}function Oa(a,d,g,b){a=new B(a,d);a.xRel=b;g&&(a.outside=!0);return a}function Cb(a,d,g){var b=a.doc;g+=a.display.viewOffset;if(0>g)return Oa(b.first,0,!0,-1);var r=Mb(b,g),c=b.first+b.size-1;if(r>c)return Oa(b.first+b.size-1,H(b,c).text.length,!0,1);for(0>d&&(d=0);;){var c=H(b,r),r=sc(a,c,r,d,g),e=(c=jc(c))&&c.find();if(c&&(r.ch>e.from.ch||r.ch==e.from.ch&&0<r.xRel))r=e.to.line;else return r}}function sc(a,d,g,b,
r){function c(b){b=ma(a,B(g,b),"line",d,k);f=!0;if(e>b.bottom)return b.left-h;if(e<b.top)return b.left+h;f=!1;return b.left}var e=r-Ob(a,d),f=!1,h=2*a.display.wrapper.clientWidth,k=Xa(a,d),m=Ca(d),p=d.text.length;r=tc(d);var n=uc(d),x=c(r),q=f,l=c(n),v=f;if(b>l)return Oa(g,n,v,1);for(;;){if(m?n==r||n==Xc(d,r,1):1>=n-r){m=b<x||b-x<=l-b?r:n;for(b-=m==r?x:l;Yc.test(d.text.charAt(m));)++m;return Oa(g,m,m==r?q:v,0>b?-1:b?1:0)}var K=Math.ceil(p/2),t=r+K;if(m)for(var t=r,D=0;D<K;++D)t=Xc(d,t,1);D=c(t);if(D>
b){n=t;l=D;if(v=f)l+=1E3;p=K}else r=t,x=D,q=f,p-=K}}function za(a){if(null!=a.cachedTextHeight)return a.cachedTextHeight;if(null==ib){ib=G("pre");for(var d=0;49>d;++d)ib.appendChild(document.createTextNode("x")),ib.appendChild(G("br"));ib.appendChild(document.createTextNode("x"))}Da(a.measure,ib);d=ib.offsetHeight/50;3<d&&(a.cachedTextHeight=d);Kb(a.measure);return d||1}function Jb(a){if(null!=a.cachedCharWidth)return a.cachedCharWidth;var d=G("span","x"),g=G("pre",[d]);Da(a.measure,g);d=d.offsetWidth;
2<d&&(a.cachedCharWidth=d);return d||10}function Pa(a){a.curOp={changes:[],forceUpdate:!1,updateInput:null,userSelChange:null,textChanged:null,selectionChanged:!1,cursorActivity:!1,updateMaxLine:!1,updateScrollPos:!1,id:++je};vc++||(Za=[])}function $a(a){var d=a.curOp,g=a.doc,b=a.display;a.curOp=null;d.updateMaxLine&&z(a);if(b.maxLineChanged&&!a.options.lineWrapping&&b.maxLine){var r;r=b.maxLine;var c=!1;if(r.markedSpans)for(var e=0;e<r.markedSpans;++e){var f=r.markedSpans[e];!f.collapsed||null!=
f.to&&f.to!=r.text.length||(c=!0)}(c=!c&&ea(a,r))||r.text.length>=a.options.crudeMeasuringFrom?r=Wa(a,r,r.text.length,c&&c.measure,"right").right:(r=Sc(a,r,null,!0).pre,c=r.appendChild(Pb(a.display.measure)),Da(a.display.measure,r),r=Z(c).right-Z(a.display.lineDiv).left);b.sizer.style.minWidth=Math.max(0,r+3+rb)+"px";b.maxLineChanged=!1;r=Math.max(0,b.sizer.offsetLeft+b.sizer.offsetWidth-b.scroller.clientWidth);r<g.scrollLeft&&!d.updateScrollPos&&ab(a,Math.min(b.scroller.scrollLeft,r),!0)}var h,k;
d.updateScrollPos?h=d.updateScrollPos:d.selectionChanged&&b.scroller.clientHeight&&(h=ma(a,g.sel.head),h=wc(a,h.left,h.top,h.left,h.bottom));if(d.changes.length||d.forceUpdate||h&&null!=h.scrollTop)k=U(a,d.changes,h&&h.scrollTop,d.forceUpdate),a.display.scroller.offsetHeight&&(a.doc.scrollTop=a.display.scroller.scrollTop);!k&&d.selectionChanged&&La(a);if(d.updateScrollPos)k=Math.max(0,Math.min(b.scroller.scrollHeight-b.scroller.clientHeight,h.scrollTop)),h=Math.max(0,Math.min(b.scroller.scrollWidth-
b.scroller.clientWidth,h.scrollLeft)),b.scroller.scrollTop=b.scrollbarV.scrollTop=g.scrollTop=k,b.scroller.scrollLeft=b.scrollbarH.scrollLeft=g.scrollLeft=h,ga(a),d.scrollToPos&&yd(a,C(a.doc,d.scrollToPos.from),C(a.doc,d.scrollToPos.to),d.scrollToPos.margin);else if(h&&(g=yd(a,a.doc.sel.head,null,a.options.cursorScrollMargin),a.state.focused&&(b=a.display,k=Z(b.sizer),h=null,0>g.top+k.top?h=!0:g.bottom+k.top>(window.innerHeight||document.documentElement.clientHeight)&&(h=!1),null!=h&&!ke))){if(k=
"none"==b.cursor.style.display)b.cursor.style.display="",b.cursor.style.left=g.left+"px",b.cursor.style.top=g.top-b.viewOffset+"px";b.cursor.scrollIntoView(h);k&&(b.cursor.style.display="none")}d.selectionChanged&&Va(a);a.state.focused&&d.updateInput&&ra(a,d.userSelChange);g=d.maybeHiddenMarkers;b=d.maybeUnhiddenMarkers;if(g)for(h=0;h<g.length;++h)g[h].lines.length||fa(g[h],"hide");if(b)for(h=0;h<b.length;++h)b[h].lines.length&&fa(b[h],"unhide");var m;--vc||(m=Za,Za=null);d.textChanged&&fa(a,"change",
a,d.textChanged);d.cursorActivity&&fa(a,"cursorActivity",a);if(m)for(h=0;h<m.length;++h)m[h]()}function J(a,d){return function(){var g=a||this,b=!g.curOp;b&&Pa(g);try{var r=d.apply(g,arguments)}finally{b&&$a(g)}return r}}function jb(a){return function(){var d=this.cm&&!this.cm.curOp,g;d&&Pa(this.cm);try{g=a.apply(this,arguments)}finally{d&&$a(this.cm)}return g}}function Qb(a,d){var g=!a.curOp,b;g&&Pa(a);try{b=d()}finally{g&&$a(a)}return b}function V(a,d,g,b){null==d&&(d=a.doc.first);null==g&&(g=a.doc.first+
a.doc.size);a.curOp.changes.push({from:d,to:g,diff:b})}function Qa(a){a.display.pollingFast||a.display.poll.set(a.options.pollInterval,function(){kb(a);a.state.focused&&Qa(a)})}function Ea(a){function d(){kb(a)||g?(a.display.pollingFast=!1,Qa(a)):(g=!0,a.display.poll.set(60,d))}var g=!1;a.display.pollingFast=!0;a.display.poll.set(20,d)}function kb(a){var d=a.display.input,g=a.display.prevInput,b=a.doc,r=b.sel;if(!a.state.focused||le(d)||lb(a)||a.state.disableInput)return!1;a.state.pasteIncoming&&
a.state.fakedLastChar&&(d.value=d.value.substring(0,d.value.length-1),a.state.fakedLastChar=!1);var c=d.value;if(c==g&&L(r.from,r.to))return!1;if(Y&&!qa&&a.display.inputHasSelection===c)return ra(a,!0),!1;var e=!a.curOp;e&&Pa(a);r.shift=!1;for(var f=0,h=Math.min(g.length,c.length);f<h&&g.charCodeAt(f)==c.charCodeAt(f);)++f;h=r.from;r=r.to;f<g.length?h=B(h.line,h.ch-(g.length-f)):a.state.overwrite&&L(h,r)&&!a.state.pasteIncoming&&(r=B(r.line,Math.min(H(b,r.line).text.length,r.ch+(c.length-f))));g=
a.curOp.updateInput;f={from:h,to:r,text:mb(c.slice(f)),origin:a.state.pasteIncoming?"paste":"+input"};p(a.doc,f,"end");a.curOp.updateInput=g;ha(a,"inputRead",a,f);1E3<c.length||-1<c.indexOf("\n")?d.value=a.display.prevInput="":a.display.prevInput=c;e&&$a(a);a.state.pasteIncoming=!1;return!0}function ra(a,d){var g,b,r=a.doc;L(r.sel.from,r.sel.to)?d&&(a.display.prevInput=a.display.input.value="",Y&&!qa&&(a.display.inputHasSelection=null)):(a.display.prevInput="",b=(g=zd&&(100<r.sel.to.line-r.sel.from.line||
1E3<(b=a.getSelection()).length))?"-":b||a.getSelection(),a.display.input.value=b,a.state.focused&&Ad(a.display.input),Y&&!qa&&(a.display.inputHasSelection=b));a.display.inaccurateSelection=g}function ka(a){"nocursor"==a.options.readOnly||Nc&&document.activeElement==a.display.input||a.display.input.focus()}function lb(a){return a.options.readOnly||a.doc.cantEdit}function Pc(a){function d(){a.state.focused&&setTimeout(ta(ka,a),0)}function g(){null==k&&(k=setTimeout(function(){k=null;E.cachedCharWidth=
E.cachedTextHeight=Rb=null;Ka(a);Qb(a,ta(V,a))},100))}function y(){for(var a=E.wrapper.parentNode;a&&a!=document.body;a=a.parentNode);a?setTimeout(y,5E3):Ra(window,"resize",g)}function r(d){Fa(a,d)||a.options.onDragEvent&&a.options.onDragEvent(a,Sb(d))||Tb(d)}function T(){E.inaccurateSelection&&(E.prevInput="",E.inaccurateSelection=!1,E.input.value=a.getSelection(),Ad(E.input))}var E=a.display;N(E.scroller,"mousedown",J(a,bb));Y?N(E.scroller,"dblclick",J(a,function(d){if(!Fa(a,d)){var g=O(a,d);!g||
Ga(a,d,"gutterClick",!0,ha)||Sa(a.display,d)||(ba(d),d=Zc(H(a.doc,g.line).text,g),ja(a.doc,d.from,d.to))}})):N(E.scroller,"dblclick",function(d){Fa(a,d)||ba(d)});N(E.lineSpace,"selectstart",function(a){Sa(E,a)||ba(a)});$c||N(E.scroller,"contextmenu",function(d){h(a,d)});N(E.scroller,"scroll",function(){E.scroller.clientHeight&&(cb(a,E.scroller.scrollTop),ab(a,E.scroller.scrollLeft,!0),fa(a,"scroll",a))});N(E.scrollbarV,"scroll",function(){E.scroller.clientHeight&&cb(a,E.scrollbarV.scrollTop)});N(E.scrollbarH,
"scroll",function(){E.scroller.clientHeight&&ab(a,E.scrollbarH.scrollLeft)});N(E.scroller,"mousewheel",function(d){Ub(a,d)});N(E.scroller,"DOMMouseScroll",function(d){Ub(a,d)});N(E.scrollbarH,"mousedown",d);N(E.scrollbarV,"mousedown",d);N(E.wrapper,"scroll",function(){E.wrapper.scrollTop=E.wrapper.scrollLeft=0});var k;N(window,"resize",g);setTimeout(y,5E3);N(E.input,"keyup",J(a,function(d){Fa(a,d)||a.options.onKeyEvent&&a.options.onKeyEvent(a,Sb(d))||16!=d.keyCode||(a.doc.sel.shift=!1)}));N(E.input,
"input",function(){Y&&!qa&&a.display.inputHasSelection&&(a.display.inputHasSelection=null);Ea(a)});N(E.input,"keydown",J(a,b));N(E.input,"keypress",J(a,c));N(E.input,"focus",ta(e,a));N(E.input,"blur",ta(f,a));a.options.dragDrop&&(N(E.scroller,"dragstart",function(d){if(Y&&(!a.state.draggingText||100>+new Date-Bd))Tb(d);else if(!Fa(a,d)&&!Sa(a.display,d)){var g=a.getSelection();d.dataTransfer.setData("Text",g);d.dataTransfer.setDragImage&&!ad&&(g=G("img",null,null,"position: fixed; left: 0; top: 0;"),
g.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",xa&&(g.width=g.height=1,a.display.wrapper.appendChild(g),g._top=g.offsetTop),d.dataTransfer.setDragImage(g,0,0),xa&&g.parentNode.removeChild(g))}}),N(E.scroller,"dragenter",r),N(E.scroller,"dragover",r),N(E.scroller,"drop",J(a,Vb)));N(E.scroller,"paste",function(d){Sa(E,d)||(ka(a),Ea(a))});N(E.input,"paste",function(){if(ca&&!(a.state.fakedLastChar||200>new Date-a.state.lastMiddleDown)){var d=E.input.selectionStart,
g=E.input.selectionEnd;E.input.value+="$";E.input.selectionStart=d;E.input.selectionEnd=g;a.state.fakedLastChar=!0}a.state.pasteIncoming=!0;Ea(a)});N(E.input,"cut",T);N(E.input,"copy",T);Rc&&N(E.sizer,"mouseup",function(){document.activeElement==E.input&&E.input.blur();ka(a)})}function Sa(a,d){for(var g=d.target||d.srcElement;g!=a.wrapper;g=g.parentNode)if(!g||g.ignoreEvents||g.parentNode==a.sizer&&g!=a.mover)return!0}function O(a,d,g){var b=a.display;if(!g&&(g=d.target||d.srcElement,g==b.scrollbarH||
g==b.scrollbarH.firstChild||g==b.scrollbarV||g==b.scrollbarV.firstChild||g==b.scrollbarFiller||g==b.gutterFiller))return null;var r,c,b=Z(b.lineSpace);try{r=d.clientX,c=d.clientY}catch(e){return null}return Cb(a,r-b.left,c-b.top)}function bb(a){function d(a){if(!L(l,a))if(l=a,"single"==n)ja(r.doc,C(f,F),a);else if(x=C(f,x),q=C(f,q),"double"==n){var d=Zc(H(f,a.line).text,a);Q(a,x)?ja(r.doc,d.from,q):ja(r.doc,x,d.to)}else"triple"==n&&(Q(a,x)?ja(r.doc,q,C(f,B(a.line,0))):ja(r.doc,x,C(f,B(a.line+1,0))))}
function g(a){var b=++t,y=O(r,a,!0);if(y)if(L(y,p)){var h=a.clientY<v.top?-20:a.clientY>v.bottom?20:0;h&&setTimeout(J(r,function(){t==b&&(c.scroller.scrollTop+=h,g(a))}),50)}else{r.state.focused||e(r);p=y;d(y);var k=Ba(c,f);(y.line>=k.to||y.line<k.from)&&setTimeout(J(r,function(){t==b&&g(a)}),150)}}function b(a){t=Infinity;ba(a);ka(r);Ra(document,"mousemove",D);Ra(document,"mouseup",K)}if(!Fa(this,a)){var r=this,c=r.display,f=r.doc,k=f.sel;k.shift=a.shiftKey;if(Sa(c,a))ca||(c.scroller.draggable=!1,
setTimeout(function(){c.scroller.draggable=!0},100));else if(!Ga(r,a,"gutterClick",!0,ha)){var F=O(r,a);switch(Cd(a)){case 3:$c&&h.call(r,r,a);return;case 2:ca&&(r.state.lastMiddleDown=+new Date);F&&ja(r.doc,F);setTimeout(ta(ka,r),20);ba(a);return}if(F){r.state.focused||e(r);var m=+new Date,n="single";xc&&xc.time>m-400&&L(xc.pos,F)?(n="triple",ba(a),setTimeout(ta(ka,r),20),me(r,F.line)):yc&&yc.time>m-400&&L(yc.pos,F)?(n="double",xc={time:m,pos:F},ba(a),m=Zc(H(f,F.line).text,F),ja(r.doc,m.from,m.to)):
yc={time:m,pos:F};var p=F;if(!r.options.dragDrop||!ne||lb(r)||L(k.from,k.to)||Q(F,k.from)||Q(k.to,F)||"single"!=n){ba(a);"single"==n&&ja(r.doc,C(f,F));var x=k.from,q=k.to,l=F,v=Z(c.wrapper),t=0,D=J(r,function(a){Y||Cd(a)?g(a):b(a)}),K=J(r,b);N(document,"mousemove",D);N(document,"mouseup",K)}else{var s=J(r,function(d){ca&&(c.scroller.draggable=!1);r.state.draggingText=!1;Ra(document,"mouseup",s);Ra(c.scroller,"drop",s);10>Math.abs(a.clientX-d.clientX)+Math.abs(a.clientY-d.clientY)&&(ba(d),ja(r.doc,
F),ka(r))});ca&&(c.scroller.draggable=!0);r.state.draggingText=s;c.scroller.dragDrop&&c.scroller.dragDrop();N(document,"mouseup",s);N(c.scroller,"drop",s)}}else(a.target||a.srcElement)==c.scroller&&ba(a)}}}function Ga(a,d,g,b,r){try{var c=d.clientX,e=d.clientY}catch(f){return!1}if(c>=Math.floor(Z(a.display.gutters).right))return!1;b&&ba(d);b=a.display;var h=Z(b.lineDiv);if(e>h.bottom||!Ha(a,g))return bd(d);e-=h.top-b.viewOffset;for(h=0;h<a.options.gutters.length;++h){var k=b.gutters.childNodes[h];
if(k&&Z(k).right>=c)return c=Mb(a.doc,e),r(a,g,a,c,a.options.gutters[h],d),bd(d)}}function cd(a,d){return Ha(a,"gutterContextMenu")?Ga(a,d,"gutterContextMenu",!1,fa):!1}function Vb(a){var d=this;if(!(Fa(d,a)||Sa(d.display,a)||d.options.onDragEvent&&d.options.onDragEvent(d,Sb(a)))){ba(a);Y&&(Bd=+new Date);var g=O(d,a,!0),b=a.dataTransfer.files;if(g&&!lb(d))if(b&&b.length&&window.FileReader&&window.File){var c=b.length,e=Array(c),f=0;a=function(a,b){var y=new FileReader;y.onload=function(){e[b]=y.result;
++f==c&&(g=C(d.doc,g),p(d.doc,{from:g,to:g,text:mb(e.join("\n")),origin:"paste"},"around"))};y.readAsText(a)};for(var h=0;h<c;++h)a(b[h],h)}else if(!d.state.draggingText||Q(g,d.doc.sel.from)||Q(d.doc.sel.to,g))try{if(e=a.dataTransfer.getData("Text")){var h=d.doc.sel.from,k=d.doc.sel.to;Ta(d.doc,g,g);d.state.draggingText&&X(d.doc,"",h,k,"paste");d.replaceSelection(e,null,"paste");ka(d)}}catch(m){}else d.state.draggingText(a),setTimeout(ta(ka,d),20)}}function cb(a,d){2>Math.abs(a.doc.scrollTop-d)||
(a.doc.scrollTop=d,Db||U(a,[],d),a.display.scroller.scrollTop!=d&&(a.display.scroller.scrollTop=d),a.display.scrollbarV.scrollTop!=d&&(a.display.scrollbarV.scrollTop=d),Db&&U(a,[]),Ia(a,100))}function ab(a,d,g){(g?d==a.doc.scrollLeft:2>Math.abs(a.doc.scrollLeft-d))||(d=Math.min(d,a.display.scroller.scrollWidth-a.display.scroller.clientWidth),a.doc.scrollLeft=d,ga(a),a.display.scroller.scrollLeft!=d&&(a.display.scroller.scrollLeft=d),a.display.scrollbarH.scrollLeft!=d&&(a.display.scrollbarH.scrollLeft=
d))}function Ub(a,d){var g=d.wheelDeltaX,b=d.wheelDeltaY;null==g&&d.detail&&d.axis==d.HORIZONTAL_AXIS&&(g=d.detail);null==b&&d.detail&&d.axis==d.VERTICAL_AXIS?b=d.detail:null==b&&(b=d.wheelDelta);var c=a.display,e=c.scroller;if(g&&e.scrollWidth>e.clientWidth||b&&e.scrollHeight>e.clientHeight){if(b&&vb&&ca)for(var f=d.target;f!=e;f=f.parentNode)if(f.lineObj){a.display.currentWheelTarget=f;break}if(!g||Db||xa||null==ya){if(b&&null!=ya){var f=b*ya,h=a.doc.scrollTop,k=h+c.wrapper.clientHeight;0>f?h=Math.max(0,
h+f-50):k=Math.min(a.doc.height,k+f+50);U(a,[],{top:h,bottom:k})}20>zc&&(null==c.wheelStartX?(c.wheelStartX=e.scrollLeft,c.wheelStartY=e.scrollTop,c.wheelDX=g,c.wheelDY=b,setTimeout(function(){if(null!=c.wheelStartX){var a=e.scrollLeft-c.wheelStartX,d=e.scrollTop-c.wheelStartY,a=d&&c.wheelDY&&d/c.wheelDY||a&&c.wheelDX&&a/c.wheelDX;c.wheelStartX=c.wheelStartY=null;a&&(ya=(ya*zc+a)/(zc+1),++zc)}},200)):(c.wheelDX+=g,c.wheelDY+=b))}else b&&cb(a,Math.max(0,Math.min(e.scrollTop+b*ya,e.scrollHeight-e.clientHeight))),
ab(a,Math.max(0,Math.min(e.scrollLeft+g*ya,e.scrollWidth-e.clientWidth))),ba(d),c.wheelStartX=null}}function Eb(a,d,g){if("string"==typeof d&&(d=dd[d],!d))return!1;a.display.pollingFast&&kb(a)&&(a.display.pollingFast=!1);var b=a.doc,c=b.sel.shift,e=!1;try{lb(a)&&(a.state.suppressEdits=!0),g&&(b.sel.shift=!1),e=d(a)!=Dd}finally{b.sel.shift=c,a.state.suppressEdits=!1}return e}function Wb(a){var d=a.state.keyMaps.slice(0);a.options.extraKeys&&d.push(a.options.extraKeys);d.push(a.options.keyMap);return d}
function Xb(a,d){var g=ed(a.options.keyMap),b=g.auto;clearTimeout(Ed);b&&!Fd(d)&&(Ed=setTimeout(function(){ed(a.options.keyMap)==g&&(a.options.keyMap=b.call?b.call(null,a):b,A(a))},50));var c=Gd(d,!0),e=!1;if(!c)return!1;e=Wb(a);if(e=d.shiftKey?Yb("Shift-"+c,e,function(d){return Eb(a,d,!0)})||Yb(c,e,function(d){if("string"==typeof d?/^go[A-Z]/.test(d):d.motion)return Eb(a,d)}):Yb(c,e,function(d){return Eb(a,d)}))ba(d),Va(a),qa&&(d.oldKeyCode=d.keyCode,d.keyCode=0),ha(a,"keyHandled",a,c,d);return e}
function db(a,d,g){var b=Yb("'"+g+"'",Wb(a),function(d){return Eb(a,d,!0)});b&&(ba(d),Va(a),ha(a,"keyHandled",a,"'"+g+"'",d));return b}function b(a){this.state.focused||e(this);if(!(Fa(this,a)||this.options.onKeyEvent&&this.options.onKeyEvent(this,Sb(a)))){Y&&27==a.keyCode&&(a.returnValue=!1);var d=a.keyCode;this.doc.sel.shift=16==d||a.shiftKey;var g=Xb(this,a);xa&&(fd=g?d:null,!g&&88==d&&!zd&&(vb?a.metaKey:a.ctrlKey)&&this.replaceSelection(""))}}function c(a){var d=this;if(!(Fa(d,a)||d.options.onKeyEvent&&
d.options.onKeyEvent(d,Sb(a)))){var g=a.keyCode,b=a.charCode;xa&&g==fd?(fd=null,ba(a)):(xa&&(!a.which||10>a.which)||Rc)&&Xb(d,a)||(g=String.fromCharCode(null==b?g:b),this.options.electricChars&&this.doc.mode.electricChars&&this.options.smartIndent&&!lb(this)&&-1<this.doc.mode.electricChars.indexOf(g)&&setTimeout(J(d,function(){Ac(d,d.doc.sel.to.line,"smart")}),75),db(d,a,g)||(Y&&!qa&&(d.display.inputHasSelection=null),Ea(d)))}}function e(a){"nocursor"!=a.options.readOnly&&(a.state.focused||(fa(a,
"focus",a),a.state.focused=!0,-1==a.display.wrapper.className.search(/\bCodeMirror-focused\b/)&&(a.display.wrapper.className+=" CodeMirror-focused"),a.curOp||(ra(a,!0),ca&&setTimeout(ta(ra,a,!0),0))),Qa(a),Va(a))}function f(a){a.state.focused&&(fa(a,"blur",a),a.state.focused=!1,a.display.wrapper.className=a.display.wrapper.className.replace(" CodeMirror-focused",""));clearInterval(a.display.blinker);setTimeout(function(){a.state.focused||(a.doc.sel.shift=!1)},150)}function h(a,d){function g(){if(null!=
c.input.selectionStart){var a=c.input.value="\u200b"+(L(e.from,e.to)?"":c.input.value);c.prevInput="\u200b";c.input.selectionStart=1;c.input.selectionEnd=a.length}}function b(){c.inputDiv.style.position="relative";c.input.style.cssText=k;qa&&(c.scrollbarV.scrollTop=c.scroller.scrollTop=h);Qa(a);if(null!=c.input.selectionStart){Y&&!qa||g();clearTimeout(gd);var d=0,e=function(){" "==c.prevInput&&0==c.input.selectionStart?J(a,dd.selectAll)(a):10>d++?gd=setTimeout(e,500):ra(a)};gd=setTimeout(e,200)}}
if(!Fa(a,d,"contextmenu")){var c=a.display,e=a.doc.sel;if(!Sa(c,d)&&!cd(a,d)){var f=O(a,d),h=c.scroller.scrollTop;if(f&&!xa){a.options.resetSelectionOnContextMenu&&(L(e.from,e.to)||Q(f,e.from)||!Q(f,e.to))&&J(a,Ta)(a.doc,f,f);var k=c.input.style.cssText;c.inputDiv.style.position="absolute";c.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(d.clientY-5)+"px; left: "+(d.clientX-5)+"px; z-index: 1000; background: white; outline: none;border-width: 0; outline: none; overflow: hidden; opacity: .05; -ms-opacity: .05; filter: alpha(opacity=5);";
ka(a);ra(a,!0);L(e.from,e.to)&&(c.input.value=c.prevInput=" ");Y&&!qa&&g();if($c){Tb(d);var m=function(){Ra(window,"mouseup",m);setTimeout(b,20)};N(window,"mouseup",m)}else setTimeout(b,50)}}}}function k(a,d,g){if(!Q(d.from,g))return C(a,g);var b=d.text.length-1-(d.to.line-d.from.line);if(g.line>d.to.line+b)return d=g.line-b,b=a.first+a.size-1,d>b?B(b,H(a,b).text.length):Bc(g,H(a,d).text.length);if(g.line==d.to.line+b)return Bc(g,na(d.text).length+(1==d.text.length?d.from.ch:0)+H(a,d.to.line).text.length-
d.to.ch);a=g.line-d.from.line;return Bc(g,d.text[a].length+(a?0:d.from.ch))}function m(a,d,g){if(g&&"object"==typeof g)return{anchor:k(a,d,g.anchor),head:k(a,d,g.head)};if("start"==g)return{anchor:d.from,head:d.from};var b=hd(d);if("around"==g)return{anchor:d.from,head:b};if("end"==g)return{anchor:b,head:b};g=function(a){if(Q(a,d.from))return a;if(!Q(d.to,a))return b;var g=a.line+d.text.length-(d.to.line-d.from.line)-1,c=a.ch;a.line==d.to.line&&(c+=b.ch-d.to.ch);return B(g,c)};return{anchor:g(a.sel.anchor),
head:g(a.sel.head)}}function n(a,d,g){d={canceled:!1,from:d.from,to:d.to,text:d.text,origin:d.origin,cancel:function(){this.canceled=!0}};g&&(d.update=function(d,g,b,c){d&&(this.from=C(a,d));g&&(this.to=C(a,g));b&&(this.text=b);void 0!==c&&(this.origin=c)});fa(a,"beforeChange",a,d);a.cm&&fa(a.cm,"beforeChange",a.cm,d);return d.canceled?null:{from:d.from,to:d.to,text:d.text,origin:d.origin}}function p(a,d,g,b){if(a.cm){if(!a.cm.curOp)return J(a.cm,p)(a,d,g,b);if(a.cm.state.suppressEdits)return}if(Ha(a,
"beforeChange")||a.cm&&Ha(a.cm,"beforeChange"))if(d=n(a,d,!0),!d)return;if(b=Hd&&!b&&oe(a,d.from,d.to)){for(var c=b.length-1;1<=c;--c)x(a,{from:b[c].from,to:b[c].to,text:[""]});b.length&&x(a,{from:b[0].from,to:b[0].to,text:d.text},g)}else x(a,d,g)}function x(a,d,g){if(1!=d.text.length||""!=d.text[0]||!L(d.from,d.to)){g=m(a,d,g);Id(a,d,g,a.cm?a.cm.curOp.id:NaN);D(a,d,g,id(a,d));var b=[];Fb(a,function(a,g){g||-1!=Aa(b,a.history)||(Jd(a.history,d),b.push(a.history));D(a,d,null,id(a,d))})}}function K(a,
d){if(!a.cm||!a.cm.state.suppressEdits){var g=a.history,b=("undo"==d?g.done:g.undone).pop();if(b){var c={changes:[],anchorBefore:b.anchorAfter,headBefore:b.headAfter,anchorAfter:b.anchorBefore,headAfter:b.headBefore,generation:g.generation};("undo"==d?g.undone:g.done).push(c);g.generation=b.generation||++g.maxGeneration;for(var e=Ha(a,"beforeChange")||a.cm&&Ha(a.cm,"beforeChange"),f=b.changes.length-1;0<=f;--f){var h=b.changes[f];h.origin=d;if(e&&!n(a,h,!1)){("undo"==d?g.done:g.undone).length=0;break}c.changes.push(jd(a,
h));var k=f?m(a,h,null):{anchor:b.anchorBefore,head:b.headBefore};D(a,h,k,Kd(a,h));var da=[];Fb(a,function(a,d){d||-1!=Aa(da,a.history)||(Jd(a.history,h),da.push(a.history));D(a,h,null,Kd(a,h))})}}}}function Ld(a,d){function g(a){return B(a.line+d,a.ch)}a.first+=d;a.cm&&V(a.cm,a.first,a.first,d);a.sel.head=g(a.sel.head);a.sel.anchor=g(a.sel.anchor);a.sel.from=g(a.sel.from);a.sel.to=g(a.sel.to)}function D(a,d,g,b){if(a.cm&&!a.cm.curOp)return J(a.cm,D)(a,d,g,b);if(d.to.line<a.first)Ld(a,d.text.length-
1-(d.to.line-d.from.line));else if(!(d.from.line>a.lastLine())){if(d.from.line<a.first){var c=d.text.length-1-(a.first-d.from.line);Ld(a,c);d={from:B(a.first,0),to:B(d.to.line+c,d.to.ch),text:[na(d.text)],origin:d.origin}}c=a.lastLine();d.to.line>c&&(d={from:d.from,to:B(c,H(a,c).text.length),text:[d.text[0]],origin:d.origin});d.removed=kd(a,d.from,d.to);g||(g=m(a,d,null));a.cm?pe(a.cm,d,b,g):ld(a,d,b,g)}}function pe(a,d,g,b){var c=a.doc,e=a.display,f=d.from,h=d.to,k=!1,m=f.line;a.options.lineWrapping||
(m=pa(Ma(c,H(c,f.line))),c.iter(m,h.line+1,function(a){if(a==e.maxLine)return k=!0}));Q(c.sel.head,d.from)||Q(d.to,c.sel.head)||(a.curOp.cursorActivity=!0);ld(c,d,g,b,s(a));a.options.lineWrapping||(c.iter(m,f.line+d.text.length,function(a){var d=q(c,a);d>e.maxLineLength&&(e.maxLine=a,e.maxLineLength=d,e.maxLineChanged=!0,k=!1)}),k&&(a.curOp.updateMaxLine=!0));c.frontier=Math.min(c.frontier,f.line);Ia(a,400);V(a,f.line,h.line+1,d.text.length-(h.line-f.line)-1);if(Ha(a,"change"))if(d={from:f,to:h,text:d.text,
removed:d.removed,origin:d.origin},a.curOp.textChanged){for(a=a.curOp.textChanged;a.next;a=a.next);a.next=d}else a.curOp.textChanged=d}function X(a,d,g,b,c){b||(b=g);if(Q(b,g)){var e=b;b=g;g=e}"string"==typeof d&&(d=mb(d));p(a,{from:g,to:b,text:d,origin:c},null)}function B(a,d){if(!(this instanceof B))return new B(a,d);this.line=a;this.ch=d}function L(a,d){return a.line==d.line&&a.ch==d.ch}function Q(a,d){return a.line<d.line||a.line==d.line&&a.ch<d.ch}function nb(a){return B(a.line,a.ch)}function C(a,
d){if(d.line<a.first)return B(a.first,0);var g=a.first+a.size-1;return d.line>g?B(g,H(a,g).text.length):Bc(d,H(a,d.line).text.length)}function Bc(a,d){var g=a.ch;return null==g||g>d?B(a.line,d):0>g?B(a.line,0):a}function Gb(a,d){return d>=a.first&&d<a.first+a.size}function ja(a,d,g,b){if(a.sel.shift||a.sel.extend){var c=a.sel.anchor;if(g){var e=Q(d,c);e!=Q(g,c)?(c=d,d=g):e!=Q(d,g)&&(d=g)}Ta(a,c,d,b)}else Ta(a,d,g||d,b);a.cm&&(a.cm.curOp.userSelChange=!0)}function Ta(a,d,g,b,c){if(!c&&Ha(a,"beforeSelectionChange")||
a.cm&&Ha(a.cm,"beforeSelectionChange"))d={anchor:d,head:g},fa(a,"beforeSelectionChange",a,d),a.cm&&fa(a.cm,"beforeSelectionChange",a.cm,d),d.anchor=C(a,d.anchor),d.head=C(a,d.head),g=d.head,d=d.anchor;var e=a.sel;e.goalColumn=null;null==b&&(b=Q(g,e.head)?-1:1);if(c||!L(d,e.anchor))d=Cc(a,d,b,"push"!=c);if(c||!L(g,e.head))g=Cc(a,g,b,"push"!=c);L(e.anchor,d)&&L(e.head,g)||(e.anchor=d,e.head=g,b=Q(g,d),e.from=b?g:d,e.to=b?d:g,a.cm&&(a.cm.curOp.updateInput=a.cm.curOp.selectionChanged=a.cm.curOp.cursorActivity=
!0),ha(a,"cursorActivity",a))}function Md(a){Ta(a.doc,a.doc.sel.from,a.doc.sel.to,null,"push")}function Cc(a,d,g,b){var c=!1,e=d,f=g||1;a.cantEdit=!1;a:for(;;){var h=H(a,e.line);if(h.markedSpans)for(var k=0;k<h.markedSpans.length;++k){var m=h.markedSpans[k],n=m.marker;if((null==m.from||(n.inclusiveLeft?m.from<=e.ch:m.from<e.ch))&&(null==m.to||(n.inclusiveRight?m.to>=e.ch:m.to>e.ch))){if(b&&(fa(n,"beforeCursorEnter"),n.explicitlyCleared))if(h.markedSpans){--k;continue}else break;if(n.atomic){k=n.find()[0>
f?"from":"to"];if(L(k,e)&&(k.ch+=f,0>k.ch?k=k.line>a.first?C(a,B(k.line-1)):null:k.ch>h.text.length&&(k=k.line<a.first+a.size-1?B(k.line+1,0):null),!k)){if(c){if(!b)return Cc(a,d,g,!0);a.cantEdit=!0;return B(a.first,0)}c=!0;k=d;f=-f}e=k;continue a}}}return e}}function yd(a,d,g,b){for(null==b&&(b=0);;){var c=!1,e=ma(a,d),f=g&&g!=d?ma(a,g):e,f=wc(a,Math.min(e.left,f.left),Math.min(e.top,f.top)-b,Math.max(e.left,f.left),Math.max(e.bottom,f.bottom)+b),h=a.doc.scrollTop,k=a.doc.scrollLeft;null!=f.scrollTop&&
(cb(a,f.scrollTop),1<Math.abs(a.doc.scrollTop-h)&&(c=!0));null!=f.scrollLeft&&(ab(a,f.scrollLeft),1<Math.abs(a.doc.scrollLeft-k)&&(c=!0));if(!c)return e}}function wc(a,d,g,b,c){var e=a.display,f=za(a.display);0>g&&(g=0);var h=e.scroller.clientHeight-rb,k=e.scroller.scrollTop,m={};a=a.doc.height+(e.mover.offsetHeight-e.lineSpace.offsetHeight);var n=g<f,f=c>a-f;g<k?m.scrollTop=n?0:g:c>k+h&&(g=Math.min(g,(f?a:c)-h),g!=k&&(m.scrollTop=g));k=e.scroller.clientWidth-rb;g=e.scroller.scrollLeft;d+=e.gutters.offsetWidth;
b+=e.gutters.offsetWidth;e=e.gutters.offsetWidth;c=d<e+10;d<g+e||c?(c&&(d=0),m.scrollLeft=Math.max(0,d-10-e)):b>k+g-3&&(m.scrollLeft=b+10-k);return m}function Dc(a,d,g){a.curOp.updateScrollPos={scrollLeft:null==d?a.doc.scrollLeft:d,scrollTop:null==g?a.doc.scrollTop:g}}function md(a,d,g){var b=a.curOp.updateScrollPos||(a.curOp.updateScrollPos={scrollLeft:a.doc.scrollLeft,scrollTop:a.doc.scrollTop});a=a.display.scroller;b.scrollTop=Math.max(0,Math.min(a.scrollHeight-a.clientHeight,b.scrollTop+g));b.scrollLeft=
Math.max(0,Math.min(a.scrollWidth-a.clientWidth,b.scrollLeft+d))}function Ac(a,d,g,b){var c=a.doc;null==g&&(g="add");if("smart"==g)if(a.doc.mode.indent)var e=ia(a,d);else g="prev";var f=a.options.tabSize,h=H(c,d),k=yb(h.text,null,f),m=h.text.match(/^\s*/)[0],n;if("smart"==g&&(n=a.doc.mode.indent(e,h.text.slice(m.length),h.text),n==Dd)){if(!b)return;g="prev"}"prev"==g?n=d>c.first?yb(H(c,d-1).text,null,f):0:"add"==g?n=k+a.options.indentUnit:"subtract"==g?n=k-a.options.indentUnit:"number"==typeof g&&
(n=k+g);n=Math.max(0,n);g="";b=0;if(a.options.indentWithTabs)for(e=Math.floor(n/f);e;--e)b+=f,g+="\t";b<n&&(g+=Nd(n-b));g!=m?X(a.doc,g,B(d,0),B(d,m.length),"+input"):c.sel.head.line==d&&c.sel.head.ch<m.length&&Ta(c,B(d,m.length),B(d,m.length),1);h.stateAfter=null}function Ec(a,d,g){var b=d,c=d,e=a.doc;"number"==typeof d?c=H(e,Math.max(e.first,Math.min(d,e.first+e.size-1))):b=pa(d);if(null!=b&&g(c,b))V(a,b,b+1);else return null;return c}function nd(a,d,g,b,c){function e(d){var b=(c?Xc:Od)(k,h,g,!0);
if(null==b){if(d=!d)d=f+g,d<a.first||d>=a.first+a.size?d=m=!1:(f=d,d=k=H(a,d));if(d)h=c?(0>g?uc:tc)(k):0>g?k.text.length:0;else return m=!1}else h=b;return!0}var f=d.line,h=d.ch;d=g;var k=H(a,f),m=!0;if("char"==b)e();else if("column"==b)e(!0);else if("word"==b||"group"==b){var n=null;b="group"==b;for(var p=!0;!(0>g)||e(!p);p=!1){var x=k.text.charAt(h)||"\n",x=Zb(x)?"w":b?/\s/.test(x)?null:"p":null;if(n&&n!=x){0>g&&(g=1,e());break}x&&(n=x);if(0<g&&!e(!p))break}}d=Cc(a,B(f,h),d,!0);m||(d.hitSide=!0);
return d}function Pd(a,d,g,b){var c=a.doc,e=d.left,f;"page"==b?(b=Math.min(a.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),f=d.top+g*(b-(0>g?1.5:0.5)*za(a.display))):"line"==b&&(f=0<g?d.bottom+3:d.top-3);for(;;){var h=Cb(a,e,f);if(!h.outside)break;if(0>g?0>=f:f>=c.height){h.hitSide=!0;break}f+=5*g}return h}function Zc(a,d){var g=d.ch,b=d.ch;if(a){(0>d.xRel||b==a.length)&&g?--g:++b;for(var c=a.charAt(g),c=Zb(c)?Zb:/\s/.test(c)?function(a){return/\s/.test(a)}:
function(a){return!/\s/.test(a)&&!Zb(a)};0<g&&c(a.charAt(g-1));)--g;for(;b<a.length&&c(a.charAt(b));)++b}return{from:B(d.line,g),to:B(d.line,b)}}function me(a,d){ja(a.doc,B(d,0),C(a.doc,B(d+1,0)))}function I(a,d,g,b){l.defaults[a]=d;g&&(qb[a]=b?function(a,d,b){b!=td&&g(a,d,b)}:g)}function xb(a,d){if(!0===d)return d;if(a.copyState)return a.copyState(d);var g={},b;for(b in d){var c=d[b];c instanceof Array&&(c=c.concat([]));g[b]=c}return g}function wd(a,d,g){return a.startState?a.startState(d,g):!0}
function ed(a){return"string"==typeof a?Ja[a]:a}function Yb(a,d,g){function b(d){d=ed(d);var c=d[a];if(!1===c)return"stop";if(null!=c&&g(c))return!0;if(d.nofallthrough)return"stop";d=d.fallthrough;if(null==d)return!1;if("[object Array]"!=Object.prototype.toString.call(d))return b(d);for(var c=0,e=d.length;c<e;++c){var f=b(d[c]);if(f)return f}return!1}for(var c=0;c<d.length;++c){var e=b(d[c]);if(e)return"stop"!=e}}function Fd(a){a=ob[a.keyCode];return"Ctrl"==a||"Alt"==a||"Shift"==a||"Mod"==a}function Gd(a,
d){if(xa&&34==a.keyCode&&a["char"])return!1;var g=ob[a.keyCode];if(null==g||a.altGraphKey)return!1;a.altKey&&(g="Alt-"+g);if(Qd?a.metaKey:a.ctrlKey)g="Ctrl-"+g;if(Qd?a.ctrlKey:a.metaKey)g="Cmd-"+g;!d&&a.shiftKey&&(g="Shift-"+g);return g}function $b(a,d){this.pos=this.start=0;this.string=a;this.tabSize=d||8;this.lastColumnPos=this.lastColumnValue=0}function eb(a,d){this.lines=[];this.type=d;this.doc=a}function ac(a,d,g,b,c){if(b&&b.shared)return qe(a,d,g,b,c);if(a.cm&&!a.cm.curOp)return J(a.cm,ac)(a,
d,g,b,c);var e=new eb(a,c);if(Q(g,d)||L(d,g)&&!("range"!=c||b.inclusiveLeft&&b.inclusiveRight))return e;b&&Fc(b,e);e.replacedWith&&(e.collapsed=!0,e.replacedWith=G("span",[e.replacedWith],"CodeMirror-widget"),b.handleMouseEvents||(e.replacedWith.ignoreEvents=!0));e.collapsed&&(Nb=!0);e.addToHistory&&Id(a,{from:d,to:g,origin:"markText"},{head:a.sel.head,anchor:a.sel.anchor},NaN);var f=d.line,h=0,k,m,n=a.cm,p;a.iter(f,g.line+1,function(b){n&&e.collapsed&&!n.options.lineWrapping&&Ma(a,b)==n.display.maxLine&&
(p=!0);var c={from:null,to:null,marker:e};h+=b.text.length;f==d.line&&(c.from=d.ch,h-=d.ch);f==g.line&&(c.to=g.ch,h-=b.text.length-g.ch);e.collapsed&&(f==g.line&&(m=tb(b,g.ch)),f==d.line?k=tb(b,d.ch):ua(b,0));b.markedSpans=b.markedSpans?b.markedSpans.concat([c]):[c];c.marker.attachLine(b);++f});e.collapsed&&a.iter(d.line,g.line+1,function(d){fb(a,d)&&ua(d,0)});e.clearOnEnter&&N(e,"beforeCursorEnter",function(){e.clear()});e.readOnly&&(Hd=!0,(a.history.done.length||a.history.undone.length)&&a.clearHistory());
if(e.collapsed){if(k!=m)throw Error("Inserting collapsed marker overlapping an existing one");e.size=h;e.atomic=!0}n&&(p&&(n.curOp.updateMaxLine=!0),(e.className||e.title||e.startStyle||e.endStyle||e.collapsed)&&V(n,d.line,g.line+1),e.atomic&&Md(n));return e}function bc(a,d){this.markers=a;this.primary=d;for(var b=0,c=this;b<a.length;++b)a[b].parent=this,N(a[b],"clear",function(){c.clear()})}function qe(a,d,b,c,e){c=Fc(c);c.shared=!1;var f=[ac(a,d,b,c,e)],h=f[0],k=c.replacedWith;Fb(a,function(a){k&&
(c.replacedWith=k.cloneNode(!0));f.push(ac(a,C(a,d),C(a,b),c,e));for(var m=0;m<a.linked.length;++m)if(a.linked[m].isParent)return;h=na(f)});return new bc(f,h)}function cc(a,d){if(a)for(var b=0;b<a.length;++b){var c=a[b];if(c.marker==d)return c}}function id(a,d){var b=Gb(a,d.from.line)&&H(a,d.from.line).markedSpans,c=Gb(a,d.to.line)&&H(a,d.to.line).markedSpans;if(!b&&!c)return null;var e=d.from.ch,f=d.to.ch,h=L(d.from,d.to);if(b)for(var k=0,m;k<b.length;++k){var n=b[k],p=n.marker;if(null==n.from||
(p.inclusiveLeft?n.from<=e:n.from<e)||(p.inclusiveLeft&&p.inclusiveRight||"bookmark"==p.type)&&!(n.from!=e||h&&n.marker.insertLeft)){var x=null==n.to||(p.inclusiveRight?n.to>=e:n.to>e);(m||(m=[])).push({from:n.from,to:x?null:n.to,marker:p})}}b=m;if(c)for(var k=0,q;k<c.length;++k)if(m=c[k],n=m.marker,null==m.to||(n.inclusiveRight?m.to>=f:m.to>f)||"bookmark"==n.type&&m.from==f&&(!h||m.marker.insertLeft))p=null==m.from||(n.inclusiveLeft?m.from<=f:m.from<f),(q||(q=[])).push({from:p?null:m.from-f,to:null==
m.to?null:m.to-f,marker:n});c=q;h=1==d.text.length;q=na(d.text).length+(h?e:0);if(b)for(f=0;f<b.length;++f)if(k=b[f],null==k.to)(m=cc(c,k.marker),m)?h&&(k.to=null==m.to?null:m.to+q):k.to=e;if(c)for(f=0;f<c.length;++f)k=c[f],null!=k.to&&(k.to+=q),null==k.from?(m=cc(b,k.marker),m||(k.from=q,h&&(b||(b=[])).push(k))):(k.from+=q,h&&(b||(b=[])).push(k));if(h&&b){for(f=0;f<b.length;++f)null!=b[f].from&&b[f].from==b[f].to&&"bookmark"!=b[f].marker.type&&b.splice(f--,1);b.length||(b=null)}e=[b];if(!h){var h=
d.text.length-2,l;if(0<h&&b)for(f=0;f<b.length;++f)null==b[f].to&&(l||(l=[])).push({from:null,to:null,marker:b[f].marker});for(f=0;f<h;++f)e.push(l);e.push(c)}return e}function Kd(a,d){var b;if(b=d["spans_"+a.id]){for(var c=0,e=[];c<d.text.length;++c)e.push(re(b[c]));b=e}else b=null;c=id(a,d);if(!b)return c;if(!c)return b;for(e=0;e<b.length;++e){var f=b[e],h=c[e];if(f&&h){var k=0;a:for(;k<h.length;++k){for(var m=h[k],n=0;n<f.length;++n)if(f[n].marker==m.marker)continue a;f.push(m)}}else h&&(b[e]=
h)}return b}function oe(a,d,b){var c=null;a.iter(d.line,b.line+1,function(a){if(a.markedSpans)for(var d=0;d<a.markedSpans.length;++d){var b=a.markedSpans[d].marker;!b.readOnly||c&&-1!=Aa(c,b)||(c||(c=[])).push(b)}});if(!c)return null;a=[{from:d,to:b}];for(d=0;d<c.length;++d){b=c[d];for(var e=b.find(),f=0;f<a.length;++f){var h=a[f];if(!Q(h.to,e.from)&&!Q(e.to,h.from)){var k=[f,1];(Q(h.from,e.from)||!b.inclusiveLeft&&L(h.from,e.from))&&k.push({from:h.from,to:e.from});(Q(e.to,h.to)||!b.inclusiveRight&&
L(h.to,e.to))&&k.push({from:e.to,to:h.to});a.splice.apply(a,k);f+=k.length-1}}}return a}function tb(a,d){var b=Nb&&a.markedSpans,c;if(b)for(var e,f=0;f<b.length;++f)e=b[f],e.marker.collapsed&&(null==e.from||e.from<d)&&(null==e.to||e.to>d)&&(!c||c.width<e.marker.width)&&(c=e.marker);return c}function jc(a){return tb(a,a.text.length+1)}function Ma(a,d){for(var b;b=tb(d,-1);)d=H(a,b.find().from.line);return d}function fb(a,d){var b=Nb&&d.markedSpans;if(b)for(var c,e=0;e<b.length;++e)if(c=b[e],c.marker.collapsed&&
(null==c.from||!c.marker.replacedWith&&0==c.from&&c.marker.inclusiveLeft&&od(a,d,c)))return!0}function od(a,d,b){if(null==b.to)return d=b.marker.find().to,d=H(a,d.line),od(a,d,cc(d.markedSpans,b.marker));if(b.marker.inclusiveRight&&b.to==d.text.length)return!0;for(var c,e=0;e<d.markedSpans.length;++e)if(c=d.markedSpans[e],c.marker.collapsed&&!c.marker.replacedWith&&c.from==b.to&&(c.marker.inclusiveLeft||b.marker.inclusiveRight)&&od(a,d,c))return!0}function Rd(a){var d=a.markedSpans;if(d){for(var b=
0;b<d.length;++b)d[b].marker.detachLine(a);a.markedSpans=null}}function Sd(a,d){if(d){for(var b=0;b<d.length;++b)d[b].marker.attachLine(a);a.markedSpans=d}}function Td(a){return function(){var d=!this.cm.curOp;d&&Pa(this.cm);try{var b=a.apply(this,arguments)}finally{d&&$a(this.cm)}return b}}function rc(a){if(null!=a.height)return a.height;a.node.parentNode&&1==a.node.parentNode.nodeType||Da(a.cm.display.measure,G("div",[a.node],null,"position: relative"));return a.height=a.node.offsetHeight}function se(a,
d,b,c){var e=new Gc(a,b,c);e.noHScroll&&(a.display.alignWidgets=!0);Ec(a,d,function(d){var b=d.widgets||(d.widgets=[]);null==e.insertAt?b.push(e):b.splice(Math.min(b.length-1,Math.max(0,e.insertAt)),0,e);e.line=d;if(!fb(a.doc,d)||e.showIfHidden)b=Ob(a,d)<a.doc.scrollTop,ua(d,d.height+rc(e)),b&&md(a,0,e.height);return!0});return e}function Ud(a,d,b,c,e,f){var h=b.flattenSpans;null==h&&(h=a.options.flattenSpans);var k=0,m=null,n=new $b(d,a.options.tabSize),p;for(""==d&&b.blankLine&&b.blankLine(c);!n.eol();)n.pos>
a.options.maxHighlightLength?(h=!1,f&&Tc(a,d,c,n.pos),n.pos=d.length,p=null):p=b.token(n,c),h&&m==p||(k<n.start&&e(n.start,m),k=n.start,m=p),n.start=n.pos;for(;k<n.pos;)a=Math.min(n.pos,k+5E4),e(a,m),k=a}function vd(a,d,b,c){var e=[a.state.modeGen];Ud(a,d.text,a.doc.mode,b,function(a,d){e.push(a,d)},c);for(b=0;b<a.state.overlays.length;++b){var f=a.state.overlays[b],h=1,k=0;Ud(a,d.text,f.mode,!0,function(a,d){for(var b=h;k<a;){var g=e[h];g>a&&e.splice(h,1,a,e[h+1],g);h+=2;k=Math.min(a,g)}if(d)if(f.opaque)e.splice(b,
h-b,a,d),h=b+2;else for(;b<h;b+=2)g=e[b+1],e[b+1]=g?g+" "+d:d})}return e}function Vd(a,d){d.styles&&d.styles[0]==a.state.modeGen||(d.styles=vd(a,d,d.stateAfter=ia(a,pa(d))));return d.styles}function Tc(a,d,b,c){var e=a.doc.mode,f=new $b(d,a.options.tabSize);f.start=f.pos=c||0;for(""==d&&e.blankLine&&e.blankLine(b);!f.eol()&&f.pos<=a.options.maxHighlightLength;)e.token(f,b),f.start=f.pos}function Wd(a,d){if(!a)return null;for(;;){var b=a.match(/(?:^|\s)line-(background-)?(\S+)/);if(!b)break;a=a.slice(0,
b.index)+a.slice(b.index+b[0].length);var c=b[1]?"bgClass":"textClass";null==d[c]?d[c]=b[2]:(new RegExp("(?:^|s)"+b[2]+"(?:$|s)")).test(d[c])||(d[c]+=" "+b[2])}return Xd[a]||(Xd[a]="cm-"+a.replace(/ +/g," cm-"))}function Sc(a,d,b,c){for(var e,f=d,h=!0;e=tb(f,-1);)f=H(a.doc,e.find().from.line);c={pre:G("pre"),col:0,pos:0,measure:null,measuredSomething:!1,cm:a,copyWidgets:c};do{f.text&&(h=!1);c.measure=f==d&&b;c.pos=0;c.addToken=c.measure?te:Yd;(Y||ca)&&a.getOption("lineWrapping")&&(c.addToken=ue(c.addToken));
a:{e=c;var k=Vd(a,f),m=f.markedSpans,n=f.text,p=0;if(m)for(var x=n.length,q=0,l=1,t="",v=void 0,D=0,K=void 0,s=void 0,B=void 0,$=void 0,z=void 0;;){if(D==q){for(var K=s=B=$="",z=null,D=Infinity,u=[],L=0;L<m.length;++L){var C=m[L],X=C.marker;C.from<=q&&(null==C.to||C.to>q)?(null!=C.to&&D>C.to&&(D=C.to,s=""),X.className&&(K+=" "+X.className),X.startStyle&&C.from==q&&(B+=" "+X.startStyle),X.endStyle&&C.to==D&&(s+=" "+X.endStyle),X.title&&!$&&($=X.title),X.collapsed&&(!z||z.marker.size<X.size)&&(z=C)):
C.from>q&&D>C.from&&(D=C.from);"bookmark"==X.type&&C.from==q&&X.replacedWith&&u.push(X)}if(z&&(z.from||0)==q&&(Zd(e,(null==z.to?x:z.to)-q,z.marker,null==z.from),null==z.to)){e=z.marker.find();break a}if(!z&&u.length)for(L=0;L<u.length;++L)Zd(e,0,u[L])}if(q>=x)break;for(u=Math.min(x,D);;){if(t){L=q+t.length;z||(C=L>u?t.slice(0,u-q):t,e.addToken(e,C,v?v+K:K,B,q+C.length==D?s:"",$));if(L>=u){t=t.slice(u-q);q=u;break}q=L;B=""}t=n.slice(p,p=k[l++]);v=Wd(k[l++],e)}}else for(var l=1;l<k.length;l+=2)e.addToken(e,
n.slice(p,p=k[l]),Wd(k[l+1],e));e=void 0}b&&f==d&&!c.measuredSomething&&(b[0]=c.pre.appendChild(Pb(a.display.measure)),c.measuredSomething=!0);e&&(f=H(a.doc,e.to.line))}while(e);!b||c.measuredSomething||b[0]||(b[0]=c.pre.appendChild(h?G("span","\u00a0"):Pb(a.display.measure)));c.pre.firstChild||fb(a.doc,d)||c.pre.appendChild(document.createTextNode("\u00a0"));var w;b&&(Y||ve)&&(w=Ca(f))&&(h=w.length-1,w[h].from==w[h].to&&--h,f=w[h],w=w[h-1],f.from+1==f.to&&w&&f.level<w.level&&(b=b[c.pos-1])&&b.parentNode.insertBefore(b.measureRight=
Pb(a.display.measure),b.nextSibling));if(b=c.textClass?c.textClass+" "+(d.textClass||""):d.textClass)c.pre.className=b;fa(a,"renderLine",a,d,c.pre);return c}function Yd(a,d,b,c,e,f){if(d){var h=a.cm.options.specialChars;if(h.test(d))for(var k=document.createDocumentFragment(),m=0;;){h.lastIndex=m;var n=h.exec(d),p=n?n.index-m:d.length-m;p&&(k.appendChild(document.createTextNode(d.slice(m,m+p))),a.col+=p);if(!n)break;m+=p+1;"\t"==n[0]?(n=a.cm.options.tabSize,n-=a.col%n,k.appendChild(G("span",Nd(n),
"cm-tab")),a.col+=n):(n=a.cm.options.specialCharPlaceholder(n[0]),k.appendChild(n),a.col+=1)}else{a.col+=d.length;var k=document.createTextNode(d)}if(b||c||e||a.measure)return d=b||"",c&&(d+=c),e&&(d+=e),n=G("span",[k],d),f&&(n.title=f),a.pre.appendChild(n);a.pre.appendChild(k)}}function te(a,d,b,c,e){for(var f=a.cm.options.lineWrapping,h=0;h<d.length;++h){var k=d.charAt(h),m=0==h;"\ud800"<=k&&"\udbff">k&&h<d.length-1?(k=d.slice(h,h+2),++h):h&&f&&dc(d,h)&&a.pre.appendChild(G("wbr"));var n=a.measure[a.pos],
m=a.measure[a.pos]=Yd(a,k,b,m&&c,h==d.length-1&&e);n&&(m.leftSide=n.leftSide||n);Y&&f&&" "==k&&h&&!/\s/.test(d.charAt(h-1))&&h<d.length-1&&!/\s/.test(d.charAt(h+1))&&(m.style.whiteSpace="normal");a.pos+=k.length}d.length&&(a.measuredSomething=!0)}function ue(a){function d(a){for(var d=" ",b=0;b<a.length-2;++b)d+=b%2?" ":"\u00a0";return d+" "}return function(b,c,e,f,h,k){return a(b,c.replace(/ {3,}/g,d),e,f,h,k)}}function Zd(a,d,b,c){if(c=!c&&b.replacedWith)if(a.copyWidgets&&(c=c.cloneNode(!0)),a.pre.appendChild(c),
a.measure){if(d)a.measure[a.pos]=c;else{var e=Pb(a.cm.display.measure);if("bookmark"!=b.type||b.insertLeft){if(a.measure[a.pos])return;a.measure[a.pos]=a.pre.insertBefore(e,c)}else a.measure[a.pos]=a.pre.appendChild(e)}a.measuredSomething=!0}a.pos+=d}function ld(a,d,b,c,e){function f(a,b,g){a.text=b;a.stateAfter&&(a.stateAfter=null);a.styles&&(a.styles=null);null!=a.order&&(a.order=null);Rd(a);Sd(a,g);b=e?e(a):1;b!=a.height&&ua(a,b);ha(a,"change",a,d)}var h=d.from,k=d.to,m=d.text,n=H(a,h.line),p=
H(a,k.line),x=na(m),q=b?b[m.length-1]:null,l=k.line-h.line;if(0!=h.ch||0!=k.ch||""!=x||a.cm&&!a.cm.options.wholeLineUpdateBefore)if(n==p)if(1==m.length)f(n,n.text.slice(0,h.ch)+x+n.text.slice(k.ch),q);else{K=[];t=1;for(D=m.length-1;t<D;++t)K.push(new Ya(m[t],b?b[t]:null,e));K.push(new Ya(x+n.text.slice(k.ch),q,e));f(n,n.text.slice(0,h.ch)+m[0],b?b[0]:null);a.insert(h.line+1,K)}else if(1==m.length)f(n,n.text.slice(0,h.ch)+m[0]+p.text.slice(k.ch),b?b[0]:null),a.remove(h.line+1,l);else{f(n,n.text.slice(0,
h.ch)+m[0],b?b[0]:null);f(p,x+p.text.slice(k.ch),q);t=1;D=m.length-1;for(K=[];t<D;++t)K.push(new Ya(m[t],b?b[t]:null,e));1<l&&a.remove(h.line+1,l-1);a.insert(h.line+1,K)}else{for(var t=0,D=m.length-1,K=[];t<D;++t)K.push(new Ya(m[t],b?b[t]:null,e));f(p,p.text,q);l&&a.remove(h.line,l);K.length&&a.insert(h.line,K)}ha(a,"change",a,d);Ta(a,c.anchor,c.head,null,!0)}function Hc(a){this.lines=a;this.parent=null;for(var d=0,b=a.length,c=0;d<b;++d)a[d].parent=this,c+=a[d].height;this.height=c}function ec(a){this.children=
a;for(var d=0,b=0,c=0,e=a.length;c<e;++c){var f=a[c],d=d+f.chunkSize(),b=b+f.height;f.parent=this}this.size=d;this.height=b;this.parent=null}function Fb(a,d,b){function c(a,e,f){if(a.linked)for(var h=0;h<a.linked.length;++h){var k=a.linked[h];if(k.doc!=e){var m=f&&k.sharedHist;if(!b||m)d(k.doc,m),c(k.doc,a,m)}}}c(a,null,!0)}function sd(a,d){if(d.cm)throw Error("This document is already in use.");a.doc=d;d.cm=a;w(a);t(a);a.options.lineWrapping||z(a);a.options.mode=d.modeOption;V(a)}function H(a,d){for(d-=
a.first;!a.lines;)for(var b=0;;++b){var c=a.children[b],e=c.chunkSize();if(d<e){a=c;break}d-=e}return a.lines[d]}function kd(a,d,b){var c=[],e=d.line;a.iter(d.line,b.line+1,function(a){a=a.text;e==b.line&&(a=a.slice(0,b.ch));e==d.line&&(a=a.slice(d.ch));c.push(a);++e});return c}function pd(a,d,b){var c=[];a.iter(d,b,function(a){c.push(a.text)});return c}function ua(a,d){for(var b=d-a.height,c=a;c;c=c.parent)c.height+=b}function pa(a){if(null==a.parent)return null;var d=a.parent;a=Aa(d.lines,a);for(var b=
d.parent;b;d=b,b=b.parent)for(var c=0;b.children[c]!=d;++c)a+=b.children[c].chunkSize();return a+d.first}function Mb(a,d){var b=a.first;a:do{for(var c=0,e=a.children.length;c<e;++c){var f=a.children[c],h=f.height;if(d<h){a=f;continue a}d-=h;b+=f.chunkSize()}return b}while(!a.lines);c=0;for(e=a.lines.length;c<e;++c){f=a.lines[c].height;if(d<f)break;d-=f}return b+c}function Ob(a,d){d=Ma(a.doc,d);for(var b=0,c=d.parent,e=0;e<c.lines.length;++e){var f=c.lines[e];if(f==d)break;else b+=f.height}for(f=c.parent;f;c=
f,f=c.parent)for(e=0;e<f.children.length;++e){var h=f.children[e];if(h==c)break;else b+=h.height}return b}function Ca(a){var d=a.order;null==d&&(d=a.order=we(a.text));return d}function Ic(a){return{done:[],undone:[],undoDepth:Infinity,lastTime:0,lastOp:null,lastOrigin:null,generation:a||1,maxGeneration:a||1}}function $d(a,d,b,c){var e=d["spans_"+a.id],f=0;a.iter(Math.max(a.first,b),Math.min(a.first+a.size,c),function(b){b.markedSpans&&((e||(e=d["spans_"+a.id]={}))[f]=b.markedSpans);++f})}function jd(a,
d){var b={from:{line:d.from.line,ch:d.from.ch},to:hd(d),text:kd(a,d.from,d.to)};$d(a,b,d.from.line,d.to.line+1);Fb(a,function(a){$d(a,b,d.from.line,d.to.line+1)},!0);return b}function Id(a,d,b,c){var e=a.history;e.undone.length=0;var f=+new Date,h=na(e.done);if(h&&(e.lastOp==c||e.lastOrigin==d.origin&&d.origin&&("+"==d.origin.charAt(0)&&a.cm&&e.lastTime>f-a.cm.options.historyEventDelay||"*"==d.origin.charAt(0)))){var k=na(h.changes);L(d.from,d.to)&&L(d.from,k.to)?k.to=hd(d):h.changes.push(jd(a,d));
h.anchorAfter=b.anchor;h.headAfter=b.head}else for(h={changes:[jd(a,d)],generation:e.generation,anchorBefore:a.sel.anchor,headBefore:a.sel.head,anchorAfter:b.anchor,headAfter:b.head},e.done.push(h),e.generation=++e.maxGeneration;e.done.length>e.undoDepth;)e.done.shift();e.lastTime=f;e.lastOp=c;e.lastOrigin=d.origin}function re(a){if(!a)return null;for(var d=0,b;d<a.length;++d)a[d].marker.explicitlyCleared?b||(b=a.slice(0,d)):b&&b.push(a[d]);return b?b.length?b:null:a}function Jc(a,d){for(var b=0,
c=[];b<a.length;++b){var e=a[b],f=e.changes,h=[];c.push({changes:h,anchorBefore:e.anchorBefore,headBefore:e.headBefore,anchorAfter:e.anchorAfter,headAfter:e.headAfter});for(e=0;e<f.length;++e){var k=f[e],m;h.push({from:k.from,to:k.to,text:k.text});if(d)for(var n in k)(m=n.match(/^spans_(\d+)$/))&&-1<Aa(d,Number(m[1]))&&(na(h)[n]=k[n],delete k[n])}}return c}function Kc(a,d,b,c){b<a.line?a.line+=c:d<a.line&&(a.line=d,a.ch=0)}function ae(a,d,b,c){for(var e=0;e<a.length;++e){for(var f=a[e],h=!0,k=0;k<
f.changes.length;++k){var m=f.changes[k];f.copied||(m.from=nb(m.from),m.to=nb(m.to));if(b<m.from.line)m.from.line+=c,m.to.line+=c;else if(d<=m.to.line){h=!1;break}}f.copied||(f.anchorBefore=nb(f.anchorBefore),f.headBefore=nb(f.headBefore),f.anchorAfter=nb(f.anchorAfter),f.readAfter=nb(f.headAfter),f.copied=!0);h?(Kc(f.anchorBefore),Kc(f.headBefore),Kc(f.anchorAfter),Kc(f.headAfter)):(a.splice(0,e+1),e=0)}}function Jd(a,d){var b=d.from.line,c=d.to.line,e=d.text.length-(c-b)-1;ae(a.done,b,c,e);ae(a.undone,
b,c,e)}function xe(){Tb(this)}function Sb(a){a.stop||(a.stop=xe);return a}function ba(a){a.preventDefault?a.preventDefault():a.returnValue=!1}function be(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}function bd(a){return null!=a.defaultPrevented?a.defaultPrevented:!1==a.returnValue}function Tb(a){ba(a);be(a)}function Cd(a){var d=a.which;null==d&&(a.button&1?d=1:a.button&2?d=3:a.button&4&&(d=2));vb&&a.ctrlKey&&1==d&&(d=3);return d}function N(a,d,b){a.addEventListener?a.addEventListener(d,
b,!1):a.attachEvent?a.attachEvent("on"+d,b):(a=a._handlers||(a._handlers={}),(a[d]||(a[d]=[])).push(b))}function Ra(a,d,b){if(a.removeEventListener)a.removeEventListener(d,b,!1);else if(a.detachEvent)a.detachEvent("on"+d,b);else if(a=a._handlers&&a._handlers[d])for(d=0;d<a.length;++d)if(a[d]==b){a.splice(d,1);break}}function fa(a,d){var b=a._handlers&&a._handlers[d];if(b)for(var c=Array.prototype.slice.call(arguments,2),e=0;e<b.length;++e)b[e].apply(null,c)}function ha(a,d){function b(a){return function(){a.apply(null,
e)}}var c=a._handlers&&a._handlers[d];if(c){var e=Array.prototype.slice.call(arguments,2);Za||(++vc,Za=[],setTimeout(ye,0));for(var f=0;f<c.length;++f)Za.push(b(c[f]))}}function Fa(a,d,b){fa(a,b||d.type,a,d);return bd(d)||d.codemirrorIgnore}function ye(){--vc;var a=Za;Za=null;for(var d=0;d<a.length;++d)a[d]()}function Ha(a,d){var b=a._handlers&&a._handlers[d];return b&&0<b.length}function Hb(a){a.prototype.on=function(a,b){N(this,a,b)};a.prototype.off=function(a,b){Ra(this,a,b)}}function Oc(){this.id=
null}function yb(a,d,b,c,e){null==d&&(d=a.search(/[^\s\u00a0]/),-1==d&&(d=a.length));c=c||0;for(e=e||0;c<d;++c)"\t"==a.charAt(c)?e+=b-e%b:++e;return e}function Nd(a){for(;Lc.length<=a;)Lc.push(na(Lc)+" ");return Lc[a]}function na(a){return a[a.length-1]}function Ad(a){if(Ib)a.selectionStart=0,a.selectionEnd=a.value.length;else try{a.select()}catch(d){}}function Aa(a,d){if(a.indexOf)return a.indexOf(d);for(var b=0,c=a.length;b<c;++b)if(a[b]==d)return b;return-1}function ce(a,d){function b(){}b.prototype=
a;var c=new b;d&&Fc(d,c);return c}function Fc(a,d){d||(d={});for(var b in a)a.hasOwnProperty(b)&&(d[b]=a[b]);return d}function xd(a){for(var d=[],b=0;b<a;++b)d.push(void 0);return d}function ta(a){var d=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,d)}}function Zb(a){return/\w/.test(a)||"\u0080"<a&&(a.toUpperCase()!=a.toLowerCase()||ze.test(a))}function de(a){for(var d in a)if(a.hasOwnProperty(d)&&a[d])return!1;return!0}function G(a,d,b,c){a=document.createElement(a);
b&&(a.className=b);c&&(a.style.cssText=c);if("string"==typeof d)ud(a,d);else if(d)for(b=0;b<d.length;++b)a.appendChild(d[b]);return a}function Kb(a){for(var d=a.childNodes.length;0<d;--d)a.removeChild(a.firstChild);return a}function Da(a,d){return Kb(a).appendChild(d)}function ud(a,d){qa?(a.innerHTML="",a.appendChild(document.createTextNode(d))):a.textContent=d}function Z(a){return a.getBoundingClientRect()}function dc(){return!1}function Lb(a){if(null!=Rb)return Rb;var d=G("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");
Da(a,d);d.offsetWidth&&(Rb=d.offsetHeight-d.clientHeight);return Rb||0}function Pb(a){if(null==qd){var d=G("span","\u200b");Da(a,G("span",[d,document.createTextNode("x")]));0!=a.firstChild.offsetHeight&&(qd=1>=d.offsetWidth&&2<d.offsetHeight&&!sb)}return qd?G("span","\u200b"):G("span","\u00a0",null,"display: inline-block; width: 1px; margin-right: -1px")}function ie(a,d,b,c){if(!a)return c(d,b,"ltr");for(var e=!1,f=0;f<a.length;++f){var h=a[f];if(h.from<b&&h.to>d||d==b&&h.to==d)c(Math.max(h.from,
d),Math.min(h.to,b),1==h.level?"rtl":"ltr"),e=!0}e||c(d,b,"ltr")}function Uc(a){return a.level%2?a.to:a.from}function Vc(a){return a.level%2?a.from:a.to}function tc(a){return(a=Ca(a))?Uc(a[0]):0}function uc(a){var d=Ca(a);return d?Vc(na(d)):a.text.length}function ee(a,d){var b=H(a.doc,d),c=Ma(a.doc,b);c!=b&&(d=pa(c));c=(b=Ca(c))?b[0].level%2?uc(c):tc(c):0;return B(d,c)}function Ae(a,d){for(var b,c;b=jc(c=H(a.doc,d));)d=b.find().to.line;c=(b=Ca(c))?b[0].level%2?tc(c):uc(c):c.text.length;return B(d,
c)}function Wc(a,d){for(var b=0,c;b<a.length;++b){var e=a[b];if(e.from<d&&e.to>d)return Bb=null,b;if(e.from==d||e.to==d)if(null==c)c=b;else{var e=e.level,f=a[c].level,h=a[0].level,e=e==h?!0:f==h?!1:e<f;if(e)return Bb=c,b;Bb=b;return c}}Bb=null;return c}function rd(a,d,b,c){if(!c)return d+b;do d+=b;while(0<d&&Yc.test(a.text.charAt(d)));return d}function Xc(a,d,b,c){var e=Ca(a);if(!e)return Od(a,d,b,c);var f=Wc(e,d),h=e[f];for(d=rd(a,d,h.level%2?-b:b,c);;){if(d>h.from&&d<h.to)return d;if(d==h.from||
d==h.to){if(Wc(e,d)==f)return d;h=e[f+b];return 0<b==h.level%2?h.to:h.from}h=e[f+=b];if(!h)return null;d=0<b==h.level%2?rd(a,h.to,-1,c):rd(a,h.from,1,c)}}function Od(a,d,b,c){d+=b;if(c)for(;0<d&&Yc.test(a.text.charAt(d));)d+=b;return 0>d||d>a.text.length?null:d}var Db=/gecko\/\d/i.test(navigator.userAgent),Y=/MSIE \d/.test(navigator.userAgent),sb=Y&&(null==document.documentMode||8>document.documentMode),qa=Y&&(null==document.documentMode||9>document.documentMode),ve=/Trident\/([7-9]|\d{2,})\./.test(navigator.userAgent),
ca=/WebKit\//.test(navigator.userAgent),Be=ca&&/Qt\/\d+\.\d+/.test(navigator.userAgent),Ce=/Chrome\//.test(navigator.userAgent),xa=/Opera\//.test(navigator.userAgent),ad=/Apple Computer/.test(navigator.vendor),Rc=/KHTML\//.test(navigator.userAgent),ge=/Mac OS X 1\d\D([7-9]|\d\d)\D/.test(navigator.userAgent),he=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),ke=/PhantomJS/.test(navigator.userAgent),Ib=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),Nc=Ib||
/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),vb=Ib||/Mac/.test(navigator.platform),De=/win/i.test(navigator.platform),pb=xa&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);pb&&(pb=Number(pb[1]));pb&&15<=pb&&(xa=!1,ca=!0);var Qd=vb&&(Be||xa&&(null==pb||12.11>pb)),$c=Db||Y&&!qa,Hd=!1,Nb=!1,ib,je=0,yc,xc,Bd=0,zc=0,ya=null;Y?ya=-0.53:Db?ya=15:Ce?ya=-0.7:ad&&(ya=-1/3);var Ed,fd=null,gd,hd=l.changeEnd=function(a){return a.text?B(a.from.line+a.text.length-1,na(a.text).length+
(1==a.text.length?a.from.ch:0)):a.to};l.Pos=B;l.prototype={constructor:l,focus:function(){window.focus();ka(this);Ea(this)},setOption:function(a,d){var b=this.options,c=b[a];if(b[a]!=d||"mode"==a)b[a]=d,qb.hasOwnProperty(a)&&J(this,qb[a])(this,d,c)},getOption:function(a){return this.options[a]},getDoc:function(){return this.doc},addKeyMap:function(a,d){this.state.keyMaps[d?"push":"unshift"](a)},removeKeyMap:function(a){for(var d=this.state.keyMaps,b=0;b<d.length;++b)if(d[b]==a||"string"!=typeof d[b]&&
d[b].name==a)return d.splice(b,1),!0},addOverlay:J(null,function(a,d){var b=a.token?a:l.getMode(this.options,a);if(b.startState)throw Error("Overlays may not be stateful.");this.state.overlays.push({mode:b,modeSpec:a,opaque:d&&d.opaque});this.state.modeGen++;V(this)}),removeOverlay:J(null,function(a){for(var d=this.state.overlays,b=0;b<d.length;++b){var c=d[b].modeSpec;if(c==a||"string"==typeof a&&c.name==a){d.splice(b,1);this.state.modeGen++;V(this);break}}}),indentLine:J(null,function(a,d,b){"string"!=
typeof d&&"number"!=typeof d&&(d=null==d?this.options.smartIndent?"smart":"prev":d?"add":"subtract");Gb(this.doc,a)&&Ac(this,a,d,b)}),indentSelection:J(null,function(a){var d=this.doc.sel;if(L(d.from,d.to))return Ac(this,d.from.line,a);for(var b=d.to.line-(d.to.ch?0:1),d=d.from.line;d<=b;++d)Ac(this,d,a)}),getTokenAt:function(a,d){var b=this.doc;a=C(b,a);for(var c=ia(this,a.line,d),e=this.doc.mode,b=H(b,a.line),b=new $b(b.text,this.options.tabSize);b.pos<a.ch&&!b.eol();){b.start=b.pos;var f=e.token(b,
c)}return{start:b.start,end:b.pos,string:b.current(),className:f||null,type:f||null,state:c}},getTokenTypeAt:function(a){a=C(this.doc,a);var d=Vd(this,H(this.doc,a.line)),b=0,c=(d.length-1)/2;a=a.ch;if(0==a)return d[2];for(;;){var e=b+c>>1;if((e?d[2*e-1]:0)>=a)c=e;else if(d[2*e+1]<a)b=e+1;else return d[2*e+2]}},getModeAt:function(a){var d=this.doc.mode;return d.innerMode?l.innerMode(d,this.getTokenAt(a).state).mode:d},getHelper:function(a,d){if(fc.hasOwnProperty(d)){var b=fc[d],c=this.getModeAt(a);
return c[d]&&b[c[d]]||c.helperType&&b[c.helperType]||b[c.name]}},getStateAfter:function(a,d){var b=this.doc;a=Math.max(b.first,Math.min(null==a?b.first+b.size-1:a,b.first+b.size-1));return ia(this,a+1,d)},cursorCoords:function(a,d){var b;b=this.doc.sel;b=null==a?b.head:"object"==typeof a?C(this.doc,a):a?b.from:b.to;return ma(this,b,d||"page")},charCoords:function(a,d){return Na(this,C(this.doc,a),d||"page")},coordsChar:function(a,d){a=Ab(this,a,d||"page");return Cb(this,a.left,a.top)},lineAtHeight:function(a,
d){a=Ab(this,{top:a,left:0},d||"page").top;return Mb(this.doc,a+this.display.viewOffset)},heightAtLine:function(a,d){var b=!1,c=this.doc.first+this.doc.size-1;a<this.doc.first?a=this.doc.first:a>c&&(a=c,b=!0);c=H(this.doc,a);return hb(this,H(this.doc,a),{top:0,left:0},d||"page").top+(b?c.height:0)},defaultTextHeight:function(){return za(this.display)},defaultCharWidth:function(){return Jb(this.display)},setGutterMarker:J(null,function(a,d,b){return Ec(this,a,function(a){var c=a.gutterMarkers||(a.gutterMarkers=
{});c[d]=b;!b&&de(c)&&(a.gutterMarkers=null);return!0})}),clearGutter:J(null,function(a){var d=this,b=d.doc,c=b.first;b.iter(function(b){b.gutterMarkers&&b.gutterMarkers[a]&&(b.gutterMarkers[a]=null,V(d,c,c+1),de(b.gutterMarkers)&&(b.gutterMarkers=null));++c})}),addLineClass:J(null,function(a,d,b){return Ec(this,a,function(a){var c="text"==d?"textClass":"background"==d?"bgClass":"wrapClass";if(a[c]){if((new RegExp("(?:^|\\s)"+b+"(?:$|\\s)")).test(a[c]))return!1;a[c]+=" "+b}else a[c]=b;return!0})}),
removeLineClass:J(null,function(a,d,b){return Ec(this,a,function(a){var c="text"==d?"textClass":"background"==d?"bgClass":"wrapClass",e=a[c];if(e)if(null==b)a[c]=null;else{var f=e.match(new RegExp("(?:^|\\s+)"+b+"(?:$|\\s+)"));if(!f)return!1;var h=f.index+f[0].length;a[c]=e.slice(0,f.index)+(f.index&&h!=e.length?" ":"")+e.slice(h)||null}else return!1;return!0})}),addLineWidget:J(null,function(a,d,b){return se(this,a,d,b)}),removeLineWidget:function(a){a.clear()},lineInfo:function(a){if("number"==
typeof a){if(!Gb(this.doc,a))return null;var d=a;a=H(this.doc,a);if(!a)return null}else if(d=pa(a),null==d)return null;return{line:d,handle:a,text:a.text,gutterMarkers:a.gutterMarkers,textClass:a.textClass,bgClass:a.bgClass,wrapClass:a.wrapClass,widgets:a.widgets}},getViewport:function(){return{from:this.display.showingFrom,to:this.display.showingTo}},addWidget:function(a,d,b,c,e){var f=this.display;a=ma(this,C(this.doc,a));var h=a.bottom,k=a.left;d.style.position="absolute";f.sizer.appendChild(d);
if("over"==c)h=a.top;else if("above"==c||"near"==c){var m=Math.max(f.wrapper.clientHeight,this.doc.height),n=Math.max(f.sizer.clientWidth,f.lineSpace.clientWidth);("above"==c||a.bottom+d.offsetHeight>m)&&a.top>d.offsetHeight?h=a.top-d.offsetHeight:a.bottom+d.offsetHeight<=m&&(h=a.bottom);k+d.offsetWidth>n&&(k=n-d.offsetWidth)}d.style.top=h+"px";d.style.left=d.style.right="";"right"==e?(k=f.sizer.clientWidth-d.offsetWidth,d.style.right="0px"):("left"==e?k=0:"middle"==e&&(k=(f.sizer.clientWidth-d.offsetWidth)/
2),d.style.left=k+"px");b&&(a=wc(this,k,h,k+d.offsetWidth,h+d.offsetHeight),null!=a.scrollTop&&cb(this,a.scrollTop),null!=a.scrollLeft&&ab(this,a.scrollLeft))},triggerOnKeyDown:J(null,b),execCommand:function(a){return dd[a](this)},findPosH:function(a,d,b,c){var e=1;0>d&&(e=-1,d=-d);var f=0;for(a=C(this.doc,a);f<d&&(a=nd(this.doc,a,e,b,c),!a.hitSide);++f);return a},moveH:J(null,function(a,d){var b=this.doc.sel,b=b.shift||b.extend||L(b.from,b.to)?nd(this.doc,b.head,a,d,this.options.rtlMoveVisually):
0>a?b.from:b.to;ja(this.doc,b,b,a)}),deleteH:J(null,function(a,d){var b=this.doc.sel;L(b.from,b.to)?X(this.doc,"",b.from,nd(this.doc,b.head,a,d,!1),"+delete"):X(this.doc,"",b.from,b.to,"+delete");this.curOp.userSelChange=!0}),findPosV:function(a,d,b,c){var e=1;0>d&&(e=-1,d=-d);var f=0;for(a=C(this.doc,a);f<d&&(a=ma(this,a,"div"),null==c?c=a.left:a.left=c,a=Pd(this,a,e,b),!a.hitSide);++f);return a},moveV:J(null,function(a,d){var b=this.doc.sel,c=ma(this,b.head,"div");null!=b.goalColumn&&(c.left=b.goalColumn);
var e=Pd(this,c,a,d);"page"==d&&md(this,0,Na(this,e,"div").top-c.top);ja(this.doc,e,e,a);b.goalColumn=c.left}),toggleOverwrite:function(a){if(null==a||a!=this.state.overwrite)(this.state.overwrite=!this.state.overwrite)?this.display.cursor.className+=" CodeMirror-overwrite":this.display.cursor.className=this.display.cursor.className.replace(" CodeMirror-overwrite","")},hasFocus:function(){return this.state.focused},scrollTo:J(null,function(a,d){Dc(this,a,d)}),getScrollInfo:function(){var a=this.display.scroller,
d=rb;return{left:a.scrollLeft,top:a.scrollTop,height:a.scrollHeight-d,width:a.scrollWidth-d,clientHeight:a.clientHeight-d,clientWidth:a.clientWidth-d}},scrollIntoView:J(null,function(a,d){null==a?a={from:this.doc.sel.head,to:null}:"number"==typeof a?a={from:B(a,0),to:null}:null==a.from&&(a={from:a,to:null});a.to||(a.to=a.from);d||(d=0);var b=a;null!=a.from.line&&(this.curOp.scrollToPos={from:a.from,to:a.to,margin:d},b={from:ma(this,a.from),to:ma(this,a.to)});b=wc(this,Math.min(b.from.left,b.to.left),
Math.min(b.from.top,b.to.top)-d,Math.max(b.from.right,b.to.right),Math.max(b.from.bottom,b.to.bottom)+d);Dc(this,b.scrollLeft,b.scrollTop)}),setSize:J(null,function(a,b){function c(a){return"number"==typeof a||/^\d+$/.test(String(a))?a+"px":a}null!=a&&(this.display.wrapper.style.width=c(a));null!=b&&(this.display.wrapper.style.height=c(b));this.options.lineWrapping&&(this.display.measureLineCache.length=this.display.measureLineCachePos=0);this.curOp.forceUpdate=!0}),operation:function(a){return Qb(this,
a)},refresh:J(null,function(){var a=null==this.display.cachedTextHeight;Ka(this);Dc(this,this.doc.scrollLeft,this.doc.scrollTop);V(this);a&&w(this)}),swapDoc:J(null,function(a){var b=this.doc;b.cm=null;sd(this,a);Ka(this);ra(this,!0);Dc(this,a.scrollLeft,a.scrollTop);ha(this,"swapDoc",this,b);return b}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};
Hb(l);var qb=l.optionHandlers={},Mc=l.defaults={},td=l.Init={toString:function(){return"CodeMirror.Init"}};I("value","",function(a,b){a.setValue(b)},!0);I("mode",null,function(a,b){a.doc.modeOption=b;t(a)},!0);I("indentUnit",2,t,!0);I("indentWithTabs",!1);I("smartIndent",!0);I("tabSize",4,function(a){t(a);Ka(a);V(a)},!0);I("specialChars",/[\t\u0000-\u0019\u00ad\u200b\u2028\u2029\ufeff]/g,function(a,b){a.options.specialChars=new RegExp(b.source+(b.test("\t")?"":"|\t"),"g");a.refresh()},!0);I("specialCharPlaceholder",
function(a){var b=G("span","\u2022","cm-invalidchar");b.title="\\u"+a.charCodeAt(0).toString(16);return b},function(a){a.refresh()},!0);I("electricChars",!0);I("rtlMoveVisually",!De);I("wholeLineUpdateBefore",!0);I("theme","default",function(a){R(a);M(a)},!0);I("keyMap","default",A);I("extraKeys",null);I("onKeyEvent",null);I("onDragEvent",null);I("lineWrapping",!1,function(a){a.options.lineWrapping?(a.display.wrapper.className+=" CodeMirror-wrap",a.display.sizer.style.minWidth=""):(a.display.wrapper.className=
a.display.wrapper.className.replace(" CodeMirror-wrap",""),z(a));w(a);V(a);Ka(a);setTimeout(function(){u(a)},100)},!0);I("gutters",[],function(a){S(a.options);M(a)},!0);I("fixedGutter",!0,function(a,b){a.display.gutters.style.left=b?W(a.display)+"px":"0";a.refresh()},!0);I("coverGutterNextToScrollbar",!1,u,!0);I("lineNumbers",!1,function(a){S(a.options);M(a)},!0);I("firstLineNumber",1,M,!0);I("lineNumberFormatter",function(a){return a},M,!0);I("showCursorWhenSelecting",!1,La,!0);I("resetSelectionOnContextMenu",
!0);I("readOnly",!1,function(a,b){"nocursor"==b?(f(a),a.display.input.blur(),a.display.disabled=!0):(a.display.disabled=!1,b||ra(a,!0))});I("dragDrop",!0);I("cursorBlinkRate",530);I("cursorScrollMargin",0);I("cursorHeight",1);I("workTime",100);I("workDelay",100);I("flattenSpans",!0);I("pollInterval",100);I("undoDepth",40,function(a,b){a.doc.history.undoDepth=b});I("historyEventDelay",500);I("viewportMargin",10,function(a){a.refresh()},!0);I("maxHighlightLength",1E4,function(a){t(a);a.refresh()},!0);
I("crudeMeasuringFrom",1E4);I("moveInputWithCursor",!0,function(a,b){b||(a.display.inputDiv.style.top=a.display.inputDiv.style.left=0)});I("tabindex",null,function(a,b){a.display.input.tabIndex=b||""});I("autofocus",null);var fe=l.modes={},gc=l.mimeModes={};l.defineMode=function(a,b){l.defaults.mode||"null"==a||(l.defaults.mode=a);if(2<arguments.length){b.dependencies=[];for(var c=2;c<arguments.length;++c)b.dependencies.push(arguments[c])}fe[a]=b};l.defineMIME=function(a,b){gc[a]=b};l.resolveMode=
function(a){if("string"==typeof a&&gc.hasOwnProperty(a))a=gc[a];else if(a&&"string"==typeof a.name&&gc.hasOwnProperty(a.name)){var b=gc[a.name];a=ce(b,a);a.name=b.name}else if("string"==typeof a&&/^[\w\-]+\/[\w\-]+\+xml$/.test(a))return l.resolveMode("application/xml");return"string"==typeof a?{name:a}:a||{name:"null"}};l.getMode=function(a,b){b=l.resolveMode(b);var c=fe[b.name];if(!c)return l.getMode(a,"text/plain");c=c(a,b);if(hc.hasOwnProperty(b.name)){var e=hc[b.name],f;for(f in e)e.hasOwnProperty(f)&&
(c.hasOwnProperty(f)&&(c["_"+f]=c[f]),c[f]=e[f])}c.name=b.name;return c};l.defineMode("null",function(){return{token:function(a){a.skipToEnd()}}});l.defineMIME("text/plain","null");var hc=l.modeExtensions={};l.extendMode=function(a,b){var c=hc.hasOwnProperty(a)?hc[a]:hc[a]={};Fc(b,c)};l.defineExtension=function(a,b){l.prototype[a]=b};l.defineDocExtension=function(a,b){la.prototype[a]=b};l.defineOption=I;var Qc=[];l.defineInitHook=function(a){Qc.push(a)};var fc=l.helpers={};l.registerHelper=function(a,
b,c){fc.hasOwnProperty(a)||(fc[a]=l[a]={});fc[a][b]=c};l.isWordChar=Zb;l.copyState=xb;l.startState=wd;l.innerMode=function(a,b){for(;a.innerMode;){var c=a.innerMode(b);if(!c||c.mode==a)break;b=c.state;a=c.mode}return c||{mode:a,state:b}};var dd=l.commands={selectAll:function(a){a.setSelection(B(a.firstLine(),0),B(a.lastLine()))},killLine:function(a){var b=a.getCursor(!0),c=a.getCursor(!1),e=!L(b,c);e||a.getLine(b.line).length!=b.ch?a.replaceRange("",b,e?c:B(b.line),"+delete"):a.replaceRange("",b,
B(b.line+1,0),"+delete")},deleteLine:function(a){var b=a.getCursor().line;a.replaceRange("",B(b,0),B(b),"+delete")},delLineLeft:function(a){var b=a.getCursor();a.replaceRange("",B(b.line,0),b,"+delete")},undo:function(a){a.undo()},redo:function(a){a.redo()},goDocStart:function(a){a.extendSelection(B(a.firstLine(),0))},goDocEnd:function(a){a.extendSelection(B(a.lastLine()))},goLineStart:function(a){a.extendSelection(ee(a,a.getCursor().line))},goLineStartSmart:function(a){var b=a.getCursor(),c=ee(a,
b.line),e=a.getLineHandle(c.line),f=Ca(e);f&&0!=f[0].level?a.extendSelection(c):(e=Math.max(0,e.text.search(/\S/)),a.extendSelection(B(c.line,b.line==c.line&&b.ch<=e&&b.ch?0:e)))},goLineEnd:function(a){a.extendSelection(Ae(a,a.getCursor().line))},goLineRight:function(a){var b=a.charCoords(a.getCursor(),"div").top+5;a.extendSelection(a.coordsChar({left:a.display.lineDiv.offsetWidth+100,top:b},"div"))},goLineLeft:function(a){var b=a.charCoords(a.getCursor(),"div").top+5;a.extendSelection(a.coordsChar({left:0,
top:b},"div"))},goLineUp:function(a){a.moveV(-1,"line")},goLineDown:function(a){a.moveV(1,"line")},goPageUp:function(a){a.moveV(-1,"page")},goPageDown:function(a){a.moveV(1,"page")},goCharLeft:function(a){a.moveH(-1,"char")},goCharRight:function(a){a.moveH(1,"char")},goColumnLeft:function(a){a.moveH(-1,"column")},goColumnRight:function(a){a.moveH(1,"column")},goWordLeft:function(a){a.moveH(-1,"word")},goGroupRight:function(a){a.moveH(1,"group")},goGroupLeft:function(a){a.moveH(-1,"group")},goWordRight:function(a){a.moveH(1,
"word")},delCharBefore:function(a){a.deleteH(-1,"char")},delCharAfter:function(a){a.deleteH(1,"char")},delWordBefore:function(a){a.deleteH(-1,"word")},delWordAfter:function(a){a.deleteH(1,"word")},delGroupBefore:function(a){a.deleteH(-1,"group")},delGroupAfter:function(a){a.deleteH(1,"group")},indentAuto:function(a){a.indentSelection("smart")},indentMore:function(a){a.indentSelection("add")},indentLess:function(a){a.indentSelection("subtract")},insertTab:function(a){a.replaceSelection("\t","end",
"+input")},defaultTab:function(a){a.somethingSelected()?a.indentSelection("add"):a.replaceSelection("\t","end","+input")},transposeChars:function(a){var b=a.getCursor(),c=a.getLine(b.line);0<b.ch&&b.ch<c.length-1&&a.replaceRange(c.charAt(b.ch)+c.charAt(b.ch-1),B(b.line,b.ch-1),B(b.line,b.ch+1))},newlineAndIndent:function(a){J(a,function(){a.replaceSelection("\n","end","+input");a.indentLine(a.getCursor().line,null,!0)})()},toggleOverwrite:function(a){a.toggleOverwrite()}},Ja=l.keyMap={};Ja.basic=
{Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite"};Ja.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Alt-Up":"goDocStart","Ctrl-End":"goDocEnd",
"Ctrl-Down":"goDocEnd","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore",fallthrough:"basic"};Ja.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart",
"Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delLineLeft",fallthrough:["basic","emacsy"]};Ja["default"]=vb?Ja.macDefault:
Ja.pcDefault;Ja.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"};l.lookupKey=Yb;l.isModifierKey=Fd;l.keyName=Gd;l.fromTextArea=function(a,b){function c(){a.value=p.getValue()}
b||(b={});b.value=a.value;!b.tabindex&&a.tabindex&&(b.tabindex=a.tabindex);!b.placeholder&&a.placeholder&&(b.placeholder=a.placeholder);if(null==b.autofocus){var e=document.body;try{e=document.activeElement}catch(f){}b.autofocus=e==a||null!=a.getAttribute("autofocus")&&e==document.body}if(a.form&&(N(a.form,"submit",c),!b.leaveSubmitMethodAlone)){var h=a.form,k=h.submit;try{var m=h.submit=function(){c();h.submit=k;h.submit();h.submit=m}}catch(n){}}a.style.display="none";var p=l(function(b){a.parentNode.insertBefore(b,
a.nextSibling)},b);p.save=c;p.getTextArea=function(){return a};p.toTextArea=function(){c();a.parentNode.removeChild(p.getWrapperElement());a.style.display="";a.form&&(Ra(a.form,"submit",c),"function"==typeof a.form.submit&&(a.form.submit=k))};return p};$b.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return 0==this.pos},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},
eat:function(a){var b=this.string.charAt(this.pos);if("string"==typeof a?b==a:b&&(a.test?a.test(b):a(b)))return++this.pos,b},eatWhile:function(a){for(var b=this.pos;this.eat(a););return this.pos>b},eatSpace:function(){for(var a=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>a},skipToEnd:function(){this.pos=this.string.length},skipTo:function(a){a=this.string.indexOf(a,this.pos);if(-1<a)return this.pos=a,!0},backUp:function(a){this.pos-=a},column:function(){this.lastColumnPos<
this.start&&(this.lastColumnValue=yb(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue},indentation:function(){return yb(this.string,null,this.tabSize)},match:function(a,b,c){if("string"==typeof a){var e=function(a){return c?a.toLowerCase():a},f=this.string.substr(this.pos,a.length);if(e(f)==e(a))return!1!==b&&(this.pos+=a.length),!0}else{if((a=this.string.slice(this.pos).match(a))&&0<a.index)return null;a&&!1!==
b&&(this.pos+=a[0].length);return a}},current:function(){return this.string.slice(this.start,this.pos)}};l.StringStream=$b;l.TextMarker=eb;Hb(eb);eb.prototype.clear=function(){if(!this.explicitlyCleared){var a=this.doc.cm,b=a&&!a.curOp;b&&Pa(a);if(Ha(this,"clear")){var c=this.find();c&&ha(this,"clear",c.from,c.to)}for(var e=c=null,f=0;f<this.lines.length;++f){var h=this.lines[f],k=cc(h.markedSpans,this);null!=k.to&&(e=pa(h));for(var m=h,n=h.markedSpans,p=k,x=void 0,l=0;l<n.length;++l)n[l]!=p&&(x||
(x=[])).push(n[l]);m.markedSpans=x;null!=k.from?c=pa(h):this.collapsed&&!fb(this.doc,h)&&a&&ua(h,za(a.display))}if(a&&this.collapsed&&!a.options.lineWrapping)for(f=0;f<this.lines.length;++f)h=Ma(a.doc,this.lines[f]),k=q(a.doc,h),k>a.display.maxLineLength&&(a.display.maxLine=h,a.display.maxLineLength=k,a.display.maxLineChanged=!0);null!=c&&a&&V(a,c,e+1);this.lines.length=0;this.explicitlyCleared=!0;this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,a&&Md(a));b&&$a(a)}};eb.prototype.find=function(){for(var a,
b,c=0;c<this.lines.length;++c){var e=this.lines[c],f=cc(e.markedSpans,this);if(null!=f.from||null!=f.to)e=pa(e),null!=f.from&&(a=B(e,f.from)),null!=f.to&&(b=B(e,f.to))}return"bookmark"==this.type?a:a&&{from:a,to:b}};eb.prototype.changed=function(){var a=this.find(),b=this.doc.cm;if(a&&b){"bookmark"!=this.type&&(a=a.from);var c=H(this.doc,a.line);zb(b,c);if(a.line>=b.display.showingFrom&&a.line<b.display.showingTo){for(a=b.display.lineDiv.firstChild;a;a=a.nextSibling)if(a.lineObj==c){a.offsetHeight!=
c.height&&ua(c,a.offsetHeight);break}Qb(b,function(){b.curOp.selectionChanged=b.curOp.forceUpdate=b.curOp.updateMaxLine=!0})}}};eb.prototype.attachLine=function(a){if(!this.lines.length&&this.doc.cm){var b=this.doc.cm.curOp;b.maybeHiddenMarkers&&-1!=Aa(b.maybeHiddenMarkers,this)||(b.maybeUnhiddenMarkers||(b.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(a)};eb.prototype.detachLine=function(a){this.lines.splice(Aa(this.lines,a),1);!this.lines.length&&this.doc.cm&&(a=this.doc.cm.curOp,(a.maybeHiddenMarkers||
(a.maybeHiddenMarkers=[])).push(this))};l.SharedTextMarker=bc;Hb(bc);bc.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var a=0;a<this.markers.length;++a)this.markers[a].clear();ha(this,"clear")}};bc.prototype.find=function(){return this.primary.find()};var Gc=l.LineWidget=function(a,b,c){if(c)for(var e in c)c.hasOwnProperty(e)&&(this[e]=c[e]);this.cm=a;this.node=b};Hb(Gc);Gc.prototype.clear=Td(function(){var a=this.line.widgets,b=pa(this.line);if(null!=b&&a){for(var c=
0;c<a.length;++c)a[c]==this&&a.splice(c--,1);a.length||(this.line.widgets=null);a=Ob(this.cm,this.line)<this.cm.doc.scrollTop;ua(this.line,Math.max(0,this.line.height-rc(this)));a&&md(this.cm,0,-this.height);V(this.cm,b,b+1)}});Gc.prototype.changed=Td(function(){var a=this.height;this.height=null;if(a=rc(this)-a)ua(this.line,this.line.height+a),a=pa(this.line),V(this.cm,a,a+1)});var Ya=l.Line=function(a,b,c){this.text=a;Sd(this,b);this.height=c?c(this):1};Hb(Ya);Ya.prototype.lineNo=function(){return pa(this)};
var Xd={};Hc.prototype={chunkSize:function(){return this.lines.length},removeInner:function(a,b){for(var c=a,e=a+b;c<e;++c){var f=this.lines[c];this.height-=f.height;var h=f;h.parent=null;Rd(h);ha(f,"delete")}this.lines.splice(a,b)},collapse:function(a){a.splice.apply(a,[a.length,0].concat(this.lines))},insertInner:function(a,b,c){this.height+=c;this.lines=this.lines.slice(0,a).concat(b).concat(this.lines.slice(a));a=0;for(c=b.length;a<c;++a)b[a].parent=this},iterN:function(a,b,c){for(b=a+b;a<b;++a)if(c(this.lines[a]))return!0}};
ec.prototype={chunkSize:function(){return this.size},removeInner:function(a,b){this.size-=b;for(var c=0;c<this.children.length;++c){var e=this.children[c],f=e.chunkSize();if(a<f){var h=Math.min(b,f-a),k=e.height;e.removeInner(a,h);this.height-=k-e.height;f==h&&(this.children.splice(c--,1),e.parent=null);if(0==(b-=h))break;a=0}else a-=f}25>this.size-b&&(c=[],this.collapse(c),this.children=[new Hc(c)],this.children[0].parent=this)},collapse:function(a){for(var b=0,c=this.children.length;b<c;++b)this.children[b].collapse(a)},
insertInner:function(a,b,c){this.size+=b.length;this.height+=c;for(var e=0,f=this.children.length;e<f;++e){var h=this.children[e],k=h.chunkSize();if(a<=k){h.insertInner(a,b,c);if(h.lines&&50<h.lines.length){for(;50<h.lines.length;)a=h.lines.splice(h.lines.length-25,25),a=new Hc(a),h.height-=a.height,this.children.splice(e+1,0,a),a.parent=this;this.maybeSpill()}break}a-=k}},maybeSpill:function(){if(!(10>=this.children.length)){var a=this;do{var b=a.children.splice(a.children.length-5,5),b=new ec(b);
if(a.parent){a.size-=b.size;a.height-=b.height;var c=Aa(a.parent.children,a);a.parent.children.splice(c+1,0,b)}else c=new ec(a.children),c.parent=a,a.children=[c,b],a=c;b.parent=a.parent}while(10<a.children.length);a.parent.maybeSpill()}},iterN:function(a,b,c){for(var e=0,f=this.children.length;e<f;++e){var h=this.children[e],k=h.chunkSize();if(a<k){k=Math.min(b,k-a);if(h.iterN(a,k,c))return!0;if(0==(b-=k))break;a=0}else a-=k}}};var Ee=0,la=l.Doc=function(a,b,c){if(!(this instanceof la))return new la(a,
b,c);null==c&&(c=0);ec.call(this,[new Hc([new Ya("",null)])]);this.first=c;this.scrollTop=this.scrollLeft=0;this.cantEdit=!1;this.history=Ic();this.cleanGeneration=1;this.frontier=c;c=B(c,0);this.sel={from:c,to:c,head:c,anchor:c,shift:!1,extend:!1,goalColumn:null};this.id=++Ee;this.modeOption=b;"string"==typeof a&&(a=mb(a));ld(this,{from:c,to:c,text:a},null,{head:c,anchor:c})};la.prototype=ce(ec.prototype,{constructor:la,iter:function(a,b,c){c?this.iterN(a-this.first,b-a,c):this.iterN(this.first,
this.first+this.size,a)},insert:function(a,b){for(var c=0,e=0,f=b.length;e<f;++e)c+=b[e].height;this.insertInner(a-this.first,b,c)},remove:function(a,b){this.removeInner(a-this.first,b)},getValue:function(a){var b=pd(this,this.first,this.first+this.size);return!1===a?b:b.join(a||"\n")},setValue:function(a){var b=B(this.first,0),c=this.first+this.size-1;p(this,{from:b,to:B(c,H(this,c).text.length),text:mb(a),origin:"setValue"},{head:b,anchor:b},!0)},replaceRange:function(a,b,c,e){b=C(this,b);c=c?C(this,
c):b;X(this,a,b,c,e)},getRange:function(a,b,c){a=kd(this,C(this,a),C(this,b));return!1===c?a:a.join(c||"\n")},getLine:function(a){return(a=this.getLineHandle(a))&&a.text},setLine:function(a,b){Gb(this,a)&&X(this,b,B(a,0),C(this,B(a)))},removeLine:function(a){a?X(this,"",C(this,B(a-1)),C(this,B(a))):X(this,"",B(0,0),C(this,B(1,0)))},getLineHandle:function(a){if(Gb(this,a))return H(this,a)},getLineNumber:function(a){return pa(a)},getLineHandleVisualStart:function(a){"number"==typeof a&&(a=H(this,a));
return Ma(this,a)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(a){return C(this,a)},getCursor:function(a){var b=this.sel;return nb(null==a||"head"==a?b.head:"anchor"==a?b.anchor:"end"==a||!1===a?b.to:b.from)},somethingSelected:function(){return!L(this.sel.head,this.sel.anchor)},setCursor:jb(function(a,b,c){a=C(this,"number"==typeof a?B(a,b||0):a);c?ja(this,a):Ta(this,a,a)}),setSelection:jb(function(a,
b,c){Ta(this,C(this,a),C(this,b||a),c)}),extendSelection:jb(function(a,b,c){ja(this,C(this,a),b&&C(this,b),c)}),getSelection:function(a){return this.getRange(this.sel.from,this.sel.to,a)},replaceSelection:function(a,b,c){p(this,{from:this.sel.from,to:this.sel.to,text:mb(a),origin:c},b||"around")},undo:jb(function(){K(this,"undo")}),redo:jb(function(){K(this,"redo")}),setExtending:function(a){this.sel.extend=a},historySize:function(){var a=this.history;return{undo:a.done.length,redo:a.undone.length}},
clearHistory:function(){this.history=Ic(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration()},changeGeneration:function(){this.history.lastOp=this.history.lastOrigin=null;return this.history.generation},isClean:function(a){return this.history.generation==(a||this.cleanGeneration)},getHistory:function(){return{done:Jc(this.history.done),undone:Jc(this.history.undone)}},setHistory:function(a){var b=this.history=Ic(this.history.maxGeneration);b.done=a.done.slice(0);
b.undone=a.undone.slice(0)},markText:function(a,b,c){return ac(this,C(this,a),C(this,b),c,"range")},setBookmark:function(a,b){var c={replacedWith:b&&(null==b.nodeType?b.widget:b),insertLeft:b&&b.insertLeft};a=C(this,a);return ac(this,a,a,c,"bookmark")},findMarksAt:function(a){a=C(this,a);var b=[],c=H(this,a.line).markedSpans;if(c)for(var e=0;e<c.length;++e){var f=c[e];(null==f.from||f.from<=a.ch)&&(null==f.to||f.to>=a.ch)&&b.push(f.marker.parent||f.marker)}return b},getAllMarks:function(){var a=[];
this.iter(function(b){if(b=b.markedSpans)for(var c=0;c<b.length;++c)null!=b[c].from&&a.push(b[c].marker)});return a},posFromIndex:function(a){var b,c=this.first;this.iter(function(e){e=e.text.length+1;if(e>a)return b=a,!0;a-=e;++c});return C(this,B(c,b))},indexFromPos:function(a){a=C(this,a);var b=a.ch;if(a.line<this.first||0>a.ch)return 0;this.iter(this.first,a.line,function(a){b+=a.text.length+1});return b},copy:function(a){var b=new la(pd(this,this.first,this.first+this.size),this.modeOption,this.first);
b.scrollTop=this.scrollTop;b.scrollLeft=this.scrollLeft;b.sel={from:this.sel.from,to:this.sel.to,head:this.sel.head,anchor:this.sel.anchor,shift:this.sel.shift,extend:!1,goalColumn:this.sel.goalColumn};a&&(b.history.undoDepth=this.history.undoDepth,b.setHistory(this.getHistory()));return b},linkedDoc:function(a){a||(a={});var b=this.first,c=this.first+this.size;null!=a.from&&a.from>b&&(b=a.from);null!=a.to&&a.to<c&&(c=a.to);b=new la(pd(this,b,c),a.mode||this.modeOption,b);a.sharedHist&&(b.history=
this.history);(this.linked||(this.linked=[])).push({doc:b,sharedHist:a.sharedHist});b.linked=[{doc:this,isParent:!0,sharedHist:a.sharedHist}];return b},unlinkDoc:function(a){a instanceof l&&(a=a.doc);if(this.linked)for(var b=0;b<this.linked.length;++b)if(this.linked[b].doc==a){this.linked.splice(b,1);a.unlinkDoc(this);break}if(a.history==this.history){var c=[a.id];Fb(a,function(a){c.push(a.id)},!0);a.history=Ic();a.history.done=Jc(this.history.done,c);a.history.undone=Jc(this.history.undone,c)}},
iterLinkedDocs:function(a){Fb(this,a)},getMode:function(){return this.mode},getEditor:function(){return this.cm}});la.prototype.eachLine=la.prototype.iter;var Fe=["iter","insert","remove","copy","getEditor"],ic;for(ic in la.prototype)la.prototype.hasOwnProperty(ic)&&0>Aa(Fe,ic)&&(l.prototype[ic]=function(a){return function(){return a.apply(this.doc,arguments)}}(la.prototype[ic]));Hb(la);l.e_stop=Tb;l.e_preventDefault=ba;l.e_stopPropagation=be;var Za,vc=0;l.on=N;l.off=Ra;l.signal=fa;var rb=30,Dd=l.Pass=
{toString:function(){return"CodeMirror.Pass"}};Oc.prototype={set:function(a,b){clearTimeout(this.id);this.id=setTimeout(b,a)}};l.countColumn=yb;var Lc=[""],ze=/[\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,Yc=/[\u0300-\u036F\u0483-\u0487\u0488-\u0489\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\uA66F\u1DC0\u2013\u1DFF\u20D0\u2013\u20FF\uA670-\uA672\uA674-\uA67D\uA69F\udc00-\udfff\uFE20\u2013\uFE2F]/;
l.replaceGetRect=function(a){Z=a};var ne=function(){if(qa)return!1;var a=G("div");return"draggable"in a||"dragDrop"in a}();Db?dc=function(a,b){return 36==a.charCodeAt(b-1)&&39==a.charCodeAt(b)}:ad&&!/Version\/([6-9]|\d\d)\b/.test(navigator.userAgent)?dc=function(a,b){return/\-[^ \-?]|\?[^ !\'\"\),.\-\/:;\?\]\}]/.test(a.slice(b-1,b+1))}:ca&&/Chrome\/(?:29|[3-9]\d|\d\d\d)\./.test(navigator.userAgent)?dc=function(a,b){var c=a.charCodeAt(b-1);return 8208<=c&&8212>=c}:ca&&(dc=function(a,b){if(1<b&&45==
a.charCodeAt(b-1)){if(/\w/.test(a.charAt(b-2))&&/[^\-?\.]/.test(a.charAt(b)))return!0;if(2<b&&/[\d\.,]/.test(a.charAt(b-2))&&/[\d\.,]/.test(a.charAt(b)))return!1}return/[~!#%&*)=+}\]\\|\"\.>,:;][({[<]|-[^\-?\.\u2010-\u201f\u2026]|\?[\w~`@#$%\^&*(_=+{[|><]|\u2026[\w~`@#$%\^&*(_=+{[><]/.test(a.slice(b-1,b+1))});var Rb,qd,mb=3!="\n\nb".split(/\n/).length?function(a){for(var b=0,c=[],e=a.length;b<=e;){var f=a.indexOf("\n",b);-1==f&&(f=a.length);var h=a.slice(b,"\r"==a.charAt(f-1)?f-1:f),k=h.indexOf("\r");
-1!=k?(c.push(h.slice(0,k)),b+=k+1):(c.push(h),b=f+1)}return c}:function(a){return a.split(/\r\n?|\n/)};l.splitLines=mb;var le=window.getSelection?function(a){try{return a.selectionStart!=a.selectionEnd}catch(b){return!1}}:function(a){try{var b=a.ownerDocument.selection.createRange()}catch(c){}return b&&b.parentElement()==a?0!=b.compareEndPoints("StartToEnd",b):!1},zd=function(){var a=G("div");if("oncopy"in a)return!0;a.setAttribute("oncopy","return;");return"function"==typeof a.oncopy}(),ob={3:"Enter",
8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",91:"Mod",92:"Mod",93:"Mod",109:"-",107:"=",127:"Delete",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"Left",63232:"Up",63235:"Right",63233:"Down",63302:"Insert",
63272:"Delete"};l.keyNames=ob;(function(){for(var a=0;10>a;a++)ob[a+48]=String(a);for(a=65;90>=a;a++)ob[a]=String.fromCharCode(a);for(a=1;12>=a;a++)ob[a+111]=ob[a+63235]="F"+a})();var Bb,we=function(){function a(a){return 255>=a?b.charAt(a):1424<=a&&1524>=a?"R":1536<=a&&1791>=a?c.charAt(a-1536):1792<=a&&2220>=a?"r":"L"}var b="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLL",
c="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmmrrrrrrrrrrrrrrrrrr",e=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,f=/[stwN]/,h=/[LRr]/,k=/[Lb1n]/,m=/[1n]/;return function(b){if(!e.test(b))return!1;for(var d=b.length,c=[],g=0,n;g<d;++g)c.push(a(b.charCodeAt(g)));for(var g=0,p="L";g<d;++g)n=c[g],"m"==n?c[g]=p:
p=n;g=0;for(p="L";g<d;++g)n=c[g],"1"==n&&"r"==p?c[g]="n":h.test(n)&&(p=n,"r"==n&&(c[g]="R"));g=1;for(p=c[0];g<d-1;++g)n=c[g],"+"==n&&"1"==p&&"1"==c[g+1]?c[g]="1":","!=n||p!=c[g+1]||"1"!=p&&"n"!=p||(c[g]=p),p=n;for(g=0;g<d;++g)if(n=c[g],","==n)c[g]="N";else if("%"==n){for(p=g+1;p<d&&"%"==c[p];++p);var x=g&&"!"==c[g-1]||p<d-1&&"1"==c[p]?"1":"N";for(n=g;n<p;++n)c[n]=x;g=p-1}g=0;for(p="L";g<d;++g)n=c[g],"L"==p&&"1"==n?c[g]="L":h.test(n)&&(p=n);for(g=0;g<d;++g)if(f.test(c[g])){for(p=g+1;p<d&&f.test(c[p]);++p);
n="L"==(p<d-1?c[p]:"L");x="L"==(g?c[g-1]:"L")||n?"L":"R";for(n=g;n<p;++n)c[n]=x;g=p-1}for(var p=[],q,g=0;g<d;)if(k.test(c[g])){n=g;for(++g;g<d&&k.test(c[g]);++g);p.push({from:n,to:g,level:0})}else{var l=g,x=p.length;for(++g;g<d&&"L"!=c[g];++g);for(n=l;n<g;)if(m.test(c[n])){l<n&&p.splice(x,0,{from:l,to:n,level:1});l=n;for(++n;n<g&&m.test(c[n]);++n);p.splice(x,0,{from:l,to:n,level:2});l=n}else++n;l<g&&p.splice(x,0,{from:l,to:g,level:1})}1==p[0].level&&(q=b.match(/^\s+/))&&(p[0].from=q[0].length,p.unshift({from:0,
to:q[0].length,level:0}));1==na(p).level&&(q=b.match(/\s+$/))&&(na(p).to-=q[0].length,p.push({from:d-q[0].length,to:d,level:0}));p[0].level!=na(p).level&&p.push({from:d,to:d,level:p[0].level});return p}}();l.version="3.20.1";return l}();
(function(){var l=[{keys:["<Left>"],type:"keyToKey",toKeys:["h"]},{keys:["<Right>"],type:"keyToKey",toKeys:["l"]},{keys:["<Up>"],type:"keyToKey",toKeys:["k"]},{keys:["<Down>"],type:"keyToKey",toKeys:["j"]},{keys:["<Space>"],type:"keyToKey",toKeys:["l"]},{keys:["<BS>"],type:"keyToKey",toKeys:["h"]},{keys:["<C-Space>"],type:"keyToKey",toKeys:["W"]},{keys:["<C-BS>"],type:"keyToKey",toKeys:["B"]},{keys:["<S-Space>"],type:"keyToKey",toKeys:["w"]},{keys:["<S-BS>"],type:"keyToKey",toKeys:["b"]},{keys:["<C-n>"],
type:"keyToKey",toKeys:["j"]},{keys:["<C-p>"],type:"keyToKey",toKeys:["k"]},{keys:["C-["],type:"keyToKey",toKeys:["<Esc>"]},{keys:["<C-c>"],type:"keyToKey",toKeys:["<Esc>"]},{keys:["s"],type:"keyToKey",toKeys:["c","l"],context:"normal"},{keys:["s"],type:"keyToKey",toKeys:["x","i"],context:"visual"},{keys:["S"],type:"keyToKey",toKeys:["c","c"],context:"normal"},{keys:["S"],type:"keyToKey",toKeys:["d","c","c"],context:"visual"},{keys:["<Home>"],type:"keyToKey",toKeys:["0"]},{keys:["<End>"],type:"keyToKey",
toKeys:["$"]},{keys:["<PageUp>"],type:"keyToKey",toKeys:["<C-b>"]},{keys:["<PageDown>"],type:"keyToKey",toKeys:["<C-f>"]},{keys:["H"],type:"motion",motion:"moveToTopLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:["M"],type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:["L"],type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:["h"],type:"motion",motion:"moveByCharacters",motionArgs:{forward:!1}},{keys:["l"],type:"motion",motion:"moveByCharacters",
motionArgs:{forward:!0}},{keys:["j"],type:"motion",motion:"moveByLines",motionArgs:{forward:!0,linewise:!0}},{keys:["k"],type:"motion",motion:"moveByLines",motionArgs:{forward:!1,linewise:!0}},{keys:["g","j"],type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!0}},{keys:["g","k"],type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!1}},{keys:["w"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1}},{keys:["W"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,
wordEnd:!1,bigWord:!0}},{keys:["e"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,inclusive:!0}},{keys:["E"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:["b"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1}},{keys:["B"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1,bigWord:!0}},{keys:["g","e"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,inclusive:!0}},
{keys:["g","E"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:["{"],type:"motion",motion:"moveByParagraph",motionArgs:{forward:!1,toJumplist:!0}},{keys:["}"],type:"motion",motion:"moveByParagraph",motionArgs:{forward:!0,toJumplist:!0}},{keys:["<C-f>"],type:"motion",motion:"moveByPage",motionArgs:{forward:!0}},{keys:["<C-b>"],type:"motion",motion:"moveByPage",motionArgs:{forward:!1}},{keys:["<C-d>"],type:"motion",motion:"moveByScroll",motionArgs:{forward:!0,
explicitRepeat:!0}},{keys:["<C-u>"],type:"motion",motion:"moveByScroll",motionArgs:{forward:!1,explicitRepeat:!0}},{keys:["g","g"],type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:["G"],type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!0,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:["0"],type:"motion",motion:"moveToStartOfLine"},{keys:["^"],type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},
{keys:["+"],type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0}},{keys:["-"],type:"motion",motion:"moveByLines",motionArgs:{forward:!1,toFirstChar:!0}},{keys:["_"],type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0,repeatOffset:-1}},{keys:["$"],type:"motion",motion:"moveToEol",motionArgs:{inclusive:!0}},{keys:["%"],type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:!0,toJumplist:!0}},{keys:["f","character"],type:"motion",motion:"moveToCharacter",
motionArgs:{forward:!0,inclusive:!0}},{keys:["F","character"],type:"motion",motion:"moveToCharacter",motionArgs:{forward:!1}},{keys:["t","character"],type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:["T","character"],type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!1}},{keys:[";"],type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!0}},{keys:[","],type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!1}},{keys:["'",
"character"],type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:["`","character"],type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:["]","`"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!0}},{keys:["[","`"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!1}},{keys:["]","'"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!0,linewise:!0}},{keys:["[","'"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!1,linewise:!0}},{keys:["]","character"],
type:"motion",motion:"moveToSymbol",motionArgs:{forward:!0,toJumplist:!0}},{keys:["[","character"],type:"motion",motion:"moveToSymbol",motionArgs:{forward:!1,toJumplist:!0}},{keys:["|"],type:"motion",motion:"moveToColumn",motionArgs:{}},{keys:["d"],type:"operator",operator:"delete"},{keys:["y"],type:"operator",operator:"yank"},{keys:["c"],type:"operator",operator:"change"},{keys:[">"],type:"operator",operator:"indent",operatorArgs:{indentRight:!0}},{keys:["<"],type:"operator",operator:"indent",operatorArgs:{indentRight:!1}},
{keys:["g","~"],type:"operator",operator:"swapcase"},{keys:["n"],type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:!0}},{keys:["N"],type:"motion",motion:"findNext",motionArgs:{forward:!1,toJumplist:!0}},{keys:["x"],type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!0},operatorMotionArgs:{visualLine:!1}},{keys:["X"],type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!1},operatorMotionArgs:{visualLine:!0}},{keys:["D"],
type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:!0},operatorMotionArgs:{visualLine:!0}},{keys:["Y"],type:"operatorMotion",operator:"yank",motion:"moveToEol",motionArgs:{inclusive:!0},operatorMotionArgs:{visualLine:!0}},{keys:["C"],type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:!0},operatorMotionArgs:{visualLine:!0}},{keys:["~"],type:"operatorMotion",operator:"swapcase",operatorArgs:{shouldMoveCursor:!0},motion:"moveByCharacters",motionArgs:{forward:!0}},
{keys:["<C-i>"],type:"action",action:"jumpListWalk",actionArgs:{forward:!0}},{keys:["<C-o>"],type:"action",action:"jumpListWalk",actionArgs:{forward:!1}},{keys:["a"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"charAfter"}},{keys:["A"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"eol"}},{keys:["i"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"inplace"}},{keys:["I"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"firstNonBlank"}},
{keys:["o"],type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!0}},{keys:["O"],type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!1}},{keys:["v"],type:"action",action:"toggleVisualMode"},{keys:["V"],type:"action",action:"toggleVisualMode",actionArgs:{linewise:!0}},{keys:["J"],type:"action",action:"joinLines",isEdit:!0},{keys:["p"],type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0}},
{keys:["P"],type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0}},{keys:["r","character"],type:"action",action:"replace",isEdit:!0},{keys:["@","character"],type:"action",action:"replayMacro"},{keys:["q","character"],type:"action",action:"enterMacroRecordMode"},{keys:["R"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{replace:!0}},{keys:["u"],type:"action",action:"undo"},{keys:["<C-r>"],type:"action",action:"redo"},{keys:["m","character"],type:"action",action:"setMark"},
{keys:['"',"character"],type:"action",action:"setRegister"},{keys:["z","z"],type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:["z","."],type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["z","t"],type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:["z","<CR>"],type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["z","-"],
type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:["z","b"],type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["."],type:"action",action:"repeatLastEdit"},{keys:["<C-a>"],type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!0,backtrack:!1}},{keys:["<C-x>"],type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!1,backtrack:!1}},{keys:["a","character"],type:"motion",
motion:"textObjectManipulation"},{keys:["i","character"],type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:!0}},{keys:["/"],type:"search",searchArgs:{forward:!0,querySrc:"prompt",toJumplist:!0}},{keys:["?"],type:"search",searchArgs:{forward:!1,querySrc:"prompt",toJumplist:!0}},{keys:["*"],type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:["#"],type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:[":"],type:"ex"}],
P=function(){function t(b,c){var e=b.state.vim;e.insertMode||e.exMode||(e=c.head,e.ch&&e.ch==b.doc.getLine(e.line).length&&e.ch--)}function s(b,c){for(var e=[],f=b;f<b+c;f++)e.push(String.fromCharCode(f));return e}function w(b,c){return c>=b.firstLine()&&c<=b.lastLine()}function A(b){return/^[A-Z]$/.test(b)}function R(b,c){for(var e=0;e<c.length;e++)if(c[e]==b)return!0;return!1}function M(b){b.state.vim||(b.state.vim={inputState:new q,lastEditInputState:void 0,lastEditActionCommand:void 0,lastHPos:-1,
lastHSPos:-1,lastMotion:null,marks:{},insertMode:!1,insertModeRepeat:void 0,visualMode:!1,visualLine:!1});return b.state.vim}function v(){O={searchQuery:null,searchIsReversed:!1,jumpList:Pc(),macroModeState:Sa(),lastChararacterSearch:{increment:0,forward:!0,selectedCharacter:""},registerController:new S({})}}function q(){this.prefixRepeat=[];this.motionRepeat=[];this.motionArgs=this.motion=this.operatorArgs=this.operator=null;this.keyBuffer=[];this.registerName=null}function z(b,c){this.clear();b&&
this.set(b,c)}function S(b){this.registers=b;this.unamedRegister=b['"']=new z}function u(b,c,e){var f=Math.min(Math.max(b.firstLine(),c.line),b.lastLine());b=aa(b,f)-1;b=e?b+1:b;c=Math.min(Math.max(0,c.ch),b);return{line:f,ch:c}}function Ba(b){var c={},e;for(e in b)b.hasOwnProperty(e)&&(c[e]=b[e]);return c}function ga(b,c,e){return{line:b.line+c,ch:b.ch+e}}function $(b,c){for(var e=0;e<b.length;e++)if(b[e]!=c[e]&&"character"!=c[e])return!1;return!0}function oa(b,c,e){return function(){for(var f=0;f<
e;f++)c(b)}}function W(b,c){return b.ch==c.ch&&b.line==c.line}function U(b,c){return b.line<c.line||b.line==c.line&&b.ch<c.ch?!0:!1}function kc(b,c,e){b=U(b,c);c=U(c,e);return b&&c}function aa(b,c){return b.getLine(c).length}function wa(b){b.off("mousedown",wa);var c=b.state.vim;c.visualMode=!1;c.visualLine=!1;var c=b.getCursor("anchor"),e=b.getCursor("head");W(c,e)||b.setCursor(u(b,e));CodeMirror.signal(b,"vim-mode-change",{mode:"normal"})}function va(b){if(!b)return 0;var c=b.search(/\S/);return-1==
c?b.length:c}function ub(b,c,e,f,h){e=b.getCursor();b=b.getLine(e.line);var k=e.ch,m=b.substring(k);h=h?m.search(/\w/):m.search(/\S/);if(-1==h)return null;k+=h;m=b.substring(k);h=b.substring(0,k);var n;n=f?/^\S+/:/\w/.test(b.charAt(k))?/^\w+/:/^[^\w\s]+/;m=n.exec(m);f=k;k+=m[0].length;h=h.split("").reverse().join("");(n=n.exec(h))&&(f-=n[0].length);c&&(c=b.substring(k).match(/^\s*/)[0].length,0<c?k+=c:(c=h.substring(h.length-f).match(/^\s*/)[0].length,f-=c));return{start:{line:e.line,ch:f},end:{line:e.line,
ch:k}}}function mc(b,c){O.lastChararacterSearch.increment=b;O.lastChararacterSearch.forward=c.forward;O.lastChararacterSearch.selectedCharacter=c.selectedCharacter}function gb(b,c,e,f){for(var h=b.getCursor(),k=h.ch,m,n=0;n<c;n++){m=b.getLine(h.line);var p=f,x=void 0;m=x=e?m.indexOf(p,k+1):m.lastIndexOf(p,k-1);if(-1==m)return null;k=m}return{line:b.getCursor().line,ch:m}}function La(b,c,e,f){R(e,ka)&&(c.marks[e]&&c.marks[e].clear(),c.marks[e]=b.setBookmark(f))}function wb(b){return"string"===b||"comment"===
b?1:0}function Va(b,c,e){var f=c.line,h=c.ch;e=e?e:b.getLine(f).charAt(h);var k=b.getTokenAt({line:f,ch:h+1}).type,k=wb(k),m={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{"}[e];if(!m)return c;for(var n={"(":1,"{":1,"[":1}[e]||-1,p=1===n?b.lineCount():-1,x=1,q=e,l=h,h=b.getLine(f);f!==p&&0<x;){l+=n;q=h.charAt(l);q||(f+=n,h=b.getLine(f)||"",0<n?l=0:(q=h.length,l=0<q?q-1:0),q=h.charAt(l));var t=b.getTokenAt({line:f,ch:l+1}).type,t=wb(t);k>=t&&(q===e?x++:q===m&&x--)}return q?{line:f,ch:l}:c}function Ia(b,
c,e){var f=b.getCursor();c=Va(b,f,c);b=Va(b,c);b.ch+=e?1:0;c.ch+=e?0:1;return{start:b,end:c}}function nc(b,c,e){var f=b.getCursor();b=b.getLine(f.line).split("");var h,k,m,n;m=b.indexOf(c);f.ch<m?f.ch=m:m<f.ch&&b[f.ch]==c&&(k=f.ch,--f.ch);if(b[f.ch]!=c||k)for(m=f.ch;-1<m&&!h;m--)b[m]==c&&(h=m+1);else h=f.ch+1;if(h&&!k)for(m=h,n=b.length;m<n&&!k;m++)b[m]==c&&(k=m);if(!h||!k)return{start:f,end:f};e&&(--h,++k);return{start:{line:f.line,ch:h},end:{line:f.line,ch:k}}}function oc(){}function ia(b){b=b.state.vim;
return b.searchState_||(b.searchState_=new oc)}function Wa(b){for(var c=!1,e=[],f=0;f<b.length;f++){var h=b.charAt(f);c||"/"!=h||e.push(f);c="\\"==h}return e}function ea(b,c){b.openNotification?b.openNotification('<span style="color: red">'+c+"</span>",{bottom:!0,duration:5E3}):alert(c)}function zb(b,c){var e=(c.prefix||"")+" "+(c.desc||""),f;f=c.prefix;var h=c.desc,k="";f&&(k+='<span style="font-family: monospace">'+f+"</span>");k+='<input type="text"/> <span style="color: #888">';h&&(k=k+'<span style="color: #888">'+
h,k+="</span>");f=k;h=c.onClose;b.openDialog?b.openDialog(f,h,{bottom:!0,value:c.value,onKeyDown:c.onKeyDown,onKeyUp:c.onKeyUp}):h(prompt(e,""))}function Xa(b,c,e,f){if(c){var h=ia(b);e=!!e;f=!!f;if(!(c instanceof RegExp)){var k=Wa(c),m,n;k.length?(m=c.substring(0,k[0]),n=-1!=c.substring(k[0]).indexOf("i")):m=c;m?(f&&(e=/^[^A-Z]*$/.test(m)),c=new RegExp(m,e||n?"i":void 0)):c=null}if(c){qc(b,c);a:if(b=h.getQuery(),c instanceof RegExp&&b instanceof RegExp){n=["global","multiline","ignoreCase","source"];
for(e=0;e<n.length;e++)if(f=n[e],c[f]!==b[f]){b=!1;break a}b=!0}else b=!1;if(b)return c;h.setQuery(c);return c}}}function pc(b){if("^"==b.source.charAt(0))var c=!0;return{token:function(e){if(c&&!e.sol())e.skipToEnd();else{var f=e.match(b,!1);if(f){if(0==f[0].length)return e.next(),"searching";if(!e.sol()&&(e.backUp(1),!b.exec(e.next()+f[0])))return e.next(),null;e.match(b);return"searching"}for(;!e.eol()&&(e.next(),!e.match(b,!1)););}},query:b}}function qc(b,c){var e=ia(b).getOverlay();e&&c==e.query||
(e&&b.removeOverlay(e),e=pc(c),b.addOverlay(e),ia(b).setOverlay(e))}function Ka(b,c,e,f){void 0===f&&(f=1);return b.operation(function(){for(var h=b.getCursor(),k=b.getSearchCursor(e,h),m=0;m<f;m++){var n=k.find(c);0==m&&n&&W(k.from(),h)&&(n=k.find(c));if(!n&&(k=b.getSearchCursor(e,c?{line:b.lastLine()}:{line:b.firstLine(),ch:0}),!k.find(c)))return}return k.from()})}function hb(b){b.removeOverlay(ia(b).getOverlay());ia(b).setOverlay(null)}function Ab(b){var c=b.getScrollInfo(),e=b.coordsChar({left:0,
top:6+c.top},"local");b=b.coordsChar({left:0,top:c.clientHeight-10+c.top},"local");return{top:e.line,bottom:b.line}}function Na(b){for(var c,e,f=[];b;){e=/<\w+-.+?>|<\w+>|./.exec(b);if(null===e)break;c=e[0];b=b.substring(e.index+c.length);f.push(c)}return f}function ma(b,c,e,f,h,k,m){function n(){b.operation(function(){for(;!t;)p(),x();q()})}function p(){var c=b.getRange(h.from(),h.to()).replace(k,m);h.replace(c)}function x(){if(h.findNext()){var c;c=h.from();"number"!=typeof c&&(c=c.line);c=e instanceof
Array?R(c,e):f?c>=e&&c<=f:c==e;c?(b.scrollIntoView(h.from(),30),b.setSelection(h.from(),h.to()),v=h.from(),t=!1):t=!0}else t=!0}function q(c){c&&c();b.focus();v&&(b.setCursor(v),c=b.state.vim,c.exMode=!1,c.lastHPos=c.lastHSPos=v.ch)}function l(c,e,f){CodeMirror.e_stop(c);switch(CodeMirror.keyName(c)){case "Y":p();x();break;case "N":x();break;case "A":b.operation(n);break;case "L":p();case "Q":case "Esc":case "Ctrl-C":case "Ctrl-[":q(f)}t&&q(f)}b.state.vim.exMode=!0;var t=!1,v=h.from();x();if(t)throw Error("No matches for "+
k.source);c?zb(b,{prefix:"replace with <strong>"+m+"</strong> (y/n/a/q/l)",onKeyDown:l}):n()}function Oa(b){var c=b.state.vim,e=O.macroModeState.inReplay;e||(b.off("change",Cb),b.off("cursorActivity",sc),CodeMirror.off(b.getInputField(),"keydown",Jb));!e&&1<c.insertModeRepeat&&(Pa(b,c,c.insertModeRepeat-1,!0),c.lastEditInputState.repeatOverride=c.insertModeRepeat);delete c.insertModeRepeat;b.setCursor(b.getCursor().line,b.getCursor().ch-1,!0);c.insertMode=!1;b.setOption("keyMap","vim");b.toggleOverwrite(!1);
CodeMirror.signal(b,"vim-mode-change",{mode:"normal"})}function Cb(b,c){for(var e=O.macroModeState.lastInsertModeChanges;c;){e.expectCursorActivityForChange=!0;if("+input"==c.origin||"paste"==c.origin||void 0===c.origin){var f=c.text.join("\n");e.changes.push(f)}c=c.next}}function sc(){var b=O.macroModeState.lastInsertModeChanges;b.expectCursorActivityForChange?b.expectCursorActivityForChange=!1:b.changes=[]}function za(b){this.keyName=b}function Jb(b){function c(){e.changes.push(new za(f));return!0}
var e=O.macroModeState.lastInsertModeChanges,f=CodeMirror.keyName(b);-1==f.indexOf("Delete")&&-1==f.indexOf("Backspace")||CodeMirror.lookupKey(f,["vim-insert"],c)}function Pa(b,c,e,f){function h(){n?bb.processAction(b,c,c.lastEditActionCommand):bb.evalInput(b,c)}function k(e){0<m.lastInsertModeChanges.changes.length&&(e=c.lastEditActionCommand?e:1,$a(b,e,m))}var m=O.macroModeState;m.inReplay=!0;var n=!!c.lastEditActionCommand,p=c.inputState;c.inputState=c.lastEditInputState;if(n&&c.lastEditActionCommand.interlaceInsertRepeat)for(var x=
0;x<e;x++)h(),k(1);else f||h(),k(e);c.inputState=p;c.insertMode&&!f&&Oa(b);m.inReplay=!1}function $a(b,c,e){function f(c){if("string"==typeof c)CodeMirror.commands[c](b);else c(b);return!0}e=e.lastInsertModeChanges;for(var h=0;h<c;h++)for(var k=0;k<e.changes.length;k++){var m=e.changes[k];if(m instanceof za)CodeMirror.lookupKey(m.keyName,["vim-insert"],f);else{var n=b.getCursor();b.replaceRange(m,n,n)}}}CodeMirror.defineOption("vimMode",!1,function(b,c){c?(b.setOption("keyMap","vim"),CodeMirror.signal(b,
"vim-mode-change",{mode:"normal"}),b.on("beforeSelectionChange",t),M(b)):b.state.vim&&(b.setOption("keyMap","default"),b.off("beforeSelectionChange",t),b.state.vim=null)});var J=/[\d]/,jb=[/\w/,/[^\w\s]/],Qb=[/\S/],V=s(65,26),Qa=s(97,26),Ea=s(48,10),kb="~`!@#$%^&*()_-+=[{}]\\|/?.,<>:;\"'".split(""),ra="Left Right Up Down Space Backspace Esc Home End PageUp PageDown Enter".split(" "),ka=[].concat(V,Qa,Ea,["<",">"]),lb=[].concat(V,Qa,Ea,["-",'"']),Pc=function(){var b=-1,c=0,e=0,f=Array(100);return{cachedCursor:void 0,
add:function(h,k,m){function n(c){var e=++b%100,k=f[e];k&&k.clear();f[e]=h.setBookmark(c)}var p=f[b%100];p?(p=p.find())&&!W(p,k)&&n(k):n(k);n(m);c=b;e=b-100+1;0>e&&(e=0)},move:function(h,k){b+=k;b>c?b=c:b<e&&(b=e);var m=f[(100+b)%100];if(m&&!m.find()){var n=0<k?1:-1,p,q=h.getCursor();do if(b+=n,(m=f[(100+b)%100])&&(p=m.find())&&!W(q,p))break;while(b<c&&b>e)}return m}}},Sa=function(){return{macroKeyBuffer:[],latestRegister:void 0,inReplay:!1,lastInsertModeChanges:{changes:[],expectCursorActivityForChange:!1},
enteredMacroMode:void 0,isMacroPlaying:!1,toggle:function(b,c){this.enteredMacroMode?(this.enteredMacroMode(),this.enteredMacroMode=void 0):(this.latestRegister=c,this.enteredMacroMode=b.openDialog("(recording)["+c+"]",null,{bottom:!0}))}}},O,Qa={buildKeyMap:function(){},getRegisterController:function(){return O.registerController},resetVimGlobalState_:v,getVimGlobalState_:function(){return O},maybeInitVimState_:M,InsertModeKey:za,map:function(b,c){db.map(b,c)},defineEx:function(b,c,e){if(0!==b.indexOf(c))throw Error('(Vim.defineEx) "'+
c+'" is not a prefix of "'+b+'", command not registered');Xb[b]=e;db.commandMap_[c]={name:b,shortName:c,type:"api"}},handleKey:function(b,c){var e,f=M(b),h=O.macroModeState;if(h.enteredMacroMode&&"q"==c)Vb.exitMacroRecordMode(),f.inputState=new q;else if("<Esc>"==c)f.inputState=new q,f.visualMode&&wa(b);else{f.visualMode||W(b.getCursor("head"),b.getCursor("anchor"))||(f.visualMode=!0,f.visualLine=!1,CodeMirror.signal(b,"vim-mode-change",{mode:"visual"}),b.on("mousedown",wa));if("0"!=c||"0"==c&&0===
f.inputState.getRepeat())e=bb.matchCommand(c,l,f);if(e)if("keyToKey"==e.type)for(f=0;f<e.toKeys.length;f++)this.handleKey(b,e.toKeys[f]);else h.enteredMacroMode&&(h.isMacroPlaying||h.macroKeyBuffer.push(c)),bb.processCommand(b,f,e);else J.test(c)&&f.inputState.pushRepeatDigit(c)}},handleEx:function(b,c){db.processCommand(b,c)}};q.prototype.pushRepeatDigit=function(b){this.operator?this.motionRepeat=this.motionRepeat.concat(b):this.prefixRepeat=this.prefixRepeat.concat(b)};q.prototype.getRepeat=function(){var b=
0;if(0<this.prefixRepeat.length||0<this.motionRepeat.length)b=1,0<this.prefixRepeat.length&&(b*=parseInt(this.prefixRepeat.join(""),10)),0<this.motionRepeat.length&&(b*=parseInt(this.motionRepeat.join(""),10));return b};z.prototype={set:function(b,c){this.text=b;this.linewise=!!c},append:function(b,c){c||this.linewise?(this.text+="\n"+b,this.linewise=!0):this.text+=b},clear:function(){this.text="";this.linewise=!1},toString:function(){return this.text}};S.prototype={pushText:function(b,c,e,f){f&&
"\n"==e.charAt(0)&&(e=e.slice(1)+"\n");f&&"\n"!==e.charAt(e.length-1)&&(e+="\n");var h=this.isValidRegister(b)?this.getRegister(b):null;if(h)A(b)?(h.append(e,f),this.unamedRegister.append(e,f)):(h.set(e,f),this.unamedRegister.set(e,f));else{switch(c){case "yank":this.registers["0"]=new z(e,f);break;case "delete":case "change":-1==e.indexOf("\n")?this.registers["-"]=new z(e,f):(this.shiftNumericRegisters_(),this.registers["1"]=new z(e,f))}this.unamedRegister.set(e,f)}},setRegisterText:function(b,c,
e){this.getRegister(b).set(c,e)},getRegister:function(b){if(!this.isValidRegister(b))return this.unamedRegister;b=b.toLowerCase();this.registers[b]||(this.registers[b]=new z);return this.registers[b]},isValidRegister:function(b){return b&&R(b,lb)},shiftNumericRegisters_:function(){for(var b=9;2<=b;b--)this.registers[b]=this.getRegister(""+(b-1))}};var bb={matchCommand:function(b,c,e){function f(c){if(k.length<c.keys.length)return h.keyBuffer.push(b),null;"character"==c.keys[k.length-1]&&(h.selectedCharacter=
n);h.keyBuffer=[];return c}for(var h=e.inputState,k=h.keyBuffer.concat(b),m=[],n,p=0;p<c.length;p++){var q=c[p];if($(k,q.keys)&&(!h.operator||"action"!=q.type)){if("character"==q.keys[k.length-1]&&(n=k[k.length-1],1<n.length))switch(n){case "<CR>":n="\n";break;case "<Space>":n=" ";break;default:continue}m.push(q)}}if(m.length){if(1==m.length)return f(m[0]);c=e.visualMode?"visual":"normal";e=m[0];for(p=0;p<m.length;p++)if(m[p].context==c){e=m[p];break}return f(e)}h.keyBuffer=[];return null},processCommand:function(b,
c,e){c.inputState.repeatOverride=e.repeatOverride;switch(e.type){case "motion":this.processMotion(b,c,e);break;case "operator":this.processOperator(b,c,e);break;case "operatorMotion":this.processOperatorMotion(b,c,e);break;case "action":this.processAction(b,c,e);break;case "search":this.processSearch(b,c,e);break;case "ex":case "keyToEx":this.processEx(b,c,e)}},processMotion:function(b,c,e){c.inputState.motion=e.motion;c.inputState.motionArgs=Ba(e.motionArgs);this.evalInput(b,c)},processOperator:function(b,
c,e){var f=c.inputState;if(f.operator){if(f.operator==e.operator){f.motion="expandToLine";f.motionArgs={linewise:!0};this.evalInput(b,c);return}c.inputState=new q}f.operator=e.operator;f.operatorArgs=Ba(e.operatorArgs);c.visualMode&&this.evalInput(b,c)},processOperatorMotion:function(b,c,e){var f=c.visualMode,h=Ba(e.operatorMotionArgs);h&&f&&h.visualLine&&(c.visualLine=!0);this.processOperator(b,c,e);f||this.processMotion(b,c,e)},processAction:function(b,c,e){var f=c.inputState,h=f.getRepeat(),k=
!!h,m=Ba(e.actionArgs)||{};f.selectedCharacter&&(m.selectedCharacter=f.selectedCharacter);e.operator&&this.processOperator(b,c,e);e.motion&&this.processMotion(b,c,e);(e.motion||e.operator)&&this.evalInput(b,c);m.repeat=h||1;m.repeatIsExplicit=k;m.registerName=f.registerName;c.inputState=new q;c.lastMotion=null;e.isEdit&&this.recordLastEdit(c,f,e);Vb[e.action](b,m,c)},processSearch:function(b,c,e){function f(f,h,k){try{Xa(b,f,h,k)}catch(m){ea(b,"Invalid regex: "+f);return}bb.processMotion(b,c,{type:"motion",
motion:"findNext",motionArgs:{forward:!0,toJumplist:e.searchArgs.toJumplist}})}function h(c){b.scrollTo(l.left,l.top);f(c,!0,!0)}function k(c,e){var f;try{f=Xa(b,e,!0,!0)}catch(h){}f?b.scrollIntoView(Ka(b,!n,f),30):(hb(b),b.scrollTo(l.left,l.top))}function m(c,e,f){e=CodeMirror.keyName(c);if("Esc"==e||"Ctrl-C"==e||"Ctrl-["==e)Xa(b,q),hb(b),b.scrollTo(l.left,l.top),CodeMirror.e_stop(c),f(),b.focus()}if(b.getSearchCursor){var n=e.searchArgs.forward;ia(b).setReversed(!n);var p=n?"/":"?",q=ia(b).getQuery(),
l=b.getScrollInfo();switch(e.searchArgs.querySrc){case "prompt":zb(b,{onClose:h,prefix:p,desc:Eb,onKeyUp:k,onKeyDown:m});break;case "wordUnderCursor":var p=ub(b,!1,!0,!1,!0),t=!0;p||(p=ub(b,!1,!0,!1,!1),t=!1);if(!p)break;var v=b.getLine(p.start.line).substring(p.start.ch,p.end.ch),v=t?"\\b"+v+"\\b":v.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1");O.jumpList.cachedCursor=b.getCursor();b.setCursor(p.start);f(v,!0,!1)}}},processEx:function(b,c,e){function f(c){db.processCommand(b,c)}function h(c,e,f){e=
CodeMirror.keyName(c);if("Esc"==e||"Ctrl-C"==e||"Ctrl-["==e)CodeMirror.e_stop(c),f(),b.focus()}"keyToEx"==e.type?db.processCommand(b,e.exArgs.input):c.visualMode?zb(b,{onClose:f,prefix:":",value:"'<,'>",onKeyDown:h}):zb(b,{onClose:f,prefix:":",onKeyDown:h})},evalInput:function(b,c){var e=c.inputState,f=e.motion,h=e.motionArgs||{},k=e.operator,m=e.operatorArgs||{},n=e.registerName,p=b.getCursor("head"),l=b.getCursor("anchor"),t={line:p.line,ch:p.ch},v={line:t.line,ch:t.ch},D,s;k&&this.recordLastEdit(c,
e);s=void 0!==e.repeatOverride?e.repeatOverride:e.getRepeat();if(0<s&&h.explicitRepeat)h.repeatIsExplicit=!0;else if(h.noRepeat||!h.explicitRepeat&&0===s)s=1,h.repeatIsExplicit=!1;e.selectedCharacter&&(h.selectedCharacter=m.selectedCharacter=e.selectedCharacter);h.repeat=s;c.inputState=new q;if(f){D=Ga[f](b,h,c);c.lastMotion=Ga[f];if(!D)return;h.toJumplist&&(f=O.jumpList,(e=f.cachedCursor)?(W(e,D)||O.jumpList.add(b,e,D),delete f.cachedCursor):W(v,D)||O.jumpList.add(b,v,D));D instanceof Array&&(t=
D[0],D=D[1]);D||(D={ch:t.ch,line:t.line});c.visualMode?(U(l,p)&&(W(l,D)||U(D,l))?l.ch+=1:U(p,l)&&(W(l,D)||U(l,D))&&(l.ch-=1),p=D,c.visualLine&&(U(l,p)?(l.ch=0,f=b.lastLine(),p.line>f&&(p.line=f),p.ch=aa(b,p.line)):(p.ch=0,l.ch=aa(b,l.line))),b.setSelection(l,p),La(b,c,"<",U(l,p)?l:p),La(b,c,">",U(l,p)?p:l)):k||(D=u(b,D),b.setCursor(D.line,D.ch))}if(k){f=!1;c.lastMotion=null;m.repeat=s;c.visualMode&&(t=l,D=p,h.inclusive=!0);U(D,t)&&(p=t,t=D,D=p,f=!0);!h.inclusive||c.visualMode&&f||D.ch++;if(p=h.linewise||
c.visualMode&&c.visualLine)h=D,t.ch=0,h.ch=0,h.line++;else if(h.forward&&(h=D,l=b.getRange(t,h),/\n\s*$/.test(l))){l=l.split("\n");l.pop();for(s=l.pop();0<l.length&&s&&/^\s*$/.test(s);s=l.pop())h.line--,h.ch=0;s?(h.line--,h.ch=aa(b,h.line)):h.ch=0}m.registerName=n;m.linewise=p;cd[k](b,m,c,t,D,v);c.visualMode&&wa(b)}},recordLastEdit:function(b,c,e){var f=O.macroModeState;f.inReplay||(b.lastEditInputState=c,b.lastEditActionCommand=e,f.lastInsertModeChanges.changes=[],f.lastInsertModeChanges.expectCursorActivityForChange=
!1)}},Ga={moveToTopLine:function(b,c){var e=Ab(b).top+c.repeat-1;return{line:e,ch:va(b.getLine(e))}},moveToMiddleLine:function(b){var c=Ab(b),c=Math.floor(0.5*(c.top+c.bottom));return{line:c,ch:va(b.getLine(c))}},moveToBottomLine:function(b,c){var e=Ab(b).bottom-c.repeat+1;return{line:e,ch:va(b.getLine(e))}},expandToLine:function(b,c){return{line:b.getCursor().line+c.repeat-1,ch:Infinity}},findNext:function(b,c){var e=ia(b),f=e.getQuery();if(f){var h=!c.forward,h=e.isReversed()?!h:h;qc(b,f);return Ka(b,
h,f,c.repeat)}},goToMark:function(b,c,e){return(b=e.marks[c.selectedCharacter])?b.find():null},jumpToMark:function(b,c,e){for(var f=b.getCursor(),h=0;h<c.repeat;h++){var k=f,m;for(m in e.marks)if(/^[a-z]$/.test(m)){var n=e.marks[m].find();if(c.forward?!U(n,k):!U(k,n))if(!c.linewise||n.line!=k.line){var p=W(k,f),l=c.forward?kc(k,n,f):kc(f,n,k);if(p||l)f=n}}}c.linewise&&(f.ch=va(b.getLine(f.line)));return f},moveByCharacters:function(b,c){var e=b.getCursor(),f=c.repeat;return{line:e.line,ch:c.forward?
e.ch+f:e.ch-f}},moveByLines:function(b,c,e){var f=b.getCursor(),h=f.ch;switch(e.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:h=e.lastHPos;break;default:e.lastHPos=h}var k=c.repeat+(c.repeatOffset||0),k=c.forward?f.line+k:f.line-k,m=b.firstLine(),n=b.lastLine();if(!(k<m&&f.line==m||k>n&&f.line==n))return c.toFirstChar&&(h=va(b.getLine(k)),e.lastHPos=h),e.lastHSPos=b.charCoords({line:k,ch:h},"div").left,{line:k,ch:h}},
moveByDisplayLines:function(b,c,e){var f=b.getCursor();switch(e.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:e.lastHSPos=b.charCoords(f,"div").left}var h=c.repeat,f=b.findPosV(f,c.forward?h:-h,"line",e.lastHSPos);f.hitSide&&(c.forward?c={top:b.charCoords(f,"div").top+8,left:e.lastHSPos}:(c=b.charCoords({line:b.firstLine(),ch:0},"div"),c.left=e.lastHSPos),f=b.coordsChar(c,"div"));e.lastHPos=f.ch;return f},
moveByPage:function(b,c){var e=b.getCursor(),f=c.repeat;b.moveV(c.forward?f:-f,"page");f=b.getCursor();b.setCursor(e);return f},moveByParagraph:function(b,c){for(var e=b.getCursor().line,f=c.repeat,h=c.forward?1:-1,k=0;k<f&&!(!c.forward&&e===b.firstLine()||c.forward&&e==b.lastLine());k++)for(e+=h;e!==b.firstLine()&&e!=b.lastLine()&&b.getLine(e);)e+=h;return{line:e,ch:0}},moveByScroll:function(b,c,e){var f=b.getScrollInfo(),h=null;(h=c.repeat)||(h=f.clientHeight/(2*b.defaultTextHeight()));var k=b.charCoords(b.getCursor(),
"local");c.repeat=h;h=Ga.moveByDisplayLines(b,c,e);if(!h)return null;c=b.charCoords(h,"local");b.scrollTo(null,f.top+c.top-k.top);return h},moveByWords:function(b,c){var e;var f=c.repeat;e=!!c.forward;var h=!!c.wordEnd,k=!!c.bigWord,m=b.getCursor(),n=m.line,p=m.ch,l=[];(e&&!h||!e&&h)&&f++;for(var q=!(e&&h),t=0;t<f;t++){var v;b:{v=b;var s=e,z=k,$=q,u=m.line,Q=m.ch,S=v.getLine(u),C=s?1:-1,z=z?Qb:jb;if($&&""==S){u+=C;S=v.getLine(u);if(!w(v,u)){v=null;break b}Q=s?0:S.length}for(;;){if($&&""==S){v={from:0,
to:0,line:u};break b}for(var W=s=0<C?S.length:-1,A=s;Q!=s;){for(var oa=!1,U=0;U<z.length&&!oa;++U)if(z[U].test(S.charAt(Q))){for(W=Q;Q!=s&&z[U].test(S.charAt(Q));)Q+=C;A=Q;oa=W!=A;if(W!=m.ch||u!=m.line||A!=W+C){v={from:Math.min(W,A+1),to:Math.max(W,A),line:u};break b}}oa||(Q+=C)}u+=C;if(!w(v,u)){v=null;break b}S=v.getLine(u);Q=0<C?0:S.length}throw Error("The impossible happened.");}if(!v){k=aa(b,b.lastLine());l.push(e?{line:b.lastLine(),from:k,to:k}:{line:0,from:0,to:0});break}l.push(v);m={line:v.line,
ch:e?v.to-1:v.from}}f=l.length!=f;k=l[0];q=l.pop();e&&!h?(f||k.from==p&&k.line==n||(q=l.pop()),e={line:q.line,ch:q.from}):e&&h?e={line:q.line,ch:q.to-1}:!e&&h?(f||k.to==p&&k.line==n||(q=l.pop()),e={line:q.line,ch:q.to}):e={line:q.line,ch:q.from};return e},moveTillCharacter:function(b,c){var e=gb(b,c.repeat,c.forward,c.selectedCharacter),f=c.forward?-1:1;mc(f,c);if(!e)return b.getCursor();e.ch+=f;return e},moveToCharacter:function(b,c){var e=c.repeat;mc(0,c);return gb(b,e,c.forward,c.selectedCharacter)||
b.getCursor()},moveToSymbol:function(b,c){var e;e=c.repeat;var f=c.forward,h=c.selectedCharacter,k=b.getCursor(),m=f?1:-1,n=f?b.lineCount():-1,p=k.ch,l=k.line,q=b.getLine(l),f={lineText:q,nextCh:q.charAt(p),lastCh:null,index:p,symb:h,reverseSymb:(f?{")":"(","}":"{"}:{"(":")","{":"}"})[h],forward:f,depth:0,curMoveThrough:!1};if(p=ab[h]){h=Ub[p].init;p=Ub[p].isComplete;for(h&&h(f);l!==n&&e;)f.index+=m,f.nextCh=f.lineText.charAt(f.index),f.nextCh||(l+=m,f.lineText=b.getLine(l)||"",0<m?f.index=0:(h=f.lineText.length,
f.index=0<h?h-1:0),f.nextCh=f.lineText.charAt(f.index)),p(f)&&(k.line=l,k.ch=f.index,e--);e=f.nextCh||f.curMoveThrough?{line:l,ch:f.index}:k}else e=k;return e||b.getCursor()},moveToColumn:function(b,c,e){c=c.repeat;e.lastHPos=c-1;e.lastHSPos=b.charCoords(b.getCursor(),"div").left;e=b.getCursor().line;return u(b,{line:e,ch:c-1})},moveToEol:function(b,c,e){var f=b.getCursor();e.lastHPos=Infinity;c={line:f.line+c.repeat-1,ch:Infinity};f=b.clipPos(c);f.ch--;e.lastHSPos=b.charCoords(f,"div").left;return c},
moveToFirstNonWhiteSpaceCharacter:function(b){var c=b.getCursor();return{line:c.line,ch:va(b.getLine(c.line))}},moveToMatchedSymbol:function(b){var c=b.getCursor(),e=c.line,f=c.ch,h=b.getLine(e),k;k=b.getTokenAt(c).type;var m=wb(k);do if((k=h.charAt(f++))&&-1!="()[]{}".indexOf(k)){var n=b.getTokenAt({line:e,ch:f}).type,n=wb(n);if(m>=n)break}while(k);return k?Va(b,{line:e,ch:f-1},k):c},moveToStartOfLine:function(b){return{line:b.getCursor().line,ch:0}},moveToLineOrEdgeOfDocument:function(b,c){var e=
c.forward?b.lastLine():b.firstLine();c.repeatIsExplicit&&(e=c.repeat-b.getOption("firstLineNumber"));return{line:e,ch:va(b.getLine(e))}},textObjectManipulation:function(b,c){var e=c.selectedCharacter;if(!cb[e])return null;e=cb[e](b,!c.textObjectInner);return[e.start,e.end]},repeatLastCharacterSearch:function(b,c){var e=O.lastChararacterSearch,f=c.repeat,h=c.forward===e.forward,k=(e.increment?1:0)*(h?-1:1);b.moveH(-k,"char");c.inclusive=h?!0:!1;e=gb(b,f,h,e.selectedCharacter);if(!e)return b.moveH(k,
"char"),b.getCursor();e.ch+=k;return e}},cd={change:function(b,c,e,f,h){O.registerController.pushText(c.registerName,"change",b.getRange(f,h),c.linewise);c.linewise?(c=h.line>b.lastLine()?"":"\n",b.replaceRange(c,f,h),b.indentLine(f.line,"smart"),f.ch=null):(c=b.getRange(f,h),/^\s*$/.test(c)||(c=/\s+$/.exec(c))&&(h=ga(h,0,-c[0].length)),b.replaceRange("",f,h));Vb.enterInsertMode(b,{},b.state.vim);b.setCursor(f)},"delete":function(b,c,e,f,h){c.linewise&&h.line>b.lastLine()&&f.line>b.firstLine()&&(f.line--,
f.ch=aa(b,f.line));O.registerController.pushText(c.registerName,"delete",b.getRange(f,h),c.linewise);b.replaceRange("",f,h);c.linewise?b.setCursor(Ga.moveToFirstNonWhiteSpaceCharacter(b)):b.setCursor(f)},indent:function(b,c,e,f,h){var k=f.line;h=h.line;e=e.visualMode?c.repeat:1;for(c.linewise&&h--;k<=h;k++)for(var m=0;m<e;m++)b.indentLine(k,c.indentRight);b.setCursor(f);b.setCursor(Ga.moveToFirstNonWhiteSpaceCharacter(b))},swapcase:function(b,c,e,f,h,k){e=b.getRange(f,h);for(var m="",n=0;n<e.length;n++)var p=
e.charAt(n),m=m+(A(p)?p.toLowerCase():p.toUpperCase());b.replaceRange(m,f,h);c.shouldMoveCursor||b.setCursor(k)},yank:function(b,c,e,f,h,k){O.registerController.pushText(c.registerName,"yank",b.getRange(f,h),c.linewise);b.setCursor(k)}},Vb={jumpListWalk:function(b,c,e){e.visualMode||(e=c.repeat,c=(c=(c=O.jumpList.move(b,c.forward?e:-e))?c.find():void 0)?c:b.getCursor(),b.setCursor(c))},scrollToCursor:function(b,c){var e=b.getCursor().line,f=b.charCoords({line:e,ch:0},"local"),e=b.getScrollInfo().clientHeight,
h=f.top,f=f.bottom-h;switch(c.position){case "center":h=h-e/2+f;break;case "bottom":h=h-e+1.4*f;break;case "top":h+=0.4*f}b.scrollTo(null,h)},replayMacro:function(b,c){var e=c.selectedCharacter,f=c.repeat,h=O.macroModeState;"@"==e&&(e=h.latestRegister);var k,m,n=O.registerController.getRegister(e).toString(),e=h.macroKeyBuffer;h.isMacroPlaying||(h.macroKeyBuffer.length=0);do{k=/<\w+-.+?>|<\w+>|./.exec(n);if(null===k)break;m=k[0];n=n.substring(k.index+m.length);e.push(m)}while(n);for(;f--;){k=b;m=
h;n=e;m.isMacroPlaying=!0;for(var p=0,l=n.length;p<l;p++)CodeMirror.Vim.handleKey(k,n[p]);m.isMacroPlaying=!1}},exitMacroRecordMode:function(){var b=O.macroModeState;b.toggle();var c=b.latestRegister,b=b.macroKeyBuffer.join("");O.registerController.setRegisterText(c,b)},enterMacroRecordMode:function(b,c){var e=O.macroModeState;e.toggle(b,c.selectedCharacter);e.isMacroPlaying||(e.macroKeyBuffer.length=0)},enterInsertMode:function(b,c,e){b.getOption("readOnly")||(e.insertMode=!0,e.insertModeRepeat=
c&&c.repeat||1,e=c?c.insertAt:null,"eol"==e?(e=b.getCursor(),e={line:e.line,ch:aa(b,e.line)},b.setCursor(e)):"charAfter"==e?b.setCursor(ga(b.getCursor(),0,1)):"firstNonBlank"==e&&b.setCursor(Ga.moveToFirstNonWhiteSpaceCharacter(b)),b.setOption("keyMap","vim-insert"),c&&c.replace?(b.toggleOverwrite(!0),b.setOption("keyMap","vim-replace"),CodeMirror.signal(b,"vim-mode-change",{mode:"replace"})):(b.setOption("keyMap","vim-insert"),CodeMirror.signal(b,"vim-mode-change",{mode:"insert"})),O.macroModeState.inReplay||
(b.on("change",Cb),b.on("cursorActivity",sc),CodeMirror.on(b.getInputField(),"keydown",Jb)))},toggleVisualMode:function(b,c,e){var f=c.repeat,h=b.getCursor();e.visualMode?(h=b.getCursor("anchor"),f=b.getCursor("head"),!e.visualLine&&c.linewise?(e.visualLine=!0,h.ch=U(h,f)?0:aa(b,h.line),f.ch=U(h,f)?aa(b,f.line):0,b.setSelection(h,f),CodeMirror.signal(b,"vim-mode-change",{mode:"visual",subMode:"linewise"})):e.visualLine&&!c.linewise?(e.visualLine=!1,CodeMirror.signal(b,"vim-mode-change",{mode:"visual"})):
wa(b)):(b.on("mousedown",wa),e.visualMode=!0,e.visualLine=!!c.linewise,e.visualLine?(h.ch=0,f=u(b,{line:h.line+f-1,ch:aa(b,h.line)},!0)):f=u(b,{line:h.line,ch:h.ch+f},!0),c.repeatIsExplicit||e.visualLine?b.setSelection(h,f):(b.setCursor(f),b.setSelection(f,h)),CodeMirror.signal(b,"vim-mode-change",{mode:"visual",subMode:e.visualLine?"linewise":""}));La(b,e,"<",U(h,f)?h:f);La(b,e,">",U(h,f)?f:h)},joinLines:function(b,c,e){var f,h;e.visualMode?(f=b.getCursor("anchor"),h=b.getCursor("head"),h.ch=aa(b,
h.line)-1):(c=Math.max(c.repeat,2),f=b.getCursor(),h=u(b,{line:f.line+c-1,ch:Infinity}));var k=0;b.operation(function(){for(var c=f.line;c<h.line;c++){k=aa(b,f.line);var e={line:f.line+1,ch:aa(b,f.line+1)},p=b.getRange(f,e),p=p.replace(/\n\s*/g," ");b.replaceRange(p,f,e)}b.setCursor({line:f.line,ch:k})})},newLineAndEnterInsertMode:function(b,c,e){e.insertMode=!0;var f=b.getCursor();f.line!==b.firstLine()||c.after?(f.line=c.after?f.line:f.line-1,f.ch=aa(b,f.line),b.setCursor(f),(CodeMirror.commands.newlineAndIndentContinueComment||
CodeMirror.commands.newlineAndIndent)(b)):(b.replaceRange("\n",{line:b.firstLine(),ch:0}),b.setCursor(b.firstLine(),0));this.enterInsertMode(b,{repeat:c.repeat},e)},paste:function(b,c){var e=b.getCursor(),f=O.registerController.getRegister(c.registerName);if(f.text){for(var h="",k=0;k<c.repeat;k++)h+=f.text;(f=f.linewise)?c.after?(h="\n"+h.slice(0,h.length-1),e.ch=aa(b,e.line)):e.ch=0:e.ch+=c.after?1:0;b.replaceRange(h,e);f&&c.after?h={line:e.line+1,ch:va(b.getLine(e.line+1))}:f&&!c.after?h={line:e.line,
ch:va(b.getLine(e.line))}:!f&&c.after?(e=b.indexFromPos(e),h=b.posFromIndex(e+h.length-1)):(e=b.indexFromPos(e),h=b.posFromIndex(e+h.length));b.setCursor(h)}},undo:function(b,c){b.operation(function(){oa(b,CodeMirror.commands.undo,c.repeat)();b.setCursor(b.getCursor("anchor"))})},redo:function(b,c){oa(b,CodeMirror.commands.redo,c.repeat)()},setRegister:function(b,c,e){e.inputState.registerName=c.selectedCharacter},setMark:function(b,c,e){La(b,e,c.selectedCharacter,b.getCursor())},replace:function(b,
c,e){var f=c.selectedCharacter,h=b.getCursor(),k;e.visualMode?(h=b.getCursor("start"),k=b.getCursor("end"),k=b.clipPos({line:k.line,ch:k.ch+1})):(k=b.getLine(h.line),c=h.ch+c.repeat,c>k.length&&(c=k.length),k={line:h.line,ch:c});"\n"==f?(e.visualMode||b.replaceRange("",h,k),(CodeMirror.commands.newlineAndIndentContinueComment||CodeMirror.commands.newlineAndIndent)(b)):(c=b.getRange(h,k),c=c.replace(/[^\n]/g,f),b.replaceRange(c,h,k),e.visualMode?(b.setCursor(h),wa(b)):b.setCursor(ga(k,0,-1)))},incrementNumberToken:function(b,
c){for(var e=b.getCursor(),f=b.getLine(e.line),h=/-?\d+/g,k,m,n,p;null!==(k=h.exec(f))&&!(p=k[0],m=k.index,n=m+p.length,e.ch<n););!c.backtrack&&n<=e.ch||!p||(f=c.increase?1:-1,f=parseInt(p)+f*c.repeat,p={ch:m,line:e.line},n={ch:n,line:e.line},f=f.toString(),b.replaceRange(f,p,n),b.setCursor({line:e.line,ch:m+f.length-1}))},repeatLastEdit:function(b,c,e){if(e.lastEditInputState){var f=c.repeat;f&&c.repeatIsExplicit?e.lastEditInputState.repeatOverride=f:f=e.lastEditInputState.repeatOverride||f;Pa(b,
e,f,!1)}}},cb={w:function(b,c){return ub(b,c,!0,!1)},W:function(b,c){return ub(b,c,!0,!0)},"{":function(b,c){return Ia(b,"}",c)},"(":function(b,c){return Ia(b,")",c)},"[":function(b,c){return Ia(b,"]",c)},"'":function(b,c){return nc(b,"'",c)},'"':function(b,c){return nc(b,'"',c)}},ab={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"},Ub={bracket:{isComplete:function(b){if(b.nextCh===b.symb){if(b.depth++,
1<=b.depth)return!0}else b.nextCh===b.reverseSymb&&b.depth--;return!1}},section:{init:function(b){b.curMoveThrough=!0;b.symb=(b.forward?"]":"[")===b.symb?"{":"}"},isComplete:function(b){return 0===b.index&&b.nextCh===b.symb}},comment:{isComplete:function(b){var c="*"===b.lastCh&&"/"===b.nextCh;b.lastCh=b.nextCh;return c}},method:{init:function(b){b.symb="m"===b.symb?"{":"}";b.reverseSymb="{"===b.symb?"}":"{"},isComplete:function(b){return b.nextCh===b.symb?!0:!1}},preprocess:{init:function(b){b.index=
0},isComplete:function(b){if("#"===b.nextCh){var c=b.lineText.match(/#(\w+)/)[1];if("endif"===c){if(b.forward&&0===b.depth)return!0;b.depth++}else if("if"===c){if(!b.forward&&0===b.depth)return!0;b.depth--}if("else"===c&&0===b.depth)return!0}return!1}}};oc.prototype={getQuery:function(){return O.query},setQuery:function(b){O.query=b},getOverlay:function(){return this.searchOverlay},setOverlay:function(b){this.searchOverlay=b},isReversed:function(){return O.isReversed},setReversed:function(b){O.isReversed=
b}};var Eb="(Javascript regexp)",Wb=[{name:"map",type:"builtIn"},{name:"write",shortName:"w",type:"builtIn"},{name:"undo",shortName:"u",type:"builtIn"},{name:"redo",shortName:"red",type:"builtIn"},{name:"sort",shortName:"sor",type:"builtIn"},{name:"substitute",shortName:"s",type:"builtIn"},{name:"nohlsearch",shortName:"noh",type:"builtIn"},{name:"delmarks",shortName:"delm",type:"builtin"}];P.ExCommandDispatcher=function(){this.buildCommandMap_()};P.ExCommandDispatcher.prototype={processCommand:function(b,
c){b.state.vim.visualMode&&wa(b);var e=new CodeMirror.StringStream(c),f={};f.input=c;try{this.parseInput_(b,e,f)}catch(h){ea(b,h);return}var k;if(f.commandName){var m=this.matchCommand_(f.commandName);if(m){k=m.name;this.parseCommandArgs_(e,f,m);if("exToKey"==m.type){for(e=0;e<m.toKeys.length;e++)CodeMirror.Vim.handleKey(b,m.toKeys[e]);return}if("exToEx"==m.type){this.processCommand(b,m.toInput);return}}}else void 0!==f.line&&(k="move");if(k)try{Xb[k](b,f)}catch(n){ea(b,n)}else ea(b,'Not an editor command ":'+
c+'"')},parseInput_:function(b,c,e){c.eatWhile(":");c.eat("%")?(e.line=b.firstLine(),e.lineEnd=b.lastLine()):(e.line=this.parseLineSpec_(b,c),void 0!==e.line&&c.eat(",")&&(e.lineEnd=this.parseLineSpec_(b,c)));b=c.match(/^(\w+)/);e.commandName=b?b[1]:c.match(/.*/)[0];return e},parseLineSpec_:function(b,c){var e=c.match(/^(\d+)/);if(e)return parseInt(e[1],10)-1;switch(c.next()){case ".":return b.getCursor().line;case "$":return b.lastLine();case "'":if((e=b.state.vim.marks[c.next()])&&e.find())return e.find().line;
throw Error("Mark not set");default:c.backUp(1)}},parseCommandArgs_:function(b,c,e){b.eol()||(c.argString=b.match(/.*/)[0],b=e.argDelimiter||/\s+/,e=c.argString,e=e.trim?e.trim():e.replace(/^\s+|\s+$/g,""),b=e.split(b),b.length&&b[0]&&(c.args=b))},matchCommand_:function(b){for(var c=b.length;0<c;c--){var e=b.substring(0,c);if(this.commandMap_[e]&&(e=this.commandMap_[e],0===e.name.indexOf(b)))return e}return null},buildCommandMap_:function(){this.commandMap_={};for(var b=0;b<Wb.length;b++){var c=Wb[b];
this.commandMap_[c.shortName||c.name]=c}},map:function(b,c){if(":"!=b&&":"==b.charAt(0)){var e=b.substring(1);":"!=c&&":"==c.charAt(0)?this.commandMap_[e]={name:e,type:"exToEx",toInput:c.substring(1)}:this.commandMap_[e]={name:e,type:"exToKey",toKeys:Na(c)}}else":"!=c&&":"==c.charAt(0)?l.unshift({keys:Na(b),type:"keyToEx",exArgs:{input:c.substring(1)}}):l.unshift({keys:Na(b),type:"keyToKey",toKeys:Na(c)})}};var Xb={map:function(b,c){var e=c.args;!e||2>e.length?b&&ea(b,"Invalid mapping: "+c.input):
db.map(e[0],e[1],b)},move:function(b,c){bb.processCommand(b,b.state.vim,{type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0},repeatOverride:c.line+1})},sort:function(b,c){function e(b,c){if(f){var e;e=b;b=c;c=e}h&&(b=b.toLowerCase(),c=c.toLowerCase());e=m&&q.exec(b);var k=m&&q.exec(c);if(!e)return b<c?-1:1;e=parseInt((e[1]+e[2]).toLowerCase(),t);k=parseInt((k[1]+k[2]).toLowerCase(),t);return e-k}var f,h,k,m;(function(){if(c.argString){var b=new CodeMirror.StringStream(c.argString);
b.eat("!")&&(f=!0);if(!b.eol()){if(!b.eatSpace())throw Error("invalid arguments "+b.match(/.*/)[0]);var e=b.match(/[a-z]+/);if(e){e=e[0];h=-1!=e.indexOf("i");k=-1!=e.indexOf("u");var n=-1!=e.indexOf("d")&&1,p=-1!=e.indexOf("x")&&1,e=-1!=e.indexOf("o")&&1;if(1<n+p+e)throw Error("invalid arguments");m=n&&"decimal"||p&&"hex"||e&&"octal"}if(b.eatSpace()&&b.match(/\/.*\//))throw Error("patterns not supported");}}})();var n=c.line||b.firstLine(),p=c.lineEnd||c.line||b.lastLine();if(n!=p){var n={line:n,
ch:0},p={line:p,ch:aa(b,p)},l=b.getRange(n,p).split("\n"),q="decimal"==m?/(-?)([\d]+)/:"hex"==m?/(-?)(?:0x)?([0-9a-f]+)/i:"octal"==m?/([0-7]+)/:null,t="decimal"==m?10:"hex"==m?16:"octal"==m?8:null,v=[],s=[];if(m)for(var z=0;z<l.length;z++)q.exec(l[z])?v.push(l[z]):s.push(l[z]);else s=l;v.sort(e);s.sort(e);l=f?v.concat(s):s.concat(v);if(k)for(var v=l,u,l=[],z=0;z<v.length;z++)v[z]!=u&&l.push(v[z]),u=v[z];b.replaceRange(l.join("\n"),n,p)}},substitute:function(b,c){if(!b.getSearchCursor)throw Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.");
var e=c.argString,f=Wa(e);if(0!==f[0])ea(b,"Substitutions should be of the form :s/pattern/replace/");else{var h=e.substring(f[0]+1,f[1]),k="",m,n,p=!1;f[1]&&(k=e.substring(f[1]+1,f[2]));f[2]&&(n=e.substring(f[2]+1).split(" "),m=n[0],n=parseInt(n[1]));m&&(-1!=m.indexOf("c")&&(p=!0,m.replace("c","")),h=h+"/"+m);if(h)try{Xa(b,h,!0,!0)}catch(l){ea(b,"Invalid regex: "+h);return}h=ia(b).getQuery();m=void 0!==c.line?c.line:b.getCursor().line;e=c.lineEnd||m;n&&(m=e,e=m+n-1);n=u(b,{line:m,ch:0});n=b.getSearchCursor(h,
n);ma(b,p,m,e,n,h,k)}},redo:CodeMirror.commands.redo,undo:CodeMirror.commands.undo,write:function(b){CodeMirror.commands.save?CodeMirror.commands.save(b):b.save()},nohlsearch:function(b){hb(b)},delmarks:function(b,c){if(c.argString&&c.argString.trim())for(var e=b.state.vim,f=new CodeMirror.StringStream(c.argString.trim());!f.eol();){f.eatSpace();var h=f.pos;if(!f.match(/[a-zA-Z]/,!1)){ea(b,"Invalid argument: "+c.argString.substring(h));break}var k=f.next();if(f.match("-",!0)){if(!f.match(/[a-zA-Z]/,
!1)){ea(b,"Invalid argument: "+c.argString.substring(h));break}var m=f.next();if(/^[a-z]$/.test(k)&&/^[a-z]$/.test(m)||A(k)&&A(m)){k=k.charCodeAt(0);m=m.charCodeAt(0);if(k>=m){ea(b,"Invalid argument: "+c.argString.substring(h));break}for(h=0;h<=m-k;h++){var n=String.fromCharCode(k+h);delete e.marks[n]}}else{ea(b,"Invalid argument: "+k+"-");break}}else delete e.marks[k]}else ea(b,"Argument required")}},db=new P.ExCommandDispatcher;CodeMirror.keyMap.vim=function(){function b(b){return function(c){CodeMirror.Vim.handleKey(c,
b)}}function c(c,h){for(var k=0;k<c.length;k++){var m=c[k];!h&&R(m,kb)&&(m="'"+m+"'");var n=h,p=c[k];A(p)&&("Shift"==n?n=null:p=p.toLowerCase());n&&(p=n.charAt(0)+"-"+p);p=(n={Enter:"CR",Backspace:"BS",Delete:"Del"}[p])?n:p;p=1<p.length?"<"+p+">":p;e[h?h+"-"+m:m]=b(p)}}var e={nofallthrough:!0,disableInput:!0,style:"fat-cursor"};c(V);c(V,"Shift");c(V,"Ctrl");c(kb);c(kb,"Ctrl");c(Ea);c(Ea,"Ctrl");c(ra);c(ra,"Ctrl");return e}();CodeMirror.keyMap["vim-insert"]={Esc:Oa,"Ctrl-[":Oa,"Ctrl-C":Oa,"Ctrl-N":"autocomplete",
"Ctrl-P":"autocomplete",Enter:function(b){(CodeMirror.commands.newlineAndIndentContinueComment||CodeMirror.commands.newlineAndIndent)(b)},fallthrough:["default"]};CodeMirror.keyMap["vim-replace"]={Backspace:"goCharLeft",fallthrough:["vim-insert"]};v();return Qa};CodeMirror.Vim=P()})();
(function(){function l(l,s,w){l=l.getWrapperElement().appendChild(document.createElement("div"));l.className=w?"CodeMirror-dialog CodeMirror-dialog-bottom":"CodeMirror-dialog CodeMirror-dialog-top";"string"==typeof s?l.innerHTML=s:l.appendChild(s);return l}function P(l,s){l.state.currentNotificationClose&&l.state.currentNotificationClose();l.state.currentNotificationClose=s}CodeMirror.defineExtension("openDialog",function(t,s,w){function A(){M||(M=!0,R.parentNode.removeChild(R))}P(this,null);var R=
l(this,t,w&&w.bottom),M=!1,v=this,q=R.getElementsByTagName("input")[0];if(q){CodeMirror.on(q,"keydown",function(l){w&&w.onKeyDown&&w.onKeyDown(l,q.value,A)||13!=l.keyCode&&27!=l.keyCode||(CodeMirror.e_stop(l),A(),v.focus(),13==l.keyCode&&s(q.value))});if(w&&w.onKeyUp)CodeMirror.on(q,"keyup",function(l){w.onKeyUp(l,q.value,A)});w&&w.value&&(q.value=w.value);q.focus();CodeMirror.on(q,"blur",A)}else if(t=R.getElementsByTagName("button")[0])CodeMirror.on(t,"click",function(){A();v.focus()}),t.focus(),
CodeMirror.on(t,"blur",A);return A});CodeMirror.defineExtension("openConfirm",function(t,s,w){function A(){M||(M=!0,R.parentNode.removeChild(R),v.focus())}P(this,null);var R=l(this,t,w&&w.bottom);t=R.getElementsByTagName("button");var M=!1,v=this,q=1;t[0].focus();for(w=0;w<t.length;++w){var z=t[w];(function(l){CodeMirror.on(z,"click",function(q){CodeMirror.e_preventDefault(q);A();l&&l(v)})})(s[w]);CodeMirror.on(z,"blur",function(){--q;setTimeout(function(){0>=q&&A()},200)});CodeMirror.on(z,"focus",
function(){++q})}});CodeMirror.defineExtension("openNotification",function(t,s){function w(){M||(M=!0,clearTimeout(v),A.parentNode.removeChild(A))}P(this,w);var A=l(this,t,s&&s.bottom),R=s&&(void 0===s.duration?5E3:s.duration),M=!1,v;CodeMirror.on(A,"click",function(l){CodeMirror.e_preventDefault(l);w()});R&&(v=setTimeout(w,s.duration))})})();
(function(){function l(l,s,w,A){this.atOccurrence=!1;this.doc=l;null==A&&"string"==typeof s&&(A=!1);w=w?l.clipPos(w):P(0,0);this.pos={from:w,to:w};if("string"!=typeof s)s.global||(s=new RegExp(s.source,s.ignoreCase?"ig":"g")),this.matches=function(v,q){if(v){s.lastIndex=0;for(var z=l.getLine(q.line).slice(0,q.ch),w=0,u,A;;){s.lastIndex=w;w=s.exec(z);if(!w)break;u=w;A=u.index;w=u.index+(u[0].length||1);if(w==z.length)break}(w=u&&u[0].length||0)||(0==A&&0==z.length?u=void 0:A!=l.getLine(q.line).length&&
w++)}else s.lastIndex=q.ch,z=l.getLine(q.line),w=(u=s.exec(z))&&u[0].length||0,A=u&&u.index,A+w==z.length||w||(w=1);if(u&&w)return{from:P(q.line,A),to:P(q.line,A+w),match:u}};else{A&&(s=s.toLowerCase());var R=A?function(l){return l.toLowerCase()}:function(l){return l},M=s.split("\n");this.matches=1==M.length?s.length?function(v,q){var z=R(l.getLine(q.line)),w=s.length,u;if(v?q.ch>=w&&-1!=(u=z.lastIndexOf(s,q.ch-w)):-1!=(u=z.indexOf(s,q.ch)))return{from:P(q.line,u),to:P(q.line,u+w)}}:function(){}:
function(v,q){var s=q.line,w=v?M.length-1:0,u=M[w],A=R(l.getLine(s)),ga=v?A.indexOf(u)+u.length:A.lastIndexOf(u);if(!(v?ga>q.ch||ga!=u.length:ga<q.ch||ga!=A.length-u.length))for(;v?s:s!=l.lineCount()-1;){A=R(l.getLine(s+=v?-1:1));u=M[v?--w:++w];if(0<w&&w<M.length-1)if(A!=u)break;else continue;w=v?A.lastIndexOf(u):A.indexOf(u)+u.length;if(v?w!=A.length-u.length:w!=u.length)break;u=P(q.line,ga);s=P(s,w);return{from:v?s:u,to:v?u:s}}}}}var P=CodeMirror.Pos;l.prototype={findNext:function(){return this.find(!1)},
findPrevious:function(){return this.find(!0)},find:function(l){function s(l){l=P(l,0);w.pos={from:l,to:l};return w.atOccurrence=!1}for(var w=this,A=this.doc.clipPos(l?this.pos.from:this.pos.to);;){if(this.pos=this.matches(l,A))return this.pos.from&&this.pos.to||console.log(this.matches,this.pos),this.atOccurrence=!0,this.pos.match||!0;if(l){if(!A.line)return s(0);A=P(A.line-1,this.doc.getLine(A.line-1).length)}else{var R=this.doc.lineCount();if(A.line==R-1)return s(R);A=P(A.line+1,0)}}},from:function(){if(this.atOccurrence)return this.pos.from},
to:function(){if(this.atOccurrence)return this.pos.to},replace:function(l){this.atOccurrence&&(l=CodeMirror.splitLines(l),this.doc.replaceRange(l,this.pos.from,this.pos.to),this.pos.to=P(this.pos.from.line+l.length-1,l[l.length-1].length+(1==l.length?this.pos.from.ch:0)))}};CodeMirror.defineExtension("getSearchCursor",function(t,s,w){return new l(this.doc,t,s,w)});CodeMirror.defineDocExtension("getSearchCursor",function(t,s,w){return new l(this,t,s,w)})})();
(function(){function l(l){return"string"==typeof l?{token:function(q){if(q.match(l))return"searching";q.next();q.skipTo(l.charAt(0))||q.skipToEnd()}}:{token:function(q){if(q.match(l))return"searching";for(;!q.eol()&&(q.next(),!q.match(l,!1)););}}}function P(){this.overlay=this.posFrom=this.posTo=this.query=null}function t(l){return l.state.search||(l.state.search=new P)}function s(l,q,v){return l.getSearchCursor(q,v,"string"==typeof q&&q==q.toLowerCase())}function w(l,q,v,s){l.openDialog?l.openDialog(q,
s):s(prompt(v,""))}function A(l,q,v,s){if(l.openConfirm)l.openConfirm(q,s);else if(confirm(v))s[0]()}function R(l){var q=l.match(/^\/(.*)\/([a-z]*)$/);return q?new RegExp(q[1],-1==q[2].indexOf("i")?"":"i"):l}function M(q,s){var u=t(q);if(u.query)return v(q,s);w(q,S,"Search for:",function(t){q.operation(function(){t&&!u.query&&(u.query=R(t),q.removeOverlay(u.overlay),u.overlay=l(u.query),q.addOverlay(u.overlay),u.posFrom=u.posTo=q.getCursor(),v(q,s))})})}function v(l,q){l.operation(function(){var v=
t(l),u=s(l,v.query,q?v.posFrom:v.posTo);if(!u.find(q)&&(u=s(l,v.query,q?CodeMirror.Pos(l.lastLine()):CodeMirror.Pos(l.firstLine(),0)),!u.find(q)))return;l.setSelection(u.from(),u.to());l.scrollIntoView({from:u.from(),to:u.to()});v.posFrom=u.from();v.posTo=u.to()})}function q(l){l.operation(function(){var q=t(l);q.query&&(q.query=null,l.removeOverlay(q.overlay))})}function z(l,v){w(l,u,"Replace:",function(t){t&&(t=R(t),w(l,Ba,"Replace with:",function(u){if(v)l.operation(function(){for(var q=s(l,t);q.findNext();)if("string"!=
typeof t){var v=l.getRange(q.from(),q.to()).match(t);q.replace(u.replace(/\$(\d)/,function(l,q){return v[q]}))}else q.replace(u)});else{q(l);var w=s(l,t,l.getCursor()),z=function(){var q=w.from(),v;if(!(v=w.findNext())&&(w=s(l,t),!(v=w.findNext())||q&&w.from().line==q.line&&w.from().ch==q.ch))return;l.setSelection(w.from(),w.to());l.scrollIntoView({from:w.from(),to:w.to()});A(l,ga,"Replace?",[function(){S(v)},z])},S=function(l){w.replace("string"==typeof t?u:u.replace(/\$(\d)/,function(q,v){return l[v]}));
z()};z()}}))})}var S='Search: <input type="text" style="width: 10em"/> <span style="color: #888">(Use /re/ syntax for regexp search)</span>',u='Replace: <input type="text" style="width: 10em"/> <span style="color: #888">(Use /re/ syntax for regexp search)</span>',Ba='With: <input type="text" style="width: 10em"/>',ga="Replace? <button>Yes</button> <button>No</button> <button>Stop</button>";CodeMirror.commands.find=function(l){q(l);M(l)};CodeMirror.commands.findNext=M;CodeMirror.commands.findPrev=
function(l){M(l,!0)};CodeMirror.commands.clearSearch=q;CodeMirror.commands.replace=z;CodeMirror.commands.replaceAll=function(l){z(l,!0)}})();
(function(){function l(l){l.operation(function(){var q=l.getCursor("start"),z=l.getCursor("end");if(0==t(q,z))w(l);else{var S=l.state.markedSelection;if(S.length){var u=S[0].find(),M=S[S.length-1].find();if(!u||!M||z.line-q.line<R||0<=t(q,M.to)||0>=t(z,u.from))A(l);else{for(;0<t(q,u.from);)S.shift().clear(),u=S[0].find();0>t(q,u.from)&&(u.to.line-q.line<R?(S.shift().clear(),s(l,q,u.to,0)):s(l,q,u.from,0));for(;0>t(z,M.to);)S.pop().clear(),M=S[S.length-1].find();0<t(z,M.to)&&(z.line-M.from.line<R?
(S.pop().clear(),s(l,M.from,z)):s(l,M.to,z))}}else s(l,q,z)}})}function P(l){l.state.markedSelection.length&&l.operation(function(){w(l)})}function t(l,q){return l.line-q.line||l.ch-q.ch}function s(l,q,s,w){if(0!=t(q,s))for(var u=l.state.markedSelection,A=l.state.markedSelectionStyle,P=q.line;;){var $=P==q.line?q:M(P,0),P=P+R,oa=P>=s.line,W=oa?s:M(P,0),$=l.markText($,W,{className:A});null==w?u.push($):u.splice(w++,0,$);if(oa)break}}function w(l){l=l.state.markedSelection;for(var q=0;q<l.length;++q)l[q].clear();
l.length=0}function A(l){w(l);var q=l.getCursor("start"),t=l.getCursor("end");s(l,q,t)}CodeMirror.defineOption("styleSelectedText",!1,function(s,q,t){t=t&&t!=CodeMirror.Init;q&&!t?(s.state.markedSelection=[],s.state.markedSelectionStyle="string"==typeof q?q:"CodeMirror-selectedtext",A(s),s.on("cursorActivity",l),s.on("change",P)):!q&&t&&(s.off("cursorActivity",l),s.off("change",P),w(s),s.state.markedSelection=s.state.markedSelectionStyle=null)});var R=8,M=CodeMirror.Pos})();
CodeMirror.defineOption("showTrailingSpace",!1,function(l,P,t){t==CodeMirror.Init&&(t=!1);t&&!P?l.removeOverlay("trailingspace"):!t&&P&&l.addOverlay({token:function(l){for(var t=l.string.length,A=t;A&&/\s/.test(l.string.charAt(A-1));--A);if(A>l.pos)return l.pos=A,null;l.pos=t;return"trailingspace"},name:"trailingspace"})});
