CodeMirror.defineMode("commonlisp",function(g){function e(b){for(var c;c=b.next();)if("\\"==c)b.next();else if(!h.test(c)){b.backUp(1);break}return b.current()}function f(b,c){if(b.eatSpace())return d="ws",null;if(b.match(k))return"number";var a=b.next();"\\"==a&&(a=b.next());if('"'==a)return(c.tokenize=l)(b,c);if("("==a)return d="open","bracket";if(")"==a||"]"==a)return d="close","bracket";if(";"==a)return b.skipToEnd(),d="ws","comment";if(/['`,@]/.test(a))return null;if("|"==a){if(b.skipTo("|"))return b.next(),
"symbol";b.skipToEnd();return"error"}if("#"==a)return a=b.next(),"["==a?(d="open","bracket"):/[+\-=\.']/.test(a)||/\d/.test(a)&&b.match(/^\d*#/)?null:"|"==a?(c.tokenize=m)(b,c):":"==a?(e(b),"meta"):"error";a=e(b);if("."==a)return null;d="symbol";return"nil"==a||"t"==a?"atom":":"==a.charAt(0)?"keyword":"&"==a.charAt(0)?"variable-2":"variable"}function l(b,c){for(var a=!1,d;d=b.next();){if('"'==d&&!a){c.tokenize=f;break}a=!a&&"\\"==d}return"string"}function m(b,c){for(var a,e;a=b.next();){if("#"==a&&
"|"==e){c.tokenize=f;break}e=a}d="ws";return"comment"}var n=/^with|^def|^do|^prog|case$|^cond$|bind$|when$|unless$/,k=/^(?:[+\-]?(?:\d+|\d*\.\d+)(?:[efd][+\-]?\d+)?|[+\-]?\d+(?:\/[+\-]?\d+)?|#b[+\-]?[01]+|#o[+\-]?[0-7]+|#x[+\-]?[\da-f]+)/,h=/[^\s'`,@()\[\]";]/,d;return{startState:function(){return{ctx:{prev:null,start:0,indentTo:0},tokenize:f}},token:function(b,c){b.sol()&&"number"!=typeof c.ctx.indentTo&&(c.ctx.indentTo=c.ctx.start+1);d=null;var a=c.tokenize(b,c);"ws"!=d&&(null==c.ctx.indentTo?"symbol"==
d&&n.test(b.current())?c.ctx.indentTo=c.ctx.start+g.indentUnit:c.ctx.indentTo="next":"next"==c.ctx.indentTo&&(c.ctx.indentTo=b.column()));"open"==d?c.ctx={prev:c.ctx,start:b.column(),indentTo:null}:"close"==d&&(c.ctx=c.ctx.prev||c.ctx);return a},indent:function(b,c){var a=b.ctx.indentTo;return"number"==typeof a?a:b.ctx.start+1},lineComment:";;",blockCommentStart:"#|",blockCommentEnd:"|#"}});CodeMirror.defineMIME("text/x-common-lisp","commonlisp");
