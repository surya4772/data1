CodeMirror.defineMode("ruby",function(l){function m(a){for(var c={},b=0,f=a.length;b<f;++b)c[a[b]]=!0;return c}function g(a,c,b){b.tokenize.push(a);return a(c,b)}function k(a,c){d=null;if(a.sol()&&a.match("=begin")&&a.eol())return c.tokenize.push(p),"comment";if(a.eatSpace())return null;var b=a.next(),f;if("`"==b||"'"==b||'"'==b)return g(h(b,"string",'"'==b||"`"==b),a,c);if("/"!=b||a.eol()||" "==a.peek()){if("%"==b){b="string";f=!0;a.eat("s")?b="atom":a.eat(/[WQ]/)?b="string":a.eat(/[r]/)?b="string-2":
a.eat(/[wxq]/)&&(b="string",f=!1);var e=a.eat(/[^\w\s]/);if(!e)return"operator";n.propertyIsEnumerable(e)&&(e=n[e]);return g(h(e,b,f,!0),a,c)}if("#"==b)return a.skipToEnd(),"comment";if("<"==b&&(f=a.match(/^<-?[\`\"\']?([a-zA-Z_?]\w*)[\`\"\']?(?:;|$)/)))return g(q(f[1]),a,c);if("0"==b)return a.eat("x")?a.eatWhile(/[\da-fA-F]/):a.eat("b")?a.eatWhile(/[01]/):a.eatWhile(/[0-7]/),"number";if(/\d/.test(b))return a.match(/^[\d_]*(?:\.[\d_]+)?(?:[eE][+\-]?[\d_]+)?/),"number";if("?"==b){for(;a.match(/^\\[CM]-/););
a.eat("\\")?a.eatWhile(/\w/):a.next();return"string"}if(":"==b)return a.eat("'")?g(h("'","atom",!1),a,c):a.eat('"')?g(h('"',"atom",!0),a,c):a.eat(/[\<\>]/)?(a.eat(/[\<\>]/),"atom"):a.eat(/[\+\-\*\/\&\|\:\!]/)?"atom":a.eat(/[a-zA-Z$@_]/)?(a.eatWhile(/[\w]/),a.eat(/[\?\!\=]/),"atom"):"operator";if("@"==b&&a.match(/^@?[a-zA-Z_]/))return a.eat("@"),a.eatWhile(/[\w]/),"variable-2";if("$"==b)return a.eat(/[a-zA-Z_]/)?a.eatWhile(/[\w]/):a.eat(/\d/)?a.eat(/\d/):a.next(),"variable-3";if(/[a-zA-Z_]/.test(b))return a.eatWhile(/[\w]/),
a.eat(/[\?\!]/),a.eat(":")?"atom":"ident";if("|"!=b||!c.varList&&"{"!=c.lastTok&&"do"!=c.lastTok)return/[\(\)\[\]{}\\;]/.test(b)?(d=b,null):"-"==b&&a.eat(">")?"arrow":/[=+\-\/*:\.^%<>~|]/.test(b)?(a.eatWhile(/[=+\-\/*:\.^%<>~|]/),"operator"):null;d="|";return null}return g(h(b,"string-2",!0),a,c)}function r(){var a=1;return function(c,b){if("}"==c.peek()){if(a--,0==a)return b.tokenize.pop(),b.tokenize[b.tokenize.length-1](c,b)}else"{"==c.peek()&&a++;return k(c,b)}}function s(){var a=!1;return function(c,
b){if(a)return b.tokenize.pop(),b.tokenize[b.tokenize.length-1](c,b);a=!0;return k(c,b)}}function h(a,c,b,f){return function(e,d){var g=!1,h;"read-quoted-paused"===d.context.type&&(d.context=d.context.prev,e.eat("}"));for(;null!=(h=e.next());){if(h==a&&(f||!g)){d.tokenize.pop();break}if(b&&"#"==h&&!g)if(e.eat("{")){"}"==a&&(d.context={prev:d.context,type:"read-quoted-paused"});d.tokenize.push(r());break}else if(/[@\$]/.test(e.peek())){d.tokenize.push(s());break}g=!g&&"\\"==h}return c}}function q(a){return function(c,
b){c.match(a)?b.tokenize.pop():c.skipToEnd();return"string"}}function p(a,c){a.sol()&&a.match("=end")&&a.eol()&&c.tokenize.pop();a.skipToEnd();return"comment"}var t=m("alias and BEGIN begin break case class def defined? do else elsif END end ensure false for if in module next not or redo rescue retry return self super then true undef unless until when while yield nil raise throw catch fail loop callcc caller lambda proc public protected private require load require_relative extend autoload __END__ __FILE__ __LINE__ __dir__".split(" ")),
u=m("def class case for while do module then catch loop proc begin".split(" ")),v=m(["end","until"]),n={"[":"]","{":"}","(":")"},d;return{startState:function(){return{tokenize:[k],indented:0,context:{type:"top",indented:-l.indentUnit},continuedLine:!1,lastTok:null,varList:!1}},token:function(a,c){a.sol()&&(c.indented=a.indentation());var b=c.tokenize[c.tokenize.length-1](a,c),f;if("ident"==b){var e=a.current(),b=t.propertyIsEnumerable(a.current())?"keyword":/^[A-Z]/.test(e)?"tag":"def"==c.lastTok||
"class"==c.lastTok||c.varList?"def":"variable";u.propertyIsEnumerable(e)?f="indent":v.propertyIsEnumerable(e)?f="dedent":"if"!=e&&"unless"!=e||a.column()!=a.indentation()||(f="indent")}if(d||b&&"comment"!=b)c.lastTok=e||d||b;"|"==d&&(c.varList=!c.varList);"indent"==f||/[\(\[\{]/.test(d)?c.context={prev:c.context,type:d||b,indented:c.indented}:("dedent"==f||/[\)\]\}]/.test(d))&&c.context.prev&&(c.context=c.context.prev);a.eol()&&(c.continuedLine="\\"==d||"operator"==b);return b},indent:function(a,
c){if(a.tokenize[a.tokenize.length-1]!=k)return 0;var b=c&&c.charAt(0),d=a.context,b=d.type==n[b]||"keyword"==d.type&&/^(?:end|until|else|elsif|when|rescue)\b/.test(c);return d.indented+(b?0:l.indentUnit)+(a.continuedLine?l.indentUnit:0)},electricChars:"}de",lineComment:"#"}});CodeMirror.defineMIME("text/x-ruby","ruby");
